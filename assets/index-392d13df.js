function Rv(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const u=Object.getOwnPropertyDescriptor(n,i);u&&Object.defineProperty(e,i,u.get?u:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const C of u.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&n(C)}).observe(document,{childList:!0,subtree:!0});function r(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(i){if(i.ep)return;i.ep=!0;const u=r(i);fetch(i.href,u)}})();var Cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Oc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var li={},Iv={get exports(){return li},set exports(e){li=e}},Ja={},ee={},Ov={get exports(){return ee},set exports(e){ee=e}},ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ii=Symbol.for("react.element"),Mv=Symbol.for("react.portal"),wv=Symbol.for("react.fragment"),kv=Symbol.for("react.strict_mode"),bv=Symbol.for("react.profiler"),Fv=Symbol.for("react.provider"),Nv=Symbol.for("react.context"),Uv=Symbol.for("react.forward_ref"),Bv=Symbol.for("react.suspense"),Kv=Symbol.for("react.memo"),Wv=Symbol.for("react.lazy"),Qu=Symbol.iterator;function Gv(e){return e===null||typeof e!="object"?null:(e=Qu&&e[Qu]||e["@@iterator"],typeof e=="function"?e:null)}var Mc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wc=Object.assign,kc={};function wn(e,t,r){this.props=e,this.context=t,this.refs=kc,this.updater=r||Mc}wn.prototype.isReactComponent={};wn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function bc(){}bc.prototype=wn.prototype;function wl(e,t,r){this.props=e,this.context=t,this.refs=kc,this.updater=r||Mc}var kl=wl.prototype=new bc;kl.constructor=wl;wc(kl,wn.prototype);kl.isPureReactComponent=!0;var Ju=Array.isArray,Fc=Object.prototype.hasOwnProperty,bl={current:null},Nc={key:!0,ref:!0,__self:!0,__source:!0};function Uc(e,t,r){var n,i={},u=null,C=null;if(t!=null)for(n in t.ref!==void 0&&(C=t.ref),t.key!==void 0&&(u=""+t.key),t)Fc.call(t,n)&&!Nc.hasOwnProperty(n)&&(i[n]=t[n]);var I=arguments.length-2;if(I===1)i.children=r;else if(1<I){for(var o=Array(I),w=0;w<I;w++)o[w]=arguments[w+2];i.children=o}if(e&&e.defaultProps)for(n in I=e.defaultProps,I)i[n]===void 0&&(i[n]=I[n]);return{$$typeof:Ii,type:e,key:u,ref:C,props:i,_owner:bl.current}}function jv(e,t){return{$$typeof:Ii,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fl(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ii}function Hv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Zu=/\/+/g;function Ks(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Hv(""+e.key):t.toString(36)}function ia(e,t,r,n,i){var u=typeof e;(u==="undefined"||u==="boolean")&&(e=null);var C=!1;if(e===null)C=!0;else switch(u){case"string":case"number":C=!0;break;case"object":switch(e.$$typeof){case Ii:case Mv:C=!0}}if(C)return C=e,i=i(C),e=n===""?"."+Ks(C,0):n,Ju(i)?(r="",e!=null&&(r=e.replace(Zu,"$&/")+"/"),ia(i,t,r,"",function(w){return w})):i!=null&&(Fl(i)&&(i=jv(i,r+(!i.key||C&&C.key===i.key?"":(""+i.key).replace(Zu,"$&/")+"/")+e)),t.push(i)),1;if(C=0,n=n===""?".":n+":",Ju(e))for(var I=0;I<e.length;I++){u=e[I];var o=n+Ks(u,I);C+=ia(u,t,r,o,i)}else if(o=Gv(e),typeof o=="function")for(e=o.call(e),I=0;!(u=e.next()).done;)u=u.value,o=n+Ks(u,I++),C+=ia(u,t,r,o,i);else if(u==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return C}function Wi(e,t,r){if(e==null)return e;var n=[],i=0;return ia(e,n,"","",function(u){return t.call(r,u,i++)}),n}function Vv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var nt={current:null},aa={transition:null},zv={ReactCurrentDispatcher:nt,ReactCurrentBatchConfig:aa,ReactCurrentOwner:bl};ue.Children={map:Wi,forEach:function(e,t,r){Wi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wi(e,function(){t++}),t},toArray:function(e){return Wi(e,function(t){return t})||[]},only:function(e){if(!Fl(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ue.Component=wn;ue.Fragment=wv;ue.Profiler=bv;ue.PureComponent=wl;ue.StrictMode=kv;ue.Suspense=Bv;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zv;ue.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=wc({},e.props),i=e.key,u=e.ref,C=e._owner;if(t!=null){if(t.ref!==void 0&&(u=t.ref,C=bl.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var I=e.type.defaultProps;for(o in t)Fc.call(t,o)&&!Nc.hasOwnProperty(o)&&(n[o]=t[o]===void 0&&I!==void 0?I[o]:t[o])}var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){I=Array(o);for(var w=0;w<o;w++)I[w]=arguments[w+2];n.children=I}return{$$typeof:Ii,type:e.type,key:i,ref:u,props:n,_owner:C}};ue.createContext=function(e){return e={$$typeof:Nv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Fv,_context:e},e.Consumer=e};ue.createElement=Uc;ue.createFactory=function(e){var t=Uc.bind(null,e);return t.type=e,t};ue.createRef=function(){return{current:null}};ue.forwardRef=function(e){return{$$typeof:Uv,render:e}};ue.isValidElement=Fl;ue.lazy=function(e){return{$$typeof:Wv,_payload:{_status:-1,_result:e},_init:Vv}};ue.memo=function(e,t){return{$$typeof:Kv,type:e,compare:t===void 0?null:t}};ue.startTransition=function(e){var t=aa.transition;aa.transition={};try{e()}finally{aa.transition=t}};ue.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ue.useCallback=function(e,t){return nt.current.useCallback(e,t)};ue.useContext=function(e){return nt.current.useContext(e)};ue.useDebugValue=function(){};ue.useDeferredValue=function(e){return nt.current.useDeferredValue(e)};ue.useEffect=function(e,t){return nt.current.useEffect(e,t)};ue.useId=function(){return nt.current.useId()};ue.useImperativeHandle=function(e,t,r){return nt.current.useImperativeHandle(e,t,r)};ue.useInsertionEffect=function(e,t){return nt.current.useInsertionEffect(e,t)};ue.useLayoutEffect=function(e,t){return nt.current.useLayoutEffect(e,t)};ue.useMemo=function(e,t){return nt.current.useMemo(e,t)};ue.useReducer=function(e,t,r){return nt.current.useReducer(e,t,r)};ue.useRef=function(e){return nt.current.useRef(e)};ue.useState=function(e){return nt.current.useState(e)};ue.useSyncExternalStore=function(e,t,r){return nt.current.useSyncExternalStore(e,t,r)};ue.useTransition=function(){return nt.current.useTransition()};ue.version="18.2.0";(function(e){e.exports=ue})(Ov);const Bc=Oc(ee),xo=Rv({__proto__:null,default:Bc},[ee]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v=ee,Yv=Symbol.for("react.element"),Xv=Symbol.for("react.fragment"),Qv=Object.prototype.hasOwnProperty,Jv=$v.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zv={key:!0,ref:!0,__self:!0,__source:!0};function Kc(e,t,r){var n,i={},u=null,C=null;r!==void 0&&(u=""+r),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(C=t.ref);for(n in t)Qv.call(t,n)&&!Zv.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Yv,type:e,key:u,ref:C,props:i,_owner:Jv.current}}Ja.Fragment=Xv;Ja.jsx=Kc;Ja.jsxs=Kc;(function(e){e.exports=Ja})(Iv);const Nl=li.Fragment,ne=li.jsx,Ee=li.jsxs;var ya={},qv={get exports(){return ya},set exports(e){ya=e}},pt={},Lo={},eg={get exports(){return Lo},set exports(e){Lo=e}},Wc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(p,a){var E=p.length;p.push(a);e:for(;0<E;){var k=E-1>>>1,P=p[k];if(0<i(P,a))p[k]=a,p[E]=P,E=k;else break e}}function r(p){return p.length===0?null:p[0]}function n(p){if(p.length===0)return null;var a=p[0],E=p.pop();if(E!==a){p[0]=E;e:for(var k=0,P=p.length,U=P>>>1;k<U;){var K=2*(k+1)-1,W=p[K],G=K+1,j=p[G];if(0>i(W,E))G<P&&0>i(j,W)?(p[k]=j,p[G]=E,k=G):(p[k]=W,p[K]=E,k=K);else if(G<P&&0>i(j,E))p[k]=j,p[G]=E,k=G;else break e}}return a}function i(p,a){var E=p.sortIndex-a.sortIndex;return E!==0?E:p.id-a.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var C=Date,I=C.now();e.unstable_now=function(){return C.now()-I}}var o=[],w=[],A=1,N=null,O=3,B=!1,F=!1,R=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function s(p){for(var a=r(w);a!==null;){if(a.callback===null)n(w);else if(a.startTime<=p)n(w),a.sortIndex=a.expirationTime,t(o,a);else break;a=r(w)}}function D(p){if(R=!1,s(p),!F)if(r(o)!==null)F=!0,m(x);else{var a=r(w);a!==null&&l(D,a.startTime-p)}}function x(p,a){F=!1,R&&(R=!1,S(c),c=-1),B=!0;var E=O;try{for(s(a),N=r(o);N!==null&&(!(N.expirationTime>a)||p&&!L());){var k=N.callback;if(typeof k=="function"){N.callback=null,O=N.priorityLevel;var P=k(N.expirationTime<=a);a=e.unstable_now(),typeof P=="function"?N.callback=P:N===r(o)&&n(o),s(a)}else n(o);N=r(o)}if(N!==null)var U=!0;else{var K=r(w);K!==null&&l(D,K.startTime-a),U=!1}return U}finally{N=null,O=E,B=!1}}var f=!1,d=null,c=-1,h=5,_=-1;function L(){return!(e.unstable_now()-_<h)}function v(){if(d!==null){var p=e.unstable_now();_=p;var a=!0;try{a=d(!0,p)}finally{a?T():(f=!1,d=null)}}else f=!1}var T;if(typeof y=="function")T=function(){y(v)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,g=M.port2;M.port1.onmessage=v,T=function(){g.postMessage(null)}}else T=function(){b(v,0)};function m(p){d=p,f||(f=!0,T())}function l(p,a){c=b(function(){p(e.unstable_now())},a)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(p){p.callback=null},e.unstable_continueExecution=function(){F||B||(F=!0,m(x))},e.unstable_forceFrameRate=function(p){0>p||125<p?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):h=0<p?Math.floor(1e3/p):5},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(p){switch(O){case 1:case 2:case 3:var a=3;break;default:a=O}var E=O;O=a;try{return p()}finally{O=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(p,a){switch(p){case 1:case 2:case 3:case 4:case 5:break;default:p=3}var E=O;O=p;try{return a()}finally{O=E}},e.unstable_scheduleCallback=function(p,a,E){var k=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?k+E:k):E=k,p){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=E+P,p={id:A++,callback:a,priorityLevel:p,startTime:E,expirationTime:P,sortIndex:-1},E>k?(p.sortIndex=E,t(w,p),r(o)===null&&p===r(w)&&(R?(S(c),c=-1):R=!0,l(D,E-k))):(p.sortIndex=P,t(o,p),F||B||(F=!0,m(x))),p},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(p){var a=O;return function(){var E=O;O=a;try{return p.apply(this,arguments)}finally{O=E}}}})(Wc);(function(e){e.exports=Wc})(eg);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gc=ee,vt=Lo;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jc=new Set,ui={};function Jr(e,t){Pn(e,t),Pn(e+"Capture",t)}function Pn(e,t){for(ui[e]=t,e=0;e<t.length;e++)jc.add(t[e])}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Po=Object.prototype.hasOwnProperty,tg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qu={},ef={};function rg(e){return Po.call(ef,e)?!0:Po.call(qu,e)?!1:tg.test(e)?ef[e]=!0:(qu[e]=!0,!1)}function ng(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ig(e,t,r,n){if(t===null||typeof t>"u"||ng(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function it(e,t,r,n,i,u,C){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=u,this.removeEmptyString=C}var $e={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$e[e]=new it(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$e[t]=new it(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$e[e]=new it(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$e[e]=new it(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$e[e]=new it(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$e[e]=new it(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$e[e]=new it(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$e[e]=new it(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$e[e]=new it(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ul=/[\-:]([a-z])/g;function Bl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ul,Bl);$e[t]=new it(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ul,Bl);$e[t]=new it(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ul,Bl);$e[t]=new it(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$e[e]=new it(e,1,!1,e.toLowerCase(),null,!1,!1)});$e.xlinkHref=new it("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$e[e]=new it(e,1,!1,e.toLowerCase(),null,!0,!0)});function Kl(e,t,r,n){var i=$e.hasOwnProperty(t)?$e[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ig(t,r,i,n)&&(r=null),n||i===null?rg(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var or=Gc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gi=Symbol.for("react.element"),nn=Symbol.for("react.portal"),an=Symbol.for("react.fragment"),Wl=Symbol.for("react.strict_mode"),Do=Symbol.for("react.profiler"),Hc=Symbol.for("react.provider"),Vc=Symbol.for("react.context"),Gl=Symbol.for("react.forward_ref"),Ao=Symbol.for("react.suspense"),Ro=Symbol.for("react.suspense_list"),jl=Symbol.for("react.memo"),ur=Symbol.for("react.lazy"),zc=Symbol.for("react.offscreen"),tf=Symbol.iterator;function Bn(e){return e===null||typeof e!="object"?null:(e=tf&&e[tf]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,Ws;function $n(e){if(Ws===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ws=t&&t[1]||""}return`
`+Ws+e}var Gs=!1;function js(e,t){if(!e||Gs)return"";Gs=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(w){var n=w}Reflect.construct(e,[],t)}else{try{t.call()}catch(w){n=w}e.call(t.prototype)}else{try{throw Error()}catch(w){n=w}e()}}catch(w){if(w&&n&&typeof w.stack=="string"){for(var i=w.stack.split(`
`),u=n.stack.split(`
`),C=i.length-1,I=u.length-1;1<=C&&0<=I&&i[C]!==u[I];)I--;for(;1<=C&&0<=I;C--,I--)if(i[C]!==u[I]){if(C!==1||I!==1)do if(C--,I--,0>I||i[C]!==u[I]){var o=`
`+i[C].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=C&&0<=I);break}}}finally{Gs=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?$n(e):""}function ag(e){switch(e.tag){case 5:return $n(e.type);case 16:return $n("Lazy");case 13:return $n("Suspense");case 19:return $n("SuspenseList");case 0:case 2:case 15:return e=js(e.type,!1),e;case 11:return e=js(e.type.render,!1),e;case 1:return e=js(e.type,!0),e;default:return""}}function Co(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case an:return"Fragment";case nn:return"Portal";case Do:return"Profiler";case Wl:return"StrictMode";case Ao:return"Suspense";case Ro:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Vc:return(e.displayName||"Context")+".Consumer";case Hc:return(e._context.displayName||"Context")+".Provider";case Gl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case jl:return t=e.displayName||null,t!==null?t:Co(e.type)||"Memo";case ur:t=e._payload,e=e._init;try{return Co(e(t))}catch{}}return null}function sg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Co(t);case 8:return t===Wl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Rr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $c(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function og(e){var t=$c(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,u=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(C){n=""+C,u.call(this,C)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(C){n=""+C},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ji(e){e._valueTracker||(e._valueTracker=og(e))}function Yc(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=$c(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ea(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Io(e,t){var r=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function rf(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Rr(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Xc(e,t){t=t.checked,t!=null&&Kl(e,"checked",t,!1)}function Oo(e,t){Xc(e,t);var r=Rr(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Mo(e,t.type,r):t.hasOwnProperty("defaultValue")&&Mo(e,t.type,Rr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nf(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Mo(e,t,r){(t!=="number"||Ea(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Yn=Array.isArray;function mn(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Rr(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function wo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function af(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(Yn(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Rr(r)}}function Qc(e,t){var r=Rr(t.value),n=Rr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function sf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Jc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ko(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Jc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hi,Zc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hi=Hi||document.createElement("div"),Hi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lg=["Webkit","ms","Moz","O"];Object.keys(Zn).forEach(function(e){lg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zn[t]=Zn[e]})});function qc(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Zn.hasOwnProperty(e)&&Zn[e]?(""+t).trim():t+"px"}function ed(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=qc(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var ug=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bo(e,t){if(t){if(ug[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function Fo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var No=null;function Hl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Uo=null,yn=null,En=null;function of(e){if(e=wi(e)){if(typeof Uo!="function")throw Error(te(280));var t=e.stateNode;t&&(t=rs(t),Uo(e.stateNode,e.type,t))}}function td(e){yn?En?En.push(e):En=[e]:yn=e}function rd(){if(yn){var e=yn,t=En;if(En=yn=null,of(e),t)for(e=0;e<t.length;e++)of(t[e])}}function nd(e,t){return e(t)}function id(){}var Hs=!1;function ad(e,t,r){if(Hs)return e(t,r);Hs=!0;try{return nd(e,t,r)}finally{Hs=!1,(yn!==null||En!==null)&&(id(),rd())}}function ci(e,t){var r=e.stateNode;if(r===null)return null;var n=rs(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var Bo=!1;if(rr)try{var Kn={};Object.defineProperty(Kn,"passive",{get:function(){Bo=!0}}),window.addEventListener("test",Kn,Kn),window.removeEventListener("test",Kn,Kn)}catch{Bo=!1}function fg(e,t,r,n,i,u,C,I,o){var w=Array.prototype.slice.call(arguments,3);try{t.apply(r,w)}catch(A){this.onError(A)}}var qn=!1,Ta=null,Sa=!1,Ko=null,cg={onError:function(e){qn=!0,Ta=e}};function dg(e,t,r,n,i,u,C,I,o){qn=!1,Ta=null,fg.apply(cg,arguments)}function hg(e,t,r,n,i,u,C,I,o){if(dg.apply(this,arguments),qn){if(qn){var w=Ta;qn=!1,Ta=null}else throw Error(te(198));Sa||(Sa=!0,Ko=w)}}function Zr(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function sd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function lf(e){if(Zr(e)!==e)throw Error(te(188))}function vg(e){var t=e.alternate;if(!t){if(t=Zr(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var u=i.alternate;if(u===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===u.child){for(u=i.child;u;){if(u===r)return lf(i),e;if(u===n)return lf(i),t;u=u.sibling}throw Error(te(188))}if(r.return!==n.return)r=i,n=u;else{for(var C=!1,I=i.child;I;){if(I===r){C=!0,r=i,n=u;break}if(I===n){C=!0,n=i,r=u;break}I=I.sibling}if(!C){for(I=u.child;I;){if(I===r){C=!0,r=u,n=i;break}if(I===n){C=!0,n=u,r=i;break}I=I.sibling}if(!C)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function od(e){return e=vg(e),e!==null?ld(e):null}function ld(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ld(e);if(t!==null)return t;e=e.sibling}return null}var ud=vt.unstable_scheduleCallback,uf=vt.unstable_cancelCallback,gg=vt.unstable_shouldYield,pg=vt.unstable_requestPaint,Me=vt.unstable_now,mg=vt.unstable_getCurrentPriorityLevel,Vl=vt.unstable_ImmediatePriority,fd=vt.unstable_UserBlockingPriority,_a=vt.unstable_NormalPriority,yg=vt.unstable_LowPriority,cd=vt.unstable_IdlePriority,Za=null,$t=null;function Eg(e){if($t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Za,e,void 0,(e.current.flags&128)===128)}catch{}}var Bt=Math.clz32?Math.clz32:_g,Tg=Math.log,Sg=Math.LN2;function _g(e){return e>>>=0,e===0?32:31-(Tg(e)/Sg|0)|0}var Vi=64,zi=4194304;function Xn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function xa(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,u=e.pingedLanes,C=r&268435455;if(C!==0){var I=C&~i;I!==0?n=Xn(I):(u&=C,u!==0&&(n=Xn(u)))}else C=r&~i,C!==0?n=Xn(C):u!==0&&(n=Xn(u));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,u=t&-t,i>=u||i===16&&(u&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Bt(t),i=1<<r,n|=e[r],t&=~i;return n}function xg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lg(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,u=e.pendingLanes;0<u;){var C=31-Bt(u),I=1<<C,o=i[C];o===-1?(!(I&r)||I&n)&&(i[C]=xg(I,t)):o<=t&&(e.expiredLanes|=I),u&=~I}}function Wo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dd(){var e=Vi;return Vi<<=1,!(Vi&4194240)&&(Vi=64),e}function Vs(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Oi(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bt(t),e[t]=r}function Pg(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Bt(r),u=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~u}}function zl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Bt(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var he=0;function hd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vd,$l,gd,pd,md,Go=!1,$i=[],mr=null,yr=null,Er=null,di=new Map,hi=new Map,cr=[],Dg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ff(e,t){switch(e){case"focusin":case"focusout":mr=null;break;case"dragenter":case"dragleave":yr=null;break;case"mouseover":case"mouseout":Er=null;break;case"pointerover":case"pointerout":di.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hi.delete(t.pointerId)}}function Wn(e,t,r,n,i,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:u,targetContainers:[i]},t!==null&&(t=wi(t),t!==null&&$l(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Ag(e,t,r,n,i){switch(t){case"focusin":return mr=Wn(mr,e,t,r,n,i),!0;case"dragenter":return yr=Wn(yr,e,t,r,n,i),!0;case"mouseover":return Er=Wn(Er,e,t,r,n,i),!0;case"pointerover":var u=i.pointerId;return di.set(u,Wn(di.get(u)||null,e,t,r,n,i)),!0;case"gotpointercapture":return u=i.pointerId,hi.set(u,Wn(hi.get(u)||null,e,t,r,n,i)),!0}return!1}function yd(e){var t=Kr(e.target);if(t!==null){var r=Zr(t);if(r!==null){if(t=r.tag,t===13){if(t=sd(r),t!==null){e.blockedOn=t,md(e.priority,function(){gd(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=jo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);No=n,r.target.dispatchEvent(n),No=null}else return t=wi(r),t!==null&&$l(t),e.blockedOn=r,!1;t.shift()}return!0}function cf(e,t,r){sa(e)&&r.delete(t)}function Rg(){Go=!1,mr!==null&&sa(mr)&&(mr=null),yr!==null&&sa(yr)&&(yr=null),Er!==null&&sa(Er)&&(Er=null),di.forEach(cf),hi.forEach(cf)}function Gn(e,t){e.blockedOn===t&&(e.blockedOn=null,Go||(Go=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,Rg)))}function vi(e){function t(i){return Gn(i,e)}if(0<$i.length){Gn($i[0],e);for(var r=1;r<$i.length;r++){var n=$i[r];n.blockedOn===e&&(n.blockedOn=null)}}for(mr!==null&&Gn(mr,e),yr!==null&&Gn(yr,e),Er!==null&&Gn(Er,e),di.forEach(t),hi.forEach(t),r=0;r<cr.length;r++)n=cr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<cr.length&&(r=cr[0],r.blockedOn===null);)yd(r),r.blockedOn===null&&cr.shift()}var Tn=or.ReactCurrentBatchConfig,La=!0;function Cg(e,t,r,n){var i=he,u=Tn.transition;Tn.transition=null;try{he=1,Yl(e,t,r,n)}finally{he=i,Tn.transition=u}}function Ig(e,t,r,n){var i=he,u=Tn.transition;Tn.transition=null;try{he=4,Yl(e,t,r,n)}finally{he=i,Tn.transition=u}}function Yl(e,t,r,n){if(La){var i=jo(e,t,r,n);if(i===null)to(e,t,n,Pa,r),ff(e,n);else if(Ag(i,e,t,r,n))n.stopPropagation();else if(ff(e,n),t&4&&-1<Dg.indexOf(e)){for(;i!==null;){var u=wi(i);if(u!==null&&vd(u),u=jo(e,t,r,n),u===null&&to(e,t,n,Pa,r),u===i)break;i=u}i!==null&&n.stopPropagation()}else to(e,t,n,null,r)}}var Pa=null;function jo(e,t,r,n){if(Pa=null,e=Hl(n),e=Kr(e),e!==null)if(t=Zr(e),t===null)e=null;else if(r=t.tag,r===13){if(e=sd(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Pa=e,null}function Ed(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mg()){case Vl:return 1;case fd:return 4;case _a:case yg:return 16;case cd:return 536870912;default:return 16}default:return 16}}var vr=null,Xl=null,oa=null;function Td(){if(oa)return oa;var e,t=Xl,r=t.length,n,i="value"in vr?vr.value:vr.textContent,u=i.length;for(e=0;e<r&&t[e]===i[e];e++);var C=r-e;for(n=1;n<=C&&t[r-n]===i[u-n];n++);return oa=i.slice(e,1<n?1-n:void 0)}function la(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yi(){return!0}function df(){return!1}function mt(e){function t(r,n,i,u,C){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=u,this.target=C,this.currentTarget=null;for(var I in e)e.hasOwnProperty(I)&&(r=e[I],this[I]=r?r(u):u[I]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?Yi:df,this.isPropagationStopped=df,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yi)},persist:function(){},isPersistent:Yi}),t}var kn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ql=mt(kn),Mi=Re({},kn,{view:0,detail:0}),Og=mt(Mi),zs,$s,jn,qa=Re({},Mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jn&&(jn&&e.type==="mousemove"?(zs=e.screenX-jn.screenX,$s=e.screenY-jn.screenY):$s=zs=0,jn=e),zs)},movementY:function(e){return"movementY"in e?e.movementY:$s}}),hf=mt(qa),Mg=Re({},qa,{dataTransfer:0}),wg=mt(Mg),kg=Re({},Mi,{relatedTarget:0}),Ys=mt(kg),bg=Re({},kn,{animationName:0,elapsedTime:0,pseudoElement:0}),Fg=mt(bg),Ng=Re({},kn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ug=mt(Ng),Bg=Re({},kn,{data:0}),vf=mt(Bg),Kg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jg(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Gg[e])?!!t[e]:!1}function Jl(){return jg}var Hg=Re({},Mi,{key:function(e){if(e.key){var t=Kg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=la(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Wg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jl,charCode:function(e){return e.type==="keypress"?la(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?la(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vg=mt(Hg),zg=Re({},qa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gf=mt(zg),$g=Re({},Mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jl}),Yg=mt($g),Xg=Re({},kn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qg=mt(Xg),Jg=Re({},qa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zg=mt(Jg),qg=[9,13,27,32],Zl=rr&&"CompositionEvent"in window,ei=null;rr&&"documentMode"in document&&(ei=document.documentMode);var ep=rr&&"TextEvent"in window&&!ei,Sd=rr&&(!Zl||ei&&8<ei&&11>=ei),pf=String.fromCharCode(32),mf=!1;function _d(e,t){switch(e){case"keyup":return qg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sn=!1;function tp(e,t){switch(e){case"compositionend":return xd(t);case"keypress":return t.which!==32?null:(mf=!0,pf);case"textInput":return e=t.data,e===pf&&mf?null:e;default:return null}}function rp(e,t){if(sn)return e==="compositionend"||!Zl&&_d(e,t)?(e=Td(),oa=Xl=vr=null,sn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Sd&&t.locale!=="ko"?null:t.data;default:return null}}var np={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!np[e.type]:t==="textarea"}function Ld(e,t,r,n){td(n),t=Da(t,"onChange"),0<t.length&&(r=new Ql("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ti=null,gi=null;function ip(e){bd(e,0)}function es(e){var t=un(e);if(Yc(t))return e}function ap(e,t){if(e==="change")return t}var Pd=!1;if(rr){var Xs;if(rr){var Qs="oninput"in document;if(!Qs){var Ef=document.createElement("div");Ef.setAttribute("oninput","return;"),Qs=typeof Ef.oninput=="function"}Xs=Qs}else Xs=!1;Pd=Xs&&(!document.documentMode||9<document.documentMode)}function Tf(){ti&&(ti.detachEvent("onpropertychange",Dd),gi=ti=null)}function Dd(e){if(e.propertyName==="value"&&es(gi)){var t=[];Ld(t,gi,e,Hl(e)),ad(ip,t)}}function sp(e,t,r){e==="focusin"?(Tf(),ti=t,gi=r,ti.attachEvent("onpropertychange",Dd)):e==="focusout"&&Tf()}function op(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return es(gi)}function lp(e,t){if(e==="click")return es(t)}function up(e,t){if(e==="input"||e==="change")return es(t)}function fp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wt=typeof Object.is=="function"?Object.is:fp;function pi(e,t){if(Wt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Po.call(t,i)||!Wt(e[i],t[i]))return!1}return!0}function Sf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _f(e,t){var r=Sf(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sf(r)}}function Ad(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ad(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Rd(){for(var e=window,t=Ea();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ea(e.document)}return t}function ql(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function cp(e){var t=Rd(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ad(r.ownerDocument.documentElement,r)){if(n!==null&&ql(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,u=Math.min(n.start,i);n=n.end===void 0?u:Math.min(n.end,i),!e.extend&&u>n&&(i=n,n=u,u=i),i=_f(r,u);var C=_f(r,n);i&&C&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==C.node||e.focusOffset!==C.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),u>n?(e.addRange(t),e.extend(C.node,C.offset)):(t.setEnd(C.node,C.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dp=rr&&"documentMode"in document&&11>=document.documentMode,on=null,Ho=null,ri=null,Vo=!1;function xf(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vo||on==null||on!==Ea(n)||(n=on,"selectionStart"in n&&ql(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ri&&pi(ri,n)||(ri=n,n=Da(Ho,"onSelect"),0<n.length&&(t=new Ql("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=on)))}function Xi(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ln={animationend:Xi("Animation","AnimationEnd"),animationiteration:Xi("Animation","AnimationIteration"),animationstart:Xi("Animation","AnimationStart"),transitionend:Xi("Transition","TransitionEnd")},Js={},Cd={};rr&&(Cd=document.createElement("div").style,"AnimationEvent"in window||(delete ln.animationend.animation,delete ln.animationiteration.animation,delete ln.animationstart.animation),"TransitionEvent"in window||delete ln.transitionend.transition);function ts(e){if(Js[e])return Js[e];if(!ln[e])return e;var t=ln[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Cd)return Js[e]=t[r];return e}var Id=ts("animationend"),Od=ts("animationiteration"),Md=ts("animationstart"),wd=ts("transitionend"),kd=new Map,Lf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mr(e,t){kd.set(e,t),Jr(t,[e])}for(var Zs=0;Zs<Lf.length;Zs++){var qs=Lf[Zs],hp=qs.toLowerCase(),vp=qs[0].toUpperCase()+qs.slice(1);Mr(hp,"on"+vp)}Mr(Id,"onAnimationEnd");Mr(Od,"onAnimationIteration");Mr(Md,"onAnimationStart");Mr("dblclick","onDoubleClick");Mr("focusin","onFocus");Mr("focusout","onBlur");Mr(wd,"onTransitionEnd");Pn("onMouseEnter",["mouseout","mouseover"]);Pn("onMouseLeave",["mouseout","mouseover"]);Pn("onPointerEnter",["pointerout","pointerover"]);Pn("onPointerLeave",["pointerout","pointerover"]);Jr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qn));function Pf(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,hg(n,t,void 0,e),e.currentTarget=null}function bd(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var u=void 0;if(t)for(var C=n.length-1;0<=C;C--){var I=n[C],o=I.instance,w=I.currentTarget;if(I=I.listener,o!==u&&i.isPropagationStopped())break e;Pf(i,I,w),u=o}else for(C=0;C<n.length;C++){if(I=n[C],o=I.instance,w=I.currentTarget,I=I.listener,o!==u&&i.isPropagationStopped())break e;Pf(i,I,w),u=o}}}if(Sa)throw e=Ko,Sa=!1,Ko=null,e}function Se(e,t){var r=t[Qo];r===void 0&&(r=t[Qo]=new Set);var n=e+"__bubble";r.has(n)||(Fd(t,e,2,!1),r.add(n))}function eo(e,t,r){var n=0;t&&(n|=4),Fd(r,e,n,t)}var Qi="_reactListening"+Math.random().toString(36).slice(2);function mi(e){if(!e[Qi]){e[Qi]=!0,jc.forEach(function(r){r!=="selectionchange"&&(gp.has(r)||eo(r,!1,e),eo(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qi]||(t[Qi]=!0,eo("selectionchange",!1,t))}}function Fd(e,t,r,n){switch(Ed(t)){case 1:var i=Cg;break;case 4:i=Ig;break;default:i=Yl}r=i.bind(null,t,r,e),i=void 0,!Bo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function to(e,t,r,n,i){var u=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var C=n.tag;if(C===3||C===4){var I=n.stateNode.containerInfo;if(I===i||I.nodeType===8&&I.parentNode===i)break;if(C===4)for(C=n.return;C!==null;){var o=C.tag;if((o===3||o===4)&&(o=C.stateNode.containerInfo,o===i||o.nodeType===8&&o.parentNode===i))return;C=C.return}for(;I!==null;){if(C=Kr(I),C===null)return;if(o=C.tag,o===5||o===6){n=u=C;continue e}I=I.parentNode}}n=n.return}ad(function(){var w=u,A=Hl(r),N=[];e:{var O=kd.get(e);if(O!==void 0){var B=Ql,F=e;switch(e){case"keypress":if(la(r)===0)break e;case"keydown":case"keyup":B=Vg;break;case"focusin":F="focus",B=Ys;break;case"focusout":F="blur",B=Ys;break;case"beforeblur":case"afterblur":B=Ys;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":B=hf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":B=wg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":B=Yg;break;case Id:case Od:case Md:B=Fg;break;case wd:B=Qg;break;case"scroll":B=Og;break;case"wheel":B=Zg;break;case"copy":case"cut":case"paste":B=Ug;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":B=gf}var R=(t&4)!==0,b=!R&&e==="scroll",S=R?O!==null?O+"Capture":null:O;R=[];for(var y=w,s;y!==null;){s=y;var D=s.stateNode;if(s.tag===5&&D!==null&&(s=D,S!==null&&(D=ci(y,S),D!=null&&R.push(yi(y,D,s)))),b)break;y=y.return}0<R.length&&(O=new B(O,F,null,r,A),N.push({event:O,listeners:R}))}}if(!(t&7)){e:{if(O=e==="mouseover"||e==="pointerover",B=e==="mouseout"||e==="pointerout",O&&r!==No&&(F=r.relatedTarget||r.fromElement)&&(Kr(F)||F[nr]))break e;if((B||O)&&(O=A.window===A?A:(O=A.ownerDocument)?O.defaultView||O.parentWindow:window,B?(F=r.relatedTarget||r.toElement,B=w,F=F?Kr(F):null,F!==null&&(b=Zr(F),F!==b||F.tag!==5&&F.tag!==6)&&(F=null)):(B=null,F=w),B!==F)){if(R=hf,D="onMouseLeave",S="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(R=gf,D="onPointerLeave",S="onPointerEnter",y="pointer"),b=B==null?O:un(B),s=F==null?O:un(F),O=new R(D,y+"leave",B,r,A),O.target=b,O.relatedTarget=s,D=null,Kr(A)===w&&(R=new R(S,y+"enter",F,r,A),R.target=s,R.relatedTarget=b,D=R),b=D,B&&F)t:{for(R=B,S=F,y=0,s=R;s;s=tn(s))y++;for(s=0,D=S;D;D=tn(D))s++;for(;0<y-s;)R=tn(R),y--;for(;0<s-y;)S=tn(S),s--;for(;y--;){if(R===S||S!==null&&R===S.alternate)break t;R=tn(R),S=tn(S)}R=null}else R=null;B!==null&&Df(N,O,B,R,!1),F!==null&&b!==null&&Df(N,b,F,R,!0)}}e:{if(O=w?un(w):window,B=O.nodeName&&O.nodeName.toLowerCase(),B==="select"||B==="input"&&O.type==="file")var x=ap;else if(yf(O))if(Pd)x=up;else{x=op;var f=sp}else(B=O.nodeName)&&B.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(x=lp);if(x&&(x=x(e,w))){Ld(N,x,r,A);break e}f&&f(e,O,w),e==="focusout"&&(f=O._wrapperState)&&f.controlled&&O.type==="number"&&Mo(O,"number",O.value)}switch(f=w?un(w):window,e){case"focusin":(yf(f)||f.contentEditable==="true")&&(on=f,Ho=w,ri=null);break;case"focusout":ri=Ho=on=null;break;case"mousedown":Vo=!0;break;case"contextmenu":case"mouseup":case"dragend":Vo=!1,xf(N,r,A);break;case"selectionchange":if(dp)break;case"keydown":case"keyup":xf(N,r,A)}var d;if(Zl)e:{switch(e){case"compositionstart":var c="onCompositionStart";break e;case"compositionend":c="onCompositionEnd";break e;case"compositionupdate":c="onCompositionUpdate";break e}c=void 0}else sn?_d(e,r)&&(c="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(c="onCompositionStart");c&&(Sd&&r.locale!=="ko"&&(sn||c!=="onCompositionStart"?c==="onCompositionEnd"&&sn&&(d=Td()):(vr=A,Xl="value"in vr?vr.value:vr.textContent,sn=!0)),f=Da(w,c),0<f.length&&(c=new vf(c,e,null,r,A),N.push({event:c,listeners:f}),d?c.data=d:(d=xd(r),d!==null&&(c.data=d)))),(d=ep?tp(e,r):rp(e,r))&&(w=Da(w,"onBeforeInput"),0<w.length&&(A=new vf("onBeforeInput","beforeinput",null,r,A),N.push({event:A,listeners:w}),A.data=d))}bd(N,t)})}function yi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Da(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,u=i.stateNode;i.tag===5&&u!==null&&(i=u,u=ci(e,r),u!=null&&n.unshift(yi(e,u,i)),u=ci(e,t),u!=null&&n.push(yi(e,u,i))),e=e.return}return n}function tn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Df(e,t,r,n,i){for(var u=t._reactName,C=[];r!==null&&r!==n;){var I=r,o=I.alternate,w=I.stateNode;if(o!==null&&o===n)break;I.tag===5&&w!==null&&(I=w,i?(o=ci(r,u),o!=null&&C.unshift(yi(r,o,I))):i||(o=ci(r,u),o!=null&&C.push(yi(r,o,I)))),r=r.return}C.length!==0&&e.push({event:t,listeners:C})}var pp=/\r\n?/g,mp=/\u0000|\uFFFD/g;function Af(e){return(typeof e=="string"?e:""+e).replace(pp,`
`).replace(mp,"")}function Ji(e,t,r){if(t=Af(t),Af(e)!==t&&r)throw Error(te(425))}function Aa(){}var zo=null,$o=null;function Yo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xo=typeof setTimeout=="function"?setTimeout:void 0,yp=typeof clearTimeout=="function"?clearTimeout:void 0,Rf=typeof Promise=="function"?Promise:void 0,Ep=typeof queueMicrotask=="function"?queueMicrotask:typeof Rf<"u"?function(e){return Rf.resolve(null).then(e).catch(Tp)}:Xo;function Tp(e){setTimeout(function(){throw e})}function ro(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),vi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);vi(t)}function Tr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Cf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var bn=Math.random().toString(36).slice(2),zt="__reactFiber$"+bn,Ei="__reactProps$"+bn,nr="__reactContainer$"+bn,Qo="__reactEvents$"+bn,Sp="__reactListeners$"+bn,_p="__reactHandles$"+bn;function Kr(e){var t=e[zt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[nr]||r[zt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Cf(e);e!==null;){if(r=e[zt])return r;e=Cf(e)}return t}e=r,r=e.parentNode}return null}function wi(e){return e=e[zt]||e[nr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function un(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function rs(e){return e[Ei]||null}var Jo=[],fn=-1;function wr(e){return{current:e}}function _e(e){0>fn||(e.current=Jo[fn],Jo[fn]=null,fn--)}function Te(e,t){fn++,Jo[fn]=e.current,e.current=t}var Cr={},qe=wr(Cr),ot=wr(!1),Vr=Cr;function Dn(e,t){var r=e.type.contextTypes;if(!r)return Cr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},u;for(u in r)i[u]=t[u];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function lt(e){return e=e.childContextTypes,e!=null}function Ra(){_e(ot),_e(qe)}function If(e,t,r){if(qe.current!==Cr)throw Error(te(168));Te(qe,t),Te(ot,r)}function Nd(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(te(108,sg(e)||"Unknown",i));return Re({},r,n)}function Ca(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cr,Vr=qe.current,Te(qe,e),Te(ot,ot.current),!0}function Of(e,t,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=Nd(e,t,Vr),n.__reactInternalMemoizedMergedChildContext=e,_e(ot),_e(qe),Te(qe,e)):_e(ot),Te(ot,r)}var Zt=null,ns=!1,no=!1;function Ud(e){Zt===null?Zt=[e]:Zt.push(e)}function xp(e){ns=!0,Ud(e)}function kr(){if(!no&&Zt!==null){no=!0;var e=0,t=he;try{var r=Zt;for(he=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Zt=null,ns=!1}catch(i){throw Zt!==null&&(Zt=Zt.slice(e+1)),ud(Vl,kr),i}finally{he=t,no=!1}}return null}var cn=[],dn=0,Ia=null,Oa=0,_t=[],xt=0,zr=null,qt=1,er="";function Nr(e,t){cn[dn++]=Oa,cn[dn++]=Ia,Ia=e,Oa=t}function Bd(e,t,r){_t[xt++]=qt,_t[xt++]=er,_t[xt++]=zr,zr=e;var n=qt;e=er;var i=32-Bt(n)-1;n&=~(1<<i),r+=1;var u=32-Bt(t)+i;if(30<u){var C=i-i%5;u=(n&(1<<C)-1).toString(32),n>>=C,i-=C,qt=1<<32-Bt(t)+i|r<<i|n,er=u+e}else qt=1<<u|r<<i|n,er=e}function eu(e){e.return!==null&&(Nr(e,1),Bd(e,1,0))}function tu(e){for(;e===Ia;)Ia=cn[--dn],cn[dn]=null,Oa=cn[--dn],cn[dn]=null;for(;e===zr;)zr=_t[--xt],_t[xt]=null,er=_t[--xt],_t[xt]=null,qt=_t[--xt],_t[xt]=null}var ht=null,ct=null,Pe=!1,Ft=null;function Kd(e,t){var r=Lt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Mf(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ht=e,ct=Tr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ht=e,ct=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=zr!==null?{id:qt,overflow:er}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Lt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ht=e,ct=null,!0):!1;default:return!1}}function Zo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qo(e){if(Pe){var t=ct;if(t){var r=t;if(!Mf(e,t)){if(Zo(e))throw Error(te(418));t=Tr(r.nextSibling);var n=ht;t&&Mf(e,t)?Kd(n,r):(e.flags=e.flags&-4097|2,Pe=!1,ht=e)}}else{if(Zo(e))throw Error(te(418));e.flags=e.flags&-4097|2,Pe=!1,ht=e}}}function wf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ht=e}function Zi(e){if(e!==ht)return!1;if(!Pe)return wf(e),Pe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Yo(e.type,e.memoizedProps)),t&&(t=ct)){if(Zo(e))throw Wd(),Error(te(418));for(;t;)Kd(e,t),t=Tr(t.nextSibling)}if(wf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ct=Tr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ct=null}}else ct=ht?Tr(e.stateNode.nextSibling):null;return!0}function Wd(){for(var e=ct;e;)e=Tr(e.nextSibling)}function An(){ct=ht=null,Pe=!1}function ru(e){Ft===null?Ft=[e]:Ft.push(e)}var Lp=or.ReactCurrentBatchConfig;function kt(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var Ma=wr(null),wa=null,hn=null,nu=null;function iu(){nu=hn=wa=null}function au(e){var t=Ma.current;_e(Ma),e._currentValue=t}function el(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Sn(e,t){wa=e,nu=hn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(st=!0),e.firstContext=null)}function Dt(e){var t=e._currentValue;if(nu!==e)if(e={context:e,memoizedValue:t,next:null},hn===null){if(wa===null)throw Error(te(308));hn=e,wa.dependencies={lanes:0,firstContext:e}}else hn=hn.next=e;return t}var Wr=null;function su(e){Wr===null?Wr=[e]:Wr.push(e)}function Gd(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,su(t)):(r.next=i.next,i.next=r),t.interleaved=r,ir(e,n)}function ir(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var fr=!1;function ou(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function tr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Sr(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ce&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ir(e,r)}return i=n.interleaved,i===null?(t.next=t,su(n)):(t.next=i.next,i.next=t),n.interleaved=t,ir(e,r)}function ua(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zl(e,r)}}function kf(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,u=null;if(r=r.firstBaseUpdate,r!==null){do{var C={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};u===null?i=u=C:u=u.next=C,r=r.next}while(r!==null);u===null?i=u=t:u=u.next=t}else i=u=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:u,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ka(e,t,r,n){var i=e.updateQueue;fr=!1;var u=i.firstBaseUpdate,C=i.lastBaseUpdate,I=i.shared.pending;if(I!==null){i.shared.pending=null;var o=I,w=o.next;o.next=null,C===null?u=w:C.next=w,C=o;var A=e.alternate;A!==null&&(A=A.updateQueue,I=A.lastBaseUpdate,I!==C&&(I===null?A.firstBaseUpdate=w:I.next=w,A.lastBaseUpdate=o))}if(u!==null){var N=i.baseState;C=0,A=w=o=null,I=u;do{var O=I.lane,B=I.eventTime;if((n&O)===O){A!==null&&(A=A.next={eventTime:B,lane:0,tag:I.tag,payload:I.payload,callback:I.callback,next:null});e:{var F=e,R=I;switch(O=t,B=r,R.tag){case 1:if(F=R.payload,typeof F=="function"){N=F.call(B,N,O);break e}N=F;break e;case 3:F.flags=F.flags&-65537|128;case 0:if(F=R.payload,O=typeof F=="function"?F.call(B,N,O):F,O==null)break e;N=Re({},N,O);break e;case 2:fr=!0}}I.callback!==null&&I.lane!==0&&(e.flags|=64,O=i.effects,O===null?i.effects=[I]:O.push(I))}else B={eventTime:B,lane:O,tag:I.tag,payload:I.payload,callback:I.callback,next:null},A===null?(w=A=B,o=N):A=A.next=B,C|=O;if(I=I.next,I===null){if(I=i.shared.pending,I===null)break;O=I,I=O.next,O.next=null,i.lastBaseUpdate=O,i.shared.pending=null}}while(1);if(A===null&&(o=N),i.baseState=o,i.firstBaseUpdate=w,i.lastBaseUpdate=A,t=i.shared.interleaved,t!==null){i=t;do C|=i.lane,i=i.next;while(i!==t)}else u===null&&(i.shared.lanes=0);Yr|=C,e.lanes=C,e.memoizedState=N}}function bf(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(te(191,i));i.call(n)}}}var Hd=new Gc.Component().refs;function tl(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Re({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var is={isMounted:function(e){return(e=e._reactInternals)?Zr(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=rt(),i=xr(e),u=tr(n,i);u.payload=t,r!=null&&(u.callback=r),t=Sr(e,u,i),t!==null&&(Kt(t,e,i,n),ua(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=rt(),i=xr(e),u=tr(n,i);u.tag=1,u.payload=t,r!=null&&(u.callback=r),t=Sr(e,u,i),t!==null&&(Kt(t,e,i,n),ua(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=rt(),n=xr(e),i=tr(r,n);i.tag=2,t!=null&&(i.callback=t),t=Sr(e,i,n),t!==null&&(Kt(t,e,n,r),ua(t,e,n))}};function Ff(e,t,r,n,i,u,C){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,u,C):t.prototype&&t.prototype.isPureReactComponent?!pi(r,n)||!pi(i,u):!0}function Vd(e,t,r){var n=!1,i=Cr,u=t.contextType;return typeof u=="object"&&u!==null?u=Dt(u):(i=lt(t)?Vr:qe.current,n=t.contextTypes,u=(n=n!=null)?Dn(e,i):Cr),t=new t(r,u),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=u),t}function Nf(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function rl(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=Hd,ou(e);var u=t.contextType;typeof u=="object"&&u!==null?i.context=Dt(u):(u=lt(t)?Vr:qe.current,i.context=Dn(e,u)),i.state=e.memoizedState,u=t.getDerivedStateFromProps,typeof u=="function"&&(tl(e,t,u,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),ka(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Hn(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var i=n,u=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===u?t.ref:(t=function(C){var I=i.refs;I===Hd&&(I=i.refs={}),C===null?delete I[u]:I[u]=C},t._stringRef=u,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Uf(e){var t=e._init;return t(e._payload)}function zd(e){function t(S,y){if(e){var s=S.deletions;s===null?(S.deletions=[y],S.flags|=16):s.push(y)}}function r(S,y){if(!e)return null;for(;y!==null;)t(S,y),y=y.sibling;return null}function n(S,y){for(S=new Map;y!==null;)y.key!==null?S.set(y.key,y):S.set(y.index,y),y=y.sibling;return S}function i(S,y){return S=Lr(S,y),S.index=0,S.sibling=null,S}function u(S,y,s){return S.index=s,e?(s=S.alternate,s!==null?(s=s.index,s<y?(S.flags|=2,y):s):(S.flags|=2,y)):(S.flags|=1048576,y)}function C(S){return e&&S.alternate===null&&(S.flags|=2),S}function I(S,y,s,D){return y===null||y.tag!==6?(y=fo(s,S.mode,D),y.return=S,y):(y=i(y,s),y.return=S,y)}function o(S,y,s,D){var x=s.type;return x===an?A(S,y,s.props.children,D,s.key):y!==null&&(y.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===ur&&Uf(x)===y.type)?(D=i(y,s.props),D.ref=Hn(S,y,s),D.return=S,D):(D=ga(s.type,s.key,s.props,null,S.mode,D),D.ref=Hn(S,y,s),D.return=S,D)}function w(S,y,s,D){return y===null||y.tag!==4||y.stateNode.containerInfo!==s.containerInfo||y.stateNode.implementation!==s.implementation?(y=co(s,S.mode,D),y.return=S,y):(y=i(y,s.children||[]),y.return=S,y)}function A(S,y,s,D,x){return y===null||y.tag!==7?(y=Hr(s,S.mode,D,x),y.return=S,y):(y=i(y,s),y.return=S,y)}function N(S,y,s){if(typeof y=="string"&&y!==""||typeof y=="number")return y=fo(""+y,S.mode,s),y.return=S,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Gi:return s=ga(y.type,y.key,y.props,null,S.mode,s),s.ref=Hn(S,null,y),s.return=S,s;case nn:return y=co(y,S.mode,s),y.return=S,y;case ur:var D=y._init;return N(S,D(y._payload),s)}if(Yn(y)||Bn(y))return y=Hr(y,S.mode,s,null),y.return=S,y;qi(S,y)}return null}function O(S,y,s,D){var x=y!==null?y.key:null;if(typeof s=="string"&&s!==""||typeof s=="number")return x!==null?null:I(S,y,""+s,D);if(typeof s=="object"&&s!==null){switch(s.$$typeof){case Gi:return s.key===x?o(S,y,s,D):null;case nn:return s.key===x?w(S,y,s,D):null;case ur:return x=s._init,O(S,y,x(s._payload),D)}if(Yn(s)||Bn(s))return x!==null?null:A(S,y,s,D,null);qi(S,s)}return null}function B(S,y,s,D,x){if(typeof D=="string"&&D!==""||typeof D=="number")return S=S.get(s)||null,I(y,S,""+D,x);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Gi:return S=S.get(D.key===null?s:D.key)||null,o(y,S,D,x);case nn:return S=S.get(D.key===null?s:D.key)||null,w(y,S,D,x);case ur:var f=D._init;return B(S,y,s,f(D._payload),x)}if(Yn(D)||Bn(D))return S=S.get(s)||null,A(y,S,D,x,null);qi(y,D)}return null}function F(S,y,s,D){for(var x=null,f=null,d=y,c=y=0,h=null;d!==null&&c<s.length;c++){d.index>c?(h=d,d=null):h=d.sibling;var _=O(S,d,s[c],D);if(_===null){d===null&&(d=h);break}e&&d&&_.alternate===null&&t(S,d),y=u(_,y,c),f===null?x=_:f.sibling=_,f=_,d=h}if(c===s.length)return r(S,d),Pe&&Nr(S,c),x;if(d===null){for(;c<s.length;c++)d=N(S,s[c],D),d!==null&&(y=u(d,y,c),f===null?x=d:f.sibling=d,f=d);return Pe&&Nr(S,c),x}for(d=n(S,d);c<s.length;c++)h=B(d,S,c,s[c],D),h!==null&&(e&&h.alternate!==null&&d.delete(h.key===null?c:h.key),y=u(h,y,c),f===null?x=h:f.sibling=h,f=h);return e&&d.forEach(function(L){return t(S,L)}),Pe&&Nr(S,c),x}function R(S,y,s,D){var x=Bn(s);if(typeof x!="function")throw Error(te(150));if(s=x.call(s),s==null)throw Error(te(151));for(var f=x=null,d=y,c=y=0,h=null,_=s.next();d!==null&&!_.done;c++,_=s.next()){d.index>c?(h=d,d=null):h=d.sibling;var L=O(S,d,_.value,D);if(L===null){d===null&&(d=h);break}e&&d&&L.alternate===null&&t(S,d),y=u(L,y,c),f===null?x=L:f.sibling=L,f=L,d=h}if(_.done)return r(S,d),Pe&&Nr(S,c),x;if(d===null){for(;!_.done;c++,_=s.next())_=N(S,_.value,D),_!==null&&(y=u(_,y,c),f===null?x=_:f.sibling=_,f=_);return Pe&&Nr(S,c),x}for(d=n(S,d);!_.done;c++,_=s.next())_=B(d,S,c,_.value,D),_!==null&&(e&&_.alternate!==null&&d.delete(_.key===null?c:_.key),y=u(_,y,c),f===null?x=_:f.sibling=_,f=_);return e&&d.forEach(function(v){return t(S,v)}),Pe&&Nr(S,c),x}function b(S,y,s,D){if(typeof s=="object"&&s!==null&&s.type===an&&s.key===null&&(s=s.props.children),typeof s=="object"&&s!==null){switch(s.$$typeof){case Gi:e:{for(var x=s.key,f=y;f!==null;){if(f.key===x){if(x=s.type,x===an){if(f.tag===7){r(S,f.sibling),y=i(f,s.props.children),y.return=S,S=y;break e}}else if(f.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===ur&&Uf(x)===f.type){r(S,f.sibling),y=i(f,s.props),y.ref=Hn(S,f,s),y.return=S,S=y;break e}r(S,f);break}else t(S,f);f=f.sibling}s.type===an?(y=Hr(s.props.children,S.mode,D,s.key),y.return=S,S=y):(D=ga(s.type,s.key,s.props,null,S.mode,D),D.ref=Hn(S,y,s),D.return=S,S=D)}return C(S);case nn:e:{for(f=s.key;y!==null;){if(y.key===f)if(y.tag===4&&y.stateNode.containerInfo===s.containerInfo&&y.stateNode.implementation===s.implementation){r(S,y.sibling),y=i(y,s.children||[]),y.return=S,S=y;break e}else{r(S,y);break}else t(S,y);y=y.sibling}y=co(s,S.mode,D),y.return=S,S=y}return C(S);case ur:return f=s._init,b(S,y,f(s._payload),D)}if(Yn(s))return F(S,y,s,D);if(Bn(s))return R(S,y,s,D);qi(S,s)}return typeof s=="string"&&s!==""||typeof s=="number"?(s=""+s,y!==null&&y.tag===6?(r(S,y.sibling),y=i(y,s),y.return=S,S=y):(r(S,y),y=fo(s,S.mode,D),y.return=S,S=y),C(S)):r(S,y)}return b}var Rn=zd(!0),$d=zd(!1),ki={},Yt=wr(ki),Ti=wr(ki),Si=wr(ki);function Gr(e){if(e===ki)throw Error(te(174));return e}function lu(e,t){switch(Te(Si,t),Te(Ti,e),Te(Yt,ki),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ko(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ko(t,e)}_e(Yt),Te(Yt,t)}function Cn(){_e(Yt),_e(Ti),_e(Si)}function Yd(e){Gr(Si.current);var t=Gr(Yt.current),r=ko(t,e.type);t!==r&&(Te(Ti,e),Te(Yt,r))}function uu(e){Ti.current===e&&(_e(Yt),_e(Ti))}var De=wr(0);function ba(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var io=[];function fu(){for(var e=0;e<io.length;e++)io[e]._workInProgressVersionPrimary=null;io.length=0}var fa=or.ReactCurrentDispatcher,ao=or.ReactCurrentBatchConfig,$r=0,Ae=null,Ne=null,Be=null,Fa=!1,ni=!1,_i=0,Pp=0;function Xe(){throw Error(te(321))}function cu(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Wt(e[r],t[r]))return!1;return!0}function du(e,t,r,n,i,u){if($r=u,Ae=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fa.current=e===null||e.memoizedState===null?Cp:Ip,e=r(n,i),ni){u=0;do{if(ni=!1,_i=0,25<=u)throw Error(te(301));u+=1,Be=Ne=null,t.updateQueue=null,fa.current=Op,e=r(n,i)}while(ni)}if(fa.current=Na,t=Ne!==null&&Ne.next!==null,$r=0,Be=Ne=Ae=null,Fa=!1,t)throw Error(te(300));return e}function hu(){var e=_i!==0;return _i=0,e}function Vt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?Ae.memoizedState=Be=e:Be=Be.next=e,Be}function At(){if(Ne===null){var e=Ae.alternate;e=e!==null?e.memoizedState:null}else e=Ne.next;var t=Be===null?Ae.memoizedState:Be.next;if(t!==null)Be=t,Ne=e;else{if(e===null)throw Error(te(310));Ne=e,e={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},Be===null?Ae.memoizedState=Be=e:Be=Be.next=e}return Be}function xi(e,t){return typeof t=="function"?t(e):t}function so(e){var t=At(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=Ne,i=n.baseQueue,u=r.pending;if(u!==null){if(i!==null){var C=i.next;i.next=u.next,u.next=C}n.baseQueue=i=u,r.pending=null}if(i!==null){u=i.next,n=n.baseState;var I=C=null,o=null,w=u;do{var A=w.lane;if(($r&A)===A)o!==null&&(o=o.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),n=w.hasEagerState?w.eagerState:e(n,w.action);else{var N={lane:A,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};o===null?(I=o=N,C=n):o=o.next=N,Ae.lanes|=A,Yr|=A}w=w.next}while(w!==null&&w!==u);o===null?C=n:o.next=I,Wt(n,t.memoizedState)||(st=!0),t.memoizedState=n,t.baseState=C,t.baseQueue=o,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do u=i.lane,Ae.lanes|=u,Yr|=u,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function oo(e){var t=At(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,u=t.memoizedState;if(i!==null){r.pending=null;var C=i=i.next;do u=e(u,C.action),C=C.next;while(C!==i);Wt(u,t.memoizedState)||(st=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),r.lastRenderedState=u}return[u,n]}function Xd(){}function Qd(e,t){var r=Ae,n=At(),i=t(),u=!Wt(n.memoizedState,i);if(u&&(n.memoizedState=i,st=!0),n=n.queue,vu(qd.bind(null,r,n,e),[e]),n.getSnapshot!==t||u||Be!==null&&Be.memoizedState.tag&1){if(r.flags|=2048,Li(9,Zd.bind(null,r,n,i,t),void 0,null),Ke===null)throw Error(te(349));$r&30||Jd(r,t,i)}return i}function Jd(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ae.updateQueue,t===null?(t={lastEffect:null,stores:null},Ae.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Zd(e,t,r,n){t.value=r,t.getSnapshot=n,eh(t)&&th(e)}function qd(e,t,r){return r(function(){eh(t)&&th(e)})}function eh(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Wt(e,r)}catch{return!0}}function th(e){var t=ir(e,1);t!==null&&Kt(t,e,1,-1)}function Bf(e){var t=Vt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:e},t.queue=e,e=e.dispatch=Rp.bind(null,Ae,e),[t.memoizedState,e]}function Li(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ae.updateQueue,t===null?(t={lastEffect:null,stores:null},Ae.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function rh(){return At().memoizedState}function ca(e,t,r,n){var i=Vt();Ae.flags|=e,i.memoizedState=Li(1|t,r,void 0,n===void 0?null:n)}function as(e,t,r,n){var i=At();n=n===void 0?null:n;var u=void 0;if(Ne!==null){var C=Ne.memoizedState;if(u=C.destroy,n!==null&&cu(n,C.deps)){i.memoizedState=Li(t,r,u,n);return}}Ae.flags|=e,i.memoizedState=Li(1|t,r,u,n)}function Kf(e,t){return ca(8390656,8,e,t)}function vu(e,t){return as(2048,8,e,t)}function nh(e,t){return as(4,2,e,t)}function ih(e,t){return as(4,4,e,t)}function ah(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function sh(e,t,r){return r=r!=null?r.concat([e]):null,as(4,4,ah.bind(null,t,e),r)}function gu(){}function oh(e,t){var r=At();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&cu(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function lh(e,t){var r=At();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&cu(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function uh(e,t,r){return $r&21?(Wt(r,t)||(r=dd(),Ae.lanes|=r,Yr|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,st=!0),e.memoizedState=r)}function Dp(e,t){var r=he;he=r!==0&&4>r?r:4,e(!0);var n=ao.transition;ao.transition={};try{e(!1),t()}finally{he=r,ao.transition=n}}function fh(){return At().memoizedState}function Ap(e,t,r){var n=xr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ch(e))dh(t,r);else if(r=Gd(e,t,r,n),r!==null){var i=rt();Kt(r,e,n,i),hh(r,t,n)}}function Rp(e,t,r){var n=xr(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ch(e))dh(t,i);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var C=t.lastRenderedState,I=u(C,r);if(i.hasEagerState=!0,i.eagerState=I,Wt(I,C)){var o=t.interleaved;o===null?(i.next=i,su(t)):(i.next=o.next,o.next=i),t.interleaved=i;return}}catch{}finally{}r=Gd(e,t,i,n),r!==null&&(i=rt(),Kt(r,e,n,i),hh(r,t,n))}}function ch(e){var t=e.alternate;return e===Ae||t!==null&&t===Ae}function dh(e,t){ni=Fa=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function hh(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,zl(e,r)}}var Na={readContext:Dt,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},Cp={readContext:Dt,useCallback:function(e,t){return Vt().memoizedState=[e,t===void 0?null:t],e},useContext:Dt,useEffect:Kf,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ca(4194308,4,ah.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ca(4194308,4,e,t)},useInsertionEffect:function(e,t){return ca(4,2,e,t)},useMemo:function(e,t){var r=Vt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Vt();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ap.bind(null,Ae,e),[n.memoizedState,e]},useRef:function(e){var t=Vt();return e={current:e},t.memoizedState=e},useState:Bf,useDebugValue:gu,useDeferredValue:function(e){return Vt().memoizedState=e},useTransition:function(){var e=Bf(!1),t=e[0];return e=Dp.bind(null,e[1]),Vt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ae,i=Vt();if(Pe){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),Ke===null)throw Error(te(349));$r&30||Jd(n,t,r)}i.memoizedState=r;var u={value:r,getSnapshot:t};return i.queue=u,Kf(qd.bind(null,n,u,e),[e]),n.flags|=2048,Li(9,Zd.bind(null,n,u,r,t),void 0,null),r},useId:function(){var e=Vt(),t=Ke.identifierPrefix;if(Pe){var r=er,n=qt;r=(n&~(1<<32-Bt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=_i++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Pp++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ip={readContext:Dt,useCallback:oh,useContext:Dt,useEffect:vu,useImperativeHandle:sh,useInsertionEffect:nh,useLayoutEffect:ih,useMemo:lh,useReducer:so,useRef:rh,useState:function(){return so(xi)},useDebugValue:gu,useDeferredValue:function(e){var t=At();return uh(t,Ne.memoizedState,e)},useTransition:function(){var e=so(xi)[0],t=At().memoizedState;return[e,t]},useMutableSource:Xd,useSyncExternalStore:Qd,useId:fh,unstable_isNewReconciler:!1},Op={readContext:Dt,useCallback:oh,useContext:Dt,useEffect:vu,useImperativeHandle:sh,useInsertionEffect:nh,useLayoutEffect:ih,useMemo:lh,useReducer:oo,useRef:rh,useState:function(){return oo(xi)},useDebugValue:gu,useDeferredValue:function(e){var t=At();return Ne===null?t.memoizedState=e:uh(t,Ne.memoizedState,e)},useTransition:function(){var e=oo(xi)[0],t=At().memoizedState;return[e,t]},useMutableSource:Xd,useSyncExternalStore:Qd,useId:fh,unstable_isNewReconciler:!1};function In(e,t){try{var r="",n=t;do r+=ag(n),n=n.return;while(n);var i=r}catch(u){i=`
Error generating stack: `+u.message+`
`+u.stack}return{value:e,source:t,stack:i,digest:null}}function lo(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function nl(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Mp=typeof WeakMap=="function"?WeakMap:Map;function vh(e,t,r){r=tr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ba||(Ba=!0,hl=n),nl(e,t)},r}function gh(e,t,r){r=tr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){nl(e,t)}}var u=e.stateNode;return u!==null&&typeof u.componentDidCatch=="function"&&(r.callback=function(){nl(e,t),typeof n!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var C=t.stack;this.componentDidCatch(t.value,{componentStack:C!==null?C:""})}),r}function Wf(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Mp;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=zp.bind(null,e,t,r),t.then(e,e))}function Gf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function jf(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=tr(-1,1),t.tag=2,Sr(r,t,1))),r.lanes|=1),e)}var wp=or.ReactCurrentOwner,st=!1;function tt(e,t,r,n){t.child=e===null?$d(t,null,r,n):Rn(t,e.child,r,n)}function Hf(e,t,r,n,i){r=r.render;var u=t.ref;return Sn(t,i),n=du(e,t,r,n,u,i),r=hu(),e!==null&&!st?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ar(e,t,i)):(Pe&&r&&eu(t),t.flags|=1,tt(e,t,n,i),t.child)}function Vf(e,t,r,n,i){if(e===null){var u=r.type;return typeof u=="function"&&!xu(u)&&u.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=u,ph(e,t,u,n,i)):(e=ga(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!(e.lanes&i)){var C=u.memoizedProps;if(r=r.compare,r=r!==null?r:pi,r(C,n)&&e.ref===t.ref)return ar(e,t,i)}return t.flags|=1,e=Lr(u,n),e.ref=t.ref,e.return=t,t.child=e}function ph(e,t,r,n,i){if(e!==null){var u=e.memoizedProps;if(pi(u,n)&&e.ref===t.ref)if(st=!1,t.pendingProps=n=u,(e.lanes&i)!==0)e.flags&131072&&(st=!0);else return t.lanes=e.lanes,ar(e,t,i)}return il(e,t,r,n,i)}function mh(e,t,r){var n=t.pendingProps,i=n.children,u=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(gn,ft),ft|=r;else{if(!(r&1073741824))return e=u!==null?u.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Te(gn,ft),ft|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=u!==null?u.baseLanes:r,Te(gn,ft),ft|=n}else u!==null?(n=u.baseLanes|r,t.memoizedState=null):n=r,Te(gn,ft),ft|=n;return tt(e,t,i,r),t.child}function yh(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function il(e,t,r,n,i){var u=lt(r)?Vr:qe.current;return u=Dn(t,u),Sn(t,i),r=du(e,t,r,n,u,i),n=hu(),e!==null&&!st?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ar(e,t,i)):(Pe&&n&&eu(t),t.flags|=1,tt(e,t,r,i),t.child)}function zf(e,t,r,n,i){if(lt(r)){var u=!0;Ca(t)}else u=!1;if(Sn(t,i),t.stateNode===null)da(e,t),Vd(t,r,n),rl(t,r,n,i),n=!0;else if(e===null){var C=t.stateNode,I=t.memoizedProps;C.props=I;var o=C.context,w=r.contextType;typeof w=="object"&&w!==null?w=Dt(w):(w=lt(r)?Vr:qe.current,w=Dn(t,w));var A=r.getDerivedStateFromProps,N=typeof A=="function"||typeof C.getSnapshotBeforeUpdate=="function";N||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(I!==n||o!==w)&&Nf(t,C,n,w),fr=!1;var O=t.memoizedState;C.state=O,ka(t,n,C,i),o=t.memoizedState,I!==n||O!==o||ot.current||fr?(typeof A=="function"&&(tl(t,r,A,n),o=t.memoizedState),(I=fr||Ff(t,r,I,n,O,o,w))?(N||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(t.flags|=4194308)):(typeof C.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),C.props=n,C.state=o,C.context=w,n=I):(typeof C.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{C=t.stateNode,jd(e,t),I=t.memoizedProps,w=t.type===t.elementType?I:kt(t.type,I),C.props=w,N=t.pendingProps,O=C.context,o=r.contextType,typeof o=="object"&&o!==null?o=Dt(o):(o=lt(r)?Vr:qe.current,o=Dn(t,o));var B=r.getDerivedStateFromProps;(A=typeof B=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(I!==N||O!==o)&&Nf(t,C,n,o),fr=!1,O=t.memoizedState,C.state=O,ka(t,n,C,i);var F=t.memoizedState;I!==N||O!==F||ot.current||fr?(typeof B=="function"&&(tl(t,r,B,n),F=t.memoizedState),(w=fr||Ff(t,r,w,n,O,F,o)||!1)?(A||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(n,F,o),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(n,F,o)),typeof C.componentDidUpdate=="function"&&(t.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof C.componentDidUpdate!="function"||I===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||I===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=F),C.props=n,C.state=F,C.context=o,n=w):(typeof C.componentDidUpdate!="function"||I===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||I===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),n=!1)}return al(e,t,r,n,u,i)}function al(e,t,r,n,i,u){yh(e,t);var C=(t.flags&128)!==0;if(!n&&!C)return i&&Of(t,r,!1),ar(e,t,u);n=t.stateNode,wp.current=t;var I=C&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&C?(t.child=Rn(t,e.child,null,u),t.child=Rn(t,null,I,u)):tt(e,t,I,u),t.memoizedState=n.state,i&&Of(t,r,!0),t.child}function Eh(e){var t=e.stateNode;t.pendingContext?If(e,t.pendingContext,t.pendingContext!==t.context):t.context&&If(e,t.context,!1),lu(e,t.containerInfo)}function $f(e,t,r,n,i){return An(),ru(i),t.flags|=256,tt(e,t,r,n),t.child}var sl={dehydrated:null,treeContext:null,retryLane:0};function ol(e){return{baseLanes:e,cachePool:null,transitions:null}}function Th(e,t,r){var n=t.pendingProps,i=De.current,u=!1,C=(t.flags&128)!==0,I;if((I=C)||(I=e!==null&&e.memoizedState===null?!1:(i&2)!==0),I?(u=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Te(De,i&1),e===null)return qo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(C=n.children,e=n.fallback,u?(n=t.mode,u=t.child,C={mode:"hidden",children:C},!(n&1)&&u!==null?(u.childLanes=0,u.pendingProps=C):u=ls(C,n,0,null),e=Hr(e,n,r,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=ol(r),t.memoizedState=sl,e):pu(t,C));if(i=e.memoizedState,i!==null&&(I=i.dehydrated,I!==null))return kp(e,t,C,n,I,i,r);if(u){u=n.fallback,C=t.mode,i=e.child,I=i.sibling;var o={mode:"hidden",children:n.children};return!(C&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=o,t.deletions=null):(n=Lr(i,o),n.subtreeFlags=i.subtreeFlags&14680064),I!==null?u=Lr(I,u):(u=Hr(u,C,r,null),u.flags|=2),u.return=t,n.return=t,n.sibling=u,t.child=n,n=u,u=t.child,C=e.child.memoizedState,C=C===null?ol(r):{baseLanes:C.baseLanes|r,cachePool:null,transitions:C.transitions},u.memoizedState=C,u.childLanes=e.childLanes&~r,t.memoizedState=sl,n}return u=e.child,e=u.sibling,n=Lr(u,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function pu(e,t){return t=ls({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ea(e,t,r,n){return n!==null&&ru(n),Rn(t,e.child,null,r),e=pu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kp(e,t,r,n,i,u,C){if(r)return t.flags&256?(t.flags&=-257,n=lo(Error(te(422))),ea(e,t,C,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(u=n.fallback,i=t.mode,n=ls({mode:"visible",children:n.children},i,0,null),u=Hr(u,i,C,null),u.flags|=2,n.return=t,u.return=t,n.sibling=u,t.child=n,t.mode&1&&Rn(t,e.child,null,C),t.child.memoizedState=ol(C),t.memoizedState=sl,u);if(!(t.mode&1))return ea(e,t,C,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var I=n.dgst;return n=I,u=Error(te(419)),n=lo(u,n,void 0),ea(e,t,C,n)}if(I=(C&e.childLanes)!==0,st||I){if(n=Ke,n!==null){switch(C&-C){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|C)?0:i,i!==0&&i!==u.retryLane&&(u.retryLane=i,ir(e,i),Kt(n,e,i,-1))}return _u(),n=lo(Error(te(421))),ea(e,t,C,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=$p.bind(null,e),i._reactRetry=t,null):(e=u.treeContext,ct=Tr(i.nextSibling),ht=t,Pe=!0,Ft=null,e!==null&&(_t[xt++]=qt,_t[xt++]=er,_t[xt++]=zr,qt=e.id,er=e.overflow,zr=t),t=pu(t,n.children),t.flags|=4096,t)}function Yf(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),el(e.return,t,r)}function uo(e,t,r,n,i){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=n,u.tail=r,u.tailMode=i)}function Sh(e,t,r){var n=t.pendingProps,i=n.revealOrder,u=n.tail;if(tt(e,t,n.children,r),n=De.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Yf(e,r,t);else if(e.tag===19)Yf(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Te(De,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&ba(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),uo(t,!1,i,r,u);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&ba(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}uo(t,!0,r,null,u);break;case"together":uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function da(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ar(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Yr|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=Lr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Lr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bp(e,t,r){switch(t.tag){case 3:Eh(t),An();break;case 5:Yd(t);break;case 1:lt(t.type)&&Ca(t);break;case 4:lu(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Te(Ma,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Te(De,De.current&1),t.flags|=128,null):r&t.child.childLanes?Th(e,t,r):(Te(De,De.current&1),e=ar(e,t,r),e!==null?e.sibling:null);Te(De,De.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Sh(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Te(De,De.current),n)break;return null;case 22:case 23:return t.lanes=0,mh(e,t,r)}return ar(e,t,r)}var _h,ll,xh,Lh;_h=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ll=function(){};xh=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Gr(Yt.current);var u=null;switch(r){case"input":i=Io(e,i),n=Io(e,n),u=[];break;case"select":i=Re({},i,{value:void 0}),n=Re({},n,{value:void 0}),u=[];break;case"textarea":i=wo(e,i),n=wo(e,n),u=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Aa)}bo(r,n);var C;r=null;for(w in i)if(!n.hasOwnProperty(w)&&i.hasOwnProperty(w)&&i[w]!=null)if(w==="style"){var I=i[w];for(C in I)I.hasOwnProperty(C)&&(r||(r={}),r[C]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(ui.hasOwnProperty(w)?u||(u=[]):(u=u||[]).push(w,null));for(w in n){var o=n[w];if(I=i!=null?i[w]:void 0,n.hasOwnProperty(w)&&o!==I&&(o!=null||I!=null))if(w==="style")if(I){for(C in I)!I.hasOwnProperty(C)||o&&o.hasOwnProperty(C)||(r||(r={}),r[C]="");for(C in o)o.hasOwnProperty(C)&&I[C]!==o[C]&&(r||(r={}),r[C]=o[C])}else r||(u||(u=[]),u.push(w,r)),r=o;else w==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,I=I?I.__html:void 0,o!=null&&I!==o&&(u=u||[]).push(w,o)):w==="children"?typeof o!="string"&&typeof o!="number"||(u=u||[]).push(w,""+o):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(ui.hasOwnProperty(w)?(o!=null&&w==="onScroll"&&Se("scroll",e),u||I===o||(u=[])):(u=u||[]).push(w,o))}r&&(u=u||[]).push("style",r);var w=u;(t.updateQueue=w)&&(t.flags|=4)}};Lh=function(e,t,r,n){r!==n&&(t.flags|=4)};function Vn(e,t){if(!Pe)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Qe(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Fp(e,t,r){var n=t.pendingProps;switch(tu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(t),null;case 1:return lt(t.type)&&Ra(),Qe(t),null;case 3:return n=t.stateNode,Cn(),_e(ot),_e(qe),fu(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Zi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ft!==null&&(pl(Ft),Ft=null))),ll(e,t),Qe(t),null;case 5:uu(t);var i=Gr(Si.current);if(r=t.type,e!==null&&t.stateNode!=null)xh(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(te(166));return Qe(t),null}if(e=Gr(Yt.current),Zi(t)){n=t.stateNode,r=t.type;var u=t.memoizedProps;switch(n[zt]=t,n[Ei]=u,e=(t.mode&1)!==0,r){case"dialog":Se("cancel",n),Se("close",n);break;case"iframe":case"object":case"embed":Se("load",n);break;case"video":case"audio":for(i=0;i<Qn.length;i++)Se(Qn[i],n);break;case"source":Se("error",n);break;case"img":case"image":case"link":Se("error",n),Se("load",n);break;case"details":Se("toggle",n);break;case"input":rf(n,u),Se("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!u.multiple},Se("invalid",n);break;case"textarea":af(n,u),Se("invalid",n)}bo(r,u),i=null;for(var C in u)if(u.hasOwnProperty(C)){var I=u[C];C==="children"?typeof I=="string"?n.textContent!==I&&(u.suppressHydrationWarning!==!0&&Ji(n.textContent,I,e),i=["children",I]):typeof I=="number"&&n.textContent!==""+I&&(u.suppressHydrationWarning!==!0&&Ji(n.textContent,I,e),i=["children",""+I]):ui.hasOwnProperty(C)&&I!=null&&C==="onScroll"&&Se("scroll",n)}switch(r){case"input":ji(n),nf(n,u,!0);break;case"textarea":ji(n),sf(n);break;case"select":case"option":break;default:typeof u.onClick=="function"&&(n.onclick=Aa)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{C=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Jc(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=C.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=C.createElement(r,{is:n.is}):(e=C.createElement(r),r==="select"&&(C=e,n.multiple?C.multiple=!0:n.size&&(C.size=n.size))):e=C.createElementNS(e,r),e[zt]=t,e[Ei]=n,_h(e,t,!1,!1),t.stateNode=e;e:{switch(C=Fo(r,n),r){case"dialog":Se("cancel",e),Se("close",e),i=n;break;case"iframe":case"object":case"embed":Se("load",e),i=n;break;case"video":case"audio":for(i=0;i<Qn.length;i++)Se(Qn[i],e);i=n;break;case"source":Se("error",e),i=n;break;case"img":case"image":case"link":Se("error",e),Se("load",e),i=n;break;case"details":Se("toggle",e),i=n;break;case"input":rf(e,n),i=Io(e,n),Se("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Re({},n,{value:void 0}),Se("invalid",e);break;case"textarea":af(e,n),i=wo(e,n),Se("invalid",e);break;default:i=n}bo(r,i),I=i;for(u in I)if(I.hasOwnProperty(u)){var o=I[u];u==="style"?ed(e,o):u==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&Zc(e,o)):u==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&fi(e,o):typeof o=="number"&&fi(e,""+o):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ui.hasOwnProperty(u)?o!=null&&u==="onScroll"&&Se("scroll",e):o!=null&&Kl(e,u,o,C))}switch(r){case"input":ji(e),nf(e,n,!1);break;case"textarea":ji(e),sf(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Rr(n.value));break;case"select":e.multiple=!!n.multiple,u=n.value,u!=null?mn(e,!!n.multiple,u,!1):n.defaultValue!=null&&mn(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Aa)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qe(t),null;case 6:if(e&&t.stateNode!=null)Lh(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(te(166));if(r=Gr(Si.current),Gr(Yt.current),Zi(t)){if(n=t.stateNode,r=t.memoizedProps,n[zt]=t,(u=n.nodeValue!==r)&&(e=ht,e!==null))switch(e.tag){case 3:Ji(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ji(n.nodeValue,r,(e.mode&1)!==0)}u&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zt]=t,t.stateNode=n}return Qe(t),null;case 13:if(_e(De),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pe&&ct!==null&&t.mode&1&&!(t.flags&128))Wd(),An(),t.flags|=98560,u=!1;else if(u=Zi(t),n!==null&&n.dehydrated!==null){if(e===null){if(!u)throw Error(te(318));if(u=t.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(te(317));u[zt]=t}else An(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qe(t),u=!1}else Ft!==null&&(pl(Ft),Ft=null),u=!0;if(!u)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||De.current&1?Ue===0&&(Ue=3):_u())),t.updateQueue!==null&&(t.flags|=4),Qe(t),null);case 4:return Cn(),ll(e,t),e===null&&mi(t.stateNode.containerInfo),Qe(t),null;case 10:return au(t.type._context),Qe(t),null;case 17:return lt(t.type)&&Ra(),Qe(t),null;case 19:if(_e(De),u=t.memoizedState,u===null)return Qe(t),null;if(n=(t.flags&128)!==0,C=u.rendering,C===null)if(n)Vn(u,!1);else{if(Ue!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(C=ba(e),C!==null){for(t.flags|=128,Vn(u,!1),n=C.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)u=r,e=n,u.flags&=14680066,C=u.alternate,C===null?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=C.childLanes,u.lanes=C.lanes,u.child=C.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=C.memoizedProps,u.memoizedState=C.memoizedState,u.updateQueue=C.updateQueue,u.type=C.type,e=C.dependencies,u.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Te(De,De.current&1|2),t.child}e=e.sibling}u.tail!==null&&Me()>On&&(t.flags|=128,n=!0,Vn(u,!1),t.lanes=4194304)}else{if(!n)if(e=ba(C),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Vn(u,!0),u.tail===null&&u.tailMode==="hidden"&&!C.alternate&&!Pe)return Qe(t),null}else 2*Me()-u.renderingStartTime>On&&r!==1073741824&&(t.flags|=128,n=!0,Vn(u,!1),t.lanes=4194304);u.isBackwards?(C.sibling=t.child,t.child=C):(r=u.last,r!==null?r.sibling=C:t.child=C,u.last=C)}return u.tail!==null?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=Me(),t.sibling=null,r=De.current,Te(De,n?r&1|2:r&1),t):(Qe(t),null);case 22:case 23:return Su(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ft&1073741824&&(Qe(t),t.subtreeFlags&6&&(t.flags|=8192)):Qe(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function Np(e,t){switch(tu(t),t.tag){case 1:return lt(t.type)&&Ra(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Cn(),_e(ot),_e(qe),fu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return uu(t),null;case 13:if(_e(De),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));An()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return _e(De),null;case 4:return Cn(),null;case 10:return au(t.type._context),null;case 22:case 23:return Su(),null;case 24:return null;default:return null}}var ta=!1,Ze=!1,Up=typeof WeakSet=="function"?WeakSet:Set,ae=null;function vn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ce(e,t,n)}else r.current=null}function ul(e,t,r){try{r()}catch(n){Ce(e,t,n)}}var Xf=!1;function Bp(e,t){if(zo=La,e=Rd(),ql(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,u=n.focusNode;n=n.focusOffset;try{r.nodeType,u.nodeType}catch{r=null;break e}var C=0,I=-1,o=-1,w=0,A=0,N=e,O=null;t:for(;;){for(var B;N!==r||i!==0&&N.nodeType!==3||(I=C+i),N!==u||n!==0&&N.nodeType!==3||(o=C+n),N.nodeType===3&&(C+=N.nodeValue.length),(B=N.firstChild)!==null;)O=N,N=B;for(;;){if(N===e)break t;if(O===r&&++w===i&&(I=C),O===u&&++A===n&&(o=C),(B=N.nextSibling)!==null)break;N=O,O=N.parentNode}N=B}r=I===-1||o===-1?null:{start:I,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for($o={focusedElem:e,selectionRange:r},La=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var F=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(F!==null){var R=F.memoizedProps,b=F.memoizedState,S=t.stateNode,y=S.getSnapshotBeforeUpdate(t.elementType===t.type?R:kt(t.type,R),b);S.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var s=t.stateNode.containerInfo;s.nodeType===1?s.textContent="":s.nodeType===9&&s.documentElement&&s.removeChild(s.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(D){Ce(t,t.return,D)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return F=Xf,Xf=!1,F}function ii(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var u=i.destroy;i.destroy=void 0,u!==void 0&&ul(t,r,u)}i=i.next}while(i!==n)}}function ss(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function fl(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ph(e){var t=e.alternate;t!==null&&(e.alternate=null,Ph(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zt],delete t[Ei],delete t[Qo],delete t[Sp],delete t[_p])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Dh(e){return e.tag===5||e.tag===3||e.tag===4}function Qf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Dh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function cl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Aa));else if(n!==4&&(e=e.child,e!==null))for(cl(e,t,r),e=e.sibling;e!==null;)cl(e,t,r),e=e.sibling}function dl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(dl(e,t,r),e=e.sibling;e!==null;)dl(e,t,r),e=e.sibling}var Ve=null,bt=!1;function lr(e,t,r){for(r=r.child;r!==null;)Ah(e,t,r),r=r.sibling}function Ah(e,t,r){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Za,r)}catch{}switch(r.tag){case 5:Ze||vn(r,t);case 6:var n=Ve,i=bt;Ve=null,lr(e,t,r),Ve=n,bt=i,Ve!==null&&(bt?(e=Ve,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ve.removeChild(r.stateNode));break;case 18:Ve!==null&&(bt?(e=Ve,r=r.stateNode,e.nodeType===8?ro(e.parentNode,r):e.nodeType===1&&ro(e,r),vi(e)):ro(Ve,r.stateNode));break;case 4:n=Ve,i=bt,Ve=r.stateNode.containerInfo,bt=!0,lr(e,t,r),Ve=n,bt=i;break;case 0:case 11:case 14:case 15:if(!Ze&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var u=i,C=u.destroy;u=u.tag,C!==void 0&&(u&2||u&4)&&ul(r,t,C),i=i.next}while(i!==n)}lr(e,t,r);break;case 1:if(!Ze&&(vn(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(I){Ce(r,t,I)}lr(e,t,r);break;case 21:lr(e,t,r);break;case 22:r.mode&1?(Ze=(n=Ze)||r.memoizedState!==null,lr(e,t,r),Ze=n):lr(e,t,r);break;default:lr(e,t,r)}}function Jf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Up),t.forEach(function(n){var i=Yp.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function wt(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var u=e,C=t,I=C;e:for(;I!==null;){switch(I.tag){case 5:Ve=I.stateNode,bt=!1;break e;case 3:Ve=I.stateNode.containerInfo,bt=!0;break e;case 4:Ve=I.stateNode.containerInfo,bt=!0;break e}I=I.return}if(Ve===null)throw Error(te(160));Ah(u,C,i),Ve=null,bt=!1;var o=i.alternate;o!==null&&(o.return=null),i.return=null}catch(w){Ce(i,t,w)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Rh(t,e),t=t.sibling}function Rh(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(wt(t,e),Ht(e),n&4){try{ii(3,e,e.return),ss(3,e)}catch(R){Ce(e,e.return,R)}try{ii(5,e,e.return)}catch(R){Ce(e,e.return,R)}}break;case 1:wt(t,e),Ht(e),n&512&&r!==null&&vn(r,r.return);break;case 5:if(wt(t,e),Ht(e),n&512&&r!==null&&vn(r,r.return),e.flags&32){var i=e.stateNode;try{fi(i,"")}catch(R){Ce(e,e.return,R)}}if(n&4&&(i=e.stateNode,i!=null)){var u=e.memoizedProps,C=r!==null?r.memoizedProps:u,I=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{I==="input"&&u.type==="radio"&&u.name!=null&&Xc(i,u),Fo(I,C);var w=Fo(I,u);for(C=0;C<o.length;C+=2){var A=o[C],N=o[C+1];A==="style"?ed(i,N):A==="dangerouslySetInnerHTML"?Zc(i,N):A==="children"?fi(i,N):Kl(i,A,N,w)}switch(I){case"input":Oo(i,u);break;case"textarea":Qc(i,u);break;case"select":var O=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!u.multiple;var B=u.value;B!=null?mn(i,!!u.multiple,B,!1):O!==!!u.multiple&&(u.defaultValue!=null?mn(i,!!u.multiple,u.defaultValue,!0):mn(i,!!u.multiple,u.multiple?[]:"",!1))}i[Ei]=u}catch(R){Ce(e,e.return,R)}}break;case 6:if(wt(t,e),Ht(e),n&4){if(e.stateNode===null)throw Error(te(162));i=e.stateNode,u=e.memoizedProps;try{i.nodeValue=u}catch(R){Ce(e,e.return,R)}}break;case 3:if(wt(t,e),Ht(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{vi(t.containerInfo)}catch(R){Ce(e,e.return,R)}break;case 4:wt(t,e),Ht(e);break;case 13:wt(t,e),Ht(e),i=e.child,i.flags&8192&&(u=i.memoizedState!==null,i.stateNode.isHidden=u,!u||i.alternate!==null&&i.alternate.memoizedState!==null||(Eu=Me())),n&4&&Jf(e);break;case 22:if(A=r!==null&&r.memoizedState!==null,e.mode&1?(Ze=(w=Ze)||A,wt(t,e),Ze=w):wt(t,e),Ht(e),n&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!A&&e.mode&1)for(ae=e,A=e.child;A!==null;){for(N=ae=A;ae!==null;){switch(O=ae,B=O.child,O.tag){case 0:case 11:case 14:case 15:ii(4,O,O.return);break;case 1:vn(O,O.return);var F=O.stateNode;if(typeof F.componentWillUnmount=="function"){n=O,r=O.return;try{t=n,F.props=t.memoizedProps,F.state=t.memoizedState,F.componentWillUnmount()}catch(R){Ce(n,r,R)}}break;case 5:vn(O,O.return);break;case 22:if(O.memoizedState!==null){qf(N);continue}}B!==null?(B.return=O,ae=B):qf(N)}A=A.sibling}e:for(A=null,N=e;;){if(N.tag===5){if(A===null){A=N;try{i=N.stateNode,w?(u=i.style,typeof u.setProperty=="function"?u.setProperty("display","none","important"):u.display="none"):(I=N.stateNode,o=N.memoizedProps.style,C=o!=null&&o.hasOwnProperty("display")?o.display:null,I.style.display=qc("display",C))}catch(R){Ce(e,e.return,R)}}}else if(N.tag===6){if(A===null)try{N.stateNode.nodeValue=w?"":N.memoizedProps}catch(R){Ce(e,e.return,R)}}else if((N.tag!==22&&N.tag!==23||N.memoizedState===null||N===e)&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===e)break e;for(;N.sibling===null;){if(N.return===null||N.return===e)break e;A===N&&(A=null),N=N.return}A===N&&(A=null),N.sibling.return=N.return,N=N.sibling}}break;case 19:wt(t,e),Ht(e),n&4&&Jf(e);break;case 21:break;default:wt(t,e),Ht(e)}}function Ht(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Dh(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(fi(i,""),n.flags&=-33);var u=Qf(e);dl(e,u,i);break;case 3:case 4:var C=n.stateNode.containerInfo,I=Qf(e);cl(e,I,C);break;default:throw Error(te(161))}}catch(o){Ce(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kp(e,t,r){ae=e,Ch(e)}function Ch(e,t,r){for(var n=(e.mode&1)!==0;ae!==null;){var i=ae,u=i.child;if(i.tag===22&&n){var C=i.memoizedState!==null||ta;if(!C){var I=i.alternate,o=I!==null&&I.memoizedState!==null||Ze;I=ta;var w=Ze;if(ta=C,(Ze=o)&&!w)for(ae=i;ae!==null;)C=ae,o=C.child,C.tag===22&&C.memoizedState!==null?ec(i):o!==null?(o.return=C,ae=o):ec(i);for(;u!==null;)ae=u,Ch(u),u=u.sibling;ae=i,ta=I,Ze=w}Zf(e)}else i.subtreeFlags&8772&&u!==null?(u.return=i,ae=u):Zf(e)}}function Zf(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ze||ss(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ze)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:kt(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;u!==null&&bf(t,u,n);break;case 3:var C=t.updateQueue;if(C!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}bf(t,C,r)}break;case 5:var I=t.stateNode;if(r===null&&t.flags&4){r=I;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var w=t.alternate;if(w!==null){var A=w.memoizedState;if(A!==null){var N=A.dehydrated;N!==null&&vi(N)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Ze||t.flags&512&&fl(t)}catch(O){Ce(t,t.return,O)}}if(t===e){ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,ae=r;break}ae=t.return}}function qf(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ae=r;break}ae=t.return}}function ec(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ss(4,t)}catch(o){Ce(t,r,o)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(o){Ce(t,i,o)}}var u=t.return;try{fl(t)}catch(o){Ce(t,u,o)}break;case 5:var C=t.return;try{fl(t)}catch(o){Ce(t,C,o)}}}catch(o){Ce(t,t.return,o)}if(t===e){ae=null;break}var I=t.sibling;if(I!==null){I.return=t.return,ae=I;break}ae=t.return}}var Wp=Math.ceil,Ua=or.ReactCurrentDispatcher,mu=or.ReactCurrentOwner,Pt=or.ReactCurrentBatchConfig,ce=0,Ke=null,be=null,ze=0,ft=0,gn=wr(0),Ue=0,Pi=null,Yr=0,os=0,yu=0,ai=null,at=null,Eu=0,On=1/0,Jt=null,Ba=!1,hl=null,_r=null,ra=!1,gr=null,Ka=0,si=0,vl=null,ha=-1,va=0;function rt(){return ce&6?Me():ha!==-1?ha:ha=Me()}function xr(e){return e.mode&1?ce&2&&ze!==0?ze&-ze:Lp.transition!==null?(va===0&&(va=dd()),va):(e=he,e!==0||(e=window.event,e=e===void 0?16:Ed(e.type)),e):1}function Kt(e,t,r,n){if(50<si)throw si=0,vl=null,Error(te(185));Oi(e,r,n),(!(ce&2)||e!==Ke)&&(e===Ke&&(!(ce&2)&&(os|=r),Ue===4&&dr(e,ze)),ut(e,n),r===1&&ce===0&&!(t.mode&1)&&(On=Me()+500,ns&&kr()))}function ut(e,t){var r=e.callbackNode;Lg(e,t);var n=xa(e,e===Ke?ze:0);if(n===0)r!==null&&uf(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&uf(r),t===1)e.tag===0?xp(tc.bind(null,e)):Ud(tc.bind(null,e)),Ep(function(){!(ce&6)&&kr()}),r=null;else{switch(hd(n)){case 1:r=Vl;break;case 4:r=fd;break;case 16:r=_a;break;case 536870912:r=cd;break;default:r=_a}r=Nh(r,Ih.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Ih(e,t){if(ha=-1,va=0,ce&6)throw Error(te(327));var r=e.callbackNode;if(_n()&&e.callbackNode!==r)return null;var n=xa(e,e===Ke?ze:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Wa(e,n);else{t=n;var i=ce;ce|=2;var u=Mh();(Ke!==e||ze!==t)&&(Jt=null,On=Me()+500,jr(e,t));do try{Hp();break}catch(I){Oh(e,I)}while(1);iu(),Ua.current=u,ce=i,be!==null?t=0:(Ke=null,ze=0,t=Ue)}if(t!==0){if(t===2&&(i=Wo(e),i!==0&&(n=i,t=gl(e,i))),t===1)throw r=Pi,jr(e,0),dr(e,n),ut(e,Me()),r;if(t===6)dr(e,n);else{if(i=e.current.alternate,!(n&30)&&!Gp(i)&&(t=Wa(e,n),t===2&&(u=Wo(e),u!==0&&(n=u,t=gl(e,u))),t===1))throw r=Pi,jr(e,0),dr(e,n),ut(e,Me()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(te(345));case 2:Ur(e,at,Jt);break;case 3:if(dr(e,n),(n&130023424)===n&&(t=Eu+500-Me(),10<t)){if(xa(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){rt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Xo(Ur.bind(null,e,at,Jt),t);break}Ur(e,at,Jt);break;case 4:if(dr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var C=31-Bt(n);u=1<<C,C=t[C],C>i&&(i=C),n&=~u}if(n=i,n=Me()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Wp(n/1960))-n,10<n){e.timeoutHandle=Xo(Ur.bind(null,e,at,Jt),n);break}Ur(e,at,Jt);break;case 5:Ur(e,at,Jt);break;default:throw Error(te(329))}}}return ut(e,Me()),e.callbackNode===r?Ih.bind(null,e):null}function gl(e,t){var r=ai;return e.current.memoizedState.isDehydrated&&(jr(e,t).flags|=256),e=Wa(e,t),e!==2&&(t=at,at=r,t!==null&&pl(t)),e}function pl(e){at===null?at=e:at.push.apply(at,e)}function Gp(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],u=i.getSnapshot;i=i.value;try{if(!Wt(u(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function dr(e,t){for(t&=~yu,t&=~os,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Bt(t),n=1<<r;e[r]=-1,t&=~n}}function tc(e){if(ce&6)throw Error(te(327));_n();var t=xa(e,0);if(!(t&1))return ut(e,Me()),null;var r=Wa(e,t);if(e.tag!==0&&r===2){var n=Wo(e);n!==0&&(t=n,r=gl(e,n))}if(r===1)throw r=Pi,jr(e,0),dr(e,t),ut(e,Me()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ur(e,at,Jt),ut(e,Me()),null}function Tu(e,t){var r=ce;ce|=1;try{return e(t)}finally{ce=r,ce===0&&(On=Me()+500,ns&&kr())}}function Xr(e){gr!==null&&gr.tag===0&&!(ce&6)&&_n();var t=ce;ce|=1;var r=Pt.transition,n=he;try{if(Pt.transition=null,he=1,e)return e()}finally{he=n,Pt.transition=r,ce=t,!(ce&6)&&kr()}}function Su(){ft=gn.current,_e(gn)}function jr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,yp(r)),be!==null)for(r=be.return;r!==null;){var n=r;switch(tu(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ra();break;case 3:Cn(),_e(ot),_e(qe),fu();break;case 5:uu(n);break;case 4:Cn();break;case 13:_e(De);break;case 19:_e(De);break;case 10:au(n.type._context);break;case 22:case 23:Su()}r=r.return}if(Ke=e,be=e=Lr(e.current,null),ze=ft=t,Ue=0,Pi=null,yu=os=Yr=0,at=ai=null,Wr!==null){for(t=0;t<Wr.length;t++)if(r=Wr[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,u=r.pending;if(u!==null){var C=u.next;u.next=i,n.next=C}r.pending=n}Wr=null}return e}function Oh(e,t){do{var r=be;try{if(iu(),fa.current=Na,Fa){for(var n=Ae.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Fa=!1}if($r=0,Be=Ne=Ae=null,ni=!1,_i=0,mu.current=null,r===null||r.return===null){Ue=1,Pi=t,be=null;break}e:{var u=e,C=r.return,I=r,o=t;if(t=ze,I.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var w=o,A=I,N=A.tag;if(!(A.mode&1)&&(N===0||N===11||N===15)){var O=A.alternate;O?(A.updateQueue=O.updateQueue,A.memoizedState=O.memoizedState,A.lanes=O.lanes):(A.updateQueue=null,A.memoizedState=null)}var B=Gf(C);if(B!==null){B.flags&=-257,jf(B,C,I,u,t),B.mode&1&&Wf(u,w,t),t=B,o=w;var F=t.updateQueue;if(F===null){var R=new Set;R.add(o),t.updateQueue=R}else F.add(o);break e}else{if(!(t&1)){Wf(u,w,t),_u();break e}o=Error(te(426))}}else if(Pe&&I.mode&1){var b=Gf(C);if(b!==null){!(b.flags&65536)&&(b.flags|=256),jf(b,C,I,u,t),ru(In(o,I));break e}}u=o=In(o,I),Ue!==4&&(Ue=2),ai===null?ai=[u]:ai.push(u),u=C;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t;var S=vh(u,o,t);kf(u,S);break e;case 1:I=o;var y=u.type,s=u.stateNode;if(!(u.flags&128)&&(typeof y.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(_r===null||!_r.has(s)))){u.flags|=65536,t&=-t,u.lanes|=t;var D=gh(u,I,t);kf(u,D);break e}}u=u.return}while(u!==null)}kh(r)}catch(x){t=x,be===r&&r!==null&&(be=r=r.return);continue}break}while(1)}function Mh(){var e=Ua.current;return Ua.current=Na,e===null?Na:e}function _u(){(Ue===0||Ue===3||Ue===2)&&(Ue=4),Ke===null||!(Yr&268435455)&&!(os&268435455)||dr(Ke,ze)}function Wa(e,t){var r=ce;ce|=2;var n=Mh();(Ke!==e||ze!==t)&&(Jt=null,jr(e,t));do try{jp();break}catch(i){Oh(e,i)}while(1);if(iu(),ce=r,Ua.current=n,be!==null)throw Error(te(261));return Ke=null,ze=0,Ue}function jp(){for(;be!==null;)wh(be)}function Hp(){for(;be!==null&&!gg();)wh(be)}function wh(e){var t=Fh(e.alternate,e,ft);e.memoizedProps=e.pendingProps,t===null?kh(e):be=t,mu.current=null}function kh(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Np(r,t),r!==null){r.flags&=32767,be=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ue=6,be=null;return}}else if(r=Fp(r,t,ft),r!==null){be=r;return}if(t=t.sibling,t!==null){be=t;return}be=t=e}while(t!==null);Ue===0&&(Ue=5)}function Ur(e,t,r){var n=he,i=Pt.transition;try{Pt.transition=null,he=1,Vp(e,t,r,n)}finally{Pt.transition=i,he=n}return null}function Vp(e,t,r,n){do _n();while(gr!==null);if(ce&6)throw Error(te(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var u=r.lanes|r.childLanes;if(Pg(e,u),e===Ke&&(be=Ke=null,ze=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ra||(ra=!0,Nh(_a,function(){return _n(),null})),u=(r.flags&15990)!==0,r.subtreeFlags&15990||u){u=Pt.transition,Pt.transition=null;var C=he;he=1;var I=ce;ce|=4,mu.current=null,Bp(e,r),Rh(r,e),cp($o),La=!!zo,$o=zo=null,e.current=r,Kp(r),pg(),ce=I,he=C,Pt.transition=u}else e.current=r;if(ra&&(ra=!1,gr=e,Ka=i),u=e.pendingLanes,u===0&&(_r=null),Eg(r.stateNode),ut(e,Me()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ba)throw Ba=!1,e=hl,hl=null,e;return Ka&1&&e.tag!==0&&_n(),u=e.pendingLanes,u&1?e===vl?si++:(si=0,vl=e):si=0,kr(),null}function _n(){if(gr!==null){var e=hd(Ka),t=Pt.transition,r=he;try{if(Pt.transition=null,he=16>e?16:e,gr===null)var n=!1;else{if(e=gr,gr=null,Ka=0,ce&6)throw Error(te(331));var i=ce;for(ce|=4,ae=e.current;ae!==null;){var u=ae,C=u.child;if(ae.flags&16){var I=u.deletions;if(I!==null){for(var o=0;o<I.length;o++){var w=I[o];for(ae=w;ae!==null;){var A=ae;switch(A.tag){case 0:case 11:case 15:ii(8,A,u)}var N=A.child;if(N!==null)N.return=A,ae=N;else for(;ae!==null;){A=ae;var O=A.sibling,B=A.return;if(Ph(A),A===w){ae=null;break}if(O!==null){O.return=B,ae=O;break}ae=B}}}var F=u.alternate;if(F!==null){var R=F.child;if(R!==null){F.child=null;do{var b=R.sibling;R.sibling=null,R=b}while(R!==null)}}ae=u}}if(u.subtreeFlags&2064&&C!==null)C.return=u,ae=C;else e:for(;ae!==null;){if(u=ae,u.flags&2048)switch(u.tag){case 0:case 11:case 15:ii(9,u,u.return)}var S=u.sibling;if(S!==null){S.return=u.return,ae=S;break e}ae=u.return}}var y=e.current;for(ae=y;ae!==null;){C=ae;var s=C.child;if(C.subtreeFlags&2064&&s!==null)s.return=C,ae=s;else e:for(C=y;ae!==null;){if(I=ae,I.flags&2048)try{switch(I.tag){case 0:case 11:case 15:ss(9,I)}}catch(x){Ce(I,I.return,x)}if(I===C){ae=null;break e}var D=I.sibling;if(D!==null){D.return=I.return,ae=D;break e}ae=I.return}}if(ce=i,kr(),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Za,e)}catch{}n=!0}return n}finally{he=r,Pt.transition=t}}return!1}function rc(e,t,r){t=In(r,t),t=vh(e,t,1),e=Sr(e,t,1),t=rt(),e!==null&&(Oi(e,1,t),ut(e,t))}function Ce(e,t,r){if(e.tag===3)rc(e,e,r);else for(;t!==null;){if(t.tag===3){rc(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(_r===null||!_r.has(n))){e=In(r,e),e=gh(t,e,1),t=Sr(t,e,1),e=rt(),t!==null&&(Oi(t,1,e),ut(t,e));break}}t=t.return}}function zp(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=rt(),e.pingedLanes|=e.suspendedLanes&r,Ke===e&&(ze&r)===r&&(Ue===4||Ue===3&&(ze&130023424)===ze&&500>Me()-Eu?jr(e,0):yu|=r),ut(e,t)}function bh(e,t){t===0&&(e.mode&1?(t=zi,zi<<=1,!(zi&130023424)&&(zi=4194304)):t=1);var r=rt();e=ir(e,t),e!==null&&(Oi(e,t,r),ut(e,r))}function $p(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),bh(e,r)}function Yp(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(t),bh(e,r)}var Fh;Fh=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ot.current)st=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return st=!1,bp(e,t,r);st=!!(e.flags&131072)}else st=!1,Pe&&t.flags&1048576&&Bd(t,Oa,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;da(e,t),e=t.pendingProps;var i=Dn(t,qe.current);Sn(t,r),i=du(null,t,n,e,i,r);var u=hu();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,lt(n)?(u=!0,Ca(t)):u=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ou(t),i.updater=is,t.stateNode=i,i._reactInternals=t,rl(t,n,e,r),t=al(null,t,n,!0,u,r)):(t.tag=0,Pe&&u&&eu(t),tt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(da(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Qp(n),e=kt(n,e),i){case 0:t=il(null,t,n,e,r);break e;case 1:t=zf(null,t,n,e,r);break e;case 11:t=Hf(null,t,n,e,r);break e;case 14:t=Vf(null,t,n,kt(n.type,e),r);break e}throw Error(te(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:kt(n,i),il(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:kt(n,i),zf(e,t,n,i,r);case 3:e:{if(Eh(t),e===null)throw Error(te(387));n=t.pendingProps,u=t.memoizedState,i=u.element,jd(e,t),ka(t,n,null,r);var C=t.memoizedState;if(n=C.element,u.isDehydrated)if(u={element:n,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){i=In(Error(te(423)),t),t=$f(e,t,n,r,i);break e}else if(n!==i){i=In(Error(te(424)),t),t=$f(e,t,n,r,i);break e}else for(ct=Tr(t.stateNode.containerInfo.firstChild),ht=t,Pe=!0,Ft=null,r=$d(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(An(),n===i){t=ar(e,t,r);break e}tt(e,t,n,r)}t=t.child}return t;case 5:return Yd(t),e===null&&qo(t),n=t.type,i=t.pendingProps,u=e!==null?e.memoizedProps:null,C=i.children,Yo(n,i)?C=null:u!==null&&Yo(n,u)&&(t.flags|=32),yh(e,t),tt(e,t,C,r),t.child;case 6:return e===null&&qo(t),null;case 13:return Th(e,t,r);case 4:return lu(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Rn(t,null,n,r):tt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:kt(n,i),Hf(e,t,n,i,r);case 7:return tt(e,t,t.pendingProps,r),t.child;case 8:return tt(e,t,t.pendingProps.children,r),t.child;case 12:return tt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,u=t.memoizedProps,C=i.value,Te(Ma,n._currentValue),n._currentValue=C,u!==null)if(Wt(u.value,C)){if(u.children===i.children&&!ot.current){t=ar(e,t,r);break e}}else for(u=t.child,u!==null&&(u.return=t);u!==null;){var I=u.dependencies;if(I!==null){C=u.child;for(var o=I.firstContext;o!==null;){if(o.context===n){if(u.tag===1){o=tr(-1,r&-r),o.tag=2;var w=u.updateQueue;if(w!==null){w=w.shared;var A=w.pending;A===null?o.next=o:(o.next=A.next,A.next=o),w.pending=o}}u.lanes|=r,o=u.alternate,o!==null&&(o.lanes|=r),el(u.return,r,t),I.lanes|=r;break}o=o.next}}else if(u.tag===10)C=u.type===t.type?null:u.child;else if(u.tag===18){if(C=u.return,C===null)throw Error(te(341));C.lanes|=r,I=C.alternate,I!==null&&(I.lanes|=r),el(C,r,t),C=u.sibling}else C=u.child;if(C!==null)C.return=u;else for(C=u;C!==null;){if(C===t){C=null;break}if(u=C.sibling,u!==null){u.return=C.return,C=u;break}C=C.return}u=C}tt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Sn(t,r),i=Dt(i),n=n(i),t.flags|=1,tt(e,t,n,r),t.child;case 14:return n=t.type,i=kt(n,t.pendingProps),i=kt(n.type,i),Vf(e,t,n,i,r);case 15:return ph(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:kt(n,i),da(e,t),t.tag=1,lt(n)?(e=!0,Ca(t)):e=!1,Sn(t,r),Vd(t,n,i),rl(t,n,i,r),al(null,t,n,!0,e,r);case 19:return Sh(e,t,r);case 22:return mh(e,t,r)}throw Error(te(156,t.tag))};function Nh(e,t){return ud(e,t)}function Xp(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lt(e,t,r,n){return new Xp(e,t,r,n)}function xu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qp(e){if(typeof e=="function")return xu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gl)return 11;if(e===jl)return 14}return 2}function Lr(e,t){var r=e.alternate;return r===null?(r=Lt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ga(e,t,r,n,i,u){var C=2;if(n=e,typeof e=="function")xu(e)&&(C=1);else if(typeof e=="string")C=5;else e:switch(e){case an:return Hr(r.children,i,u,t);case Wl:C=8,i|=8;break;case Do:return e=Lt(12,r,t,i|2),e.elementType=Do,e.lanes=u,e;case Ao:return e=Lt(13,r,t,i),e.elementType=Ao,e.lanes=u,e;case Ro:return e=Lt(19,r,t,i),e.elementType=Ro,e.lanes=u,e;case zc:return ls(r,i,u,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Hc:C=10;break e;case Vc:C=9;break e;case Gl:C=11;break e;case jl:C=14;break e;case ur:C=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=Lt(C,r,t,i),t.elementType=e,t.type=n,t.lanes=u,t}function Hr(e,t,r,n){return e=Lt(7,e,n,t),e.lanes=r,e}function ls(e,t,r,n){return e=Lt(22,e,n,t),e.elementType=zc,e.lanes=r,e.stateNode={isHidden:!1},e}function fo(e,t,r){return e=Lt(6,e,null,t),e.lanes=r,e}function co(e,t,r){return t=Lt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Jp(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vs(0),this.expirationTimes=Vs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vs(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Lu(e,t,r,n,i,u,C,I,o){return e=new Jp(e,t,r,I,o),t===1?(t=1,u===!0&&(t|=8)):t=0,u=Lt(3,null,null,t),e.current=u,u.stateNode=e,u.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ou(u),e}function Zp(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nn,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Uh(e){if(!e)return Cr;e=e._reactInternals;e:{if(Zr(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(lt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(lt(r))return Nd(e,r,t)}return t}function Bh(e,t,r,n,i,u,C,I,o){return e=Lu(r,n,!0,e,i,u,C,I,o),e.context=Uh(null),r=e.current,n=rt(),i=xr(r),u=tr(n,i),u.callback=t??null,Sr(r,u,i),e.current.lanes=i,Oi(e,i,n),ut(e,n),e}function us(e,t,r,n){var i=t.current,u=rt(),C=xr(i);return r=Uh(r),t.context===null?t.context=r:t.pendingContext=r,t=tr(u,C),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Sr(i,t,C),e!==null&&(Kt(e,i,C,u),ua(e,i,C)),C}function Ga(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Pu(e,t){nc(e,t),(e=e.alternate)&&nc(e,t)}function qp(){return null}var Kh=typeof reportError=="function"?reportError:function(e){console.error(e)};function Du(e){this._internalRoot=e}fs.prototype.render=Du.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));us(e,t,null,null)};fs.prototype.unmount=Du.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xr(function(){us(null,e,null,null)}),t[nr]=null}};function fs(e){this._internalRoot=e}fs.prototype.unstable_scheduleHydration=function(e){if(e){var t=pd();e={blockedOn:null,target:e,priority:t};for(var r=0;r<cr.length&&t!==0&&t<cr[r].priority;r++);cr.splice(r,0,e),r===0&&yd(e)}};function Au(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ic(){}function em(e,t,r,n,i){if(i){if(typeof n=="function"){var u=n;n=function(){var w=Ga(C);u.call(w)}}var C=Bh(t,n,e,0,null,!1,!1,"",ic);return e._reactRootContainer=C,e[nr]=C.current,mi(e.nodeType===8?e.parentNode:e),Xr(),C}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var I=n;n=function(){var w=Ga(o);I.call(w)}}var o=Lu(e,0,!1,null,null,!1,!1,"",ic);return e._reactRootContainer=o,e[nr]=o.current,mi(e.nodeType===8?e.parentNode:e),Xr(function(){us(t,o,r,n)}),o}function ds(e,t,r,n,i){var u=r._reactRootContainer;if(u){var C=u;if(typeof i=="function"){var I=i;i=function(){var o=Ga(C);I.call(o)}}us(t,C,e,i)}else C=em(r,t,e,i,n);return Ga(C)}vd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Xn(t.pendingLanes);r!==0&&(zl(t,r|1),ut(t,Me()),!(ce&6)&&(On=Me()+500,kr()))}break;case 13:Xr(function(){var n=ir(e,1);if(n!==null){var i=rt();Kt(n,e,1,i)}}),Pu(e,1)}};$l=function(e){if(e.tag===13){var t=ir(e,134217728);if(t!==null){var r=rt();Kt(t,e,134217728,r)}Pu(e,134217728)}};gd=function(e){if(e.tag===13){var t=xr(e),r=ir(e,t);if(r!==null){var n=rt();Kt(r,e,t,n)}Pu(e,t)}};pd=function(){return he};md=function(e,t){var r=he;try{return he=e,t()}finally{he=r}};Uo=function(e,t,r){switch(t){case"input":if(Oo(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=rs(n);if(!i)throw Error(te(90));Yc(n),Oo(n,i)}}}break;case"textarea":Qc(e,r);break;case"select":t=r.value,t!=null&&mn(e,!!r.multiple,t,!1)}};nd=Tu;id=Xr;var tm={usingClientEntryPoint:!1,Events:[wi,un,rs,td,rd,Tu]},zn={findFiberByHostInstance:Kr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rm={bundleType:zn.bundleType,version:zn.version,rendererPackageName:zn.rendererPackageName,rendererConfig:zn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:or.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=od(e),e===null?null:e.stateNode},findFiberByHostInstance:zn.findFiberByHostInstance||qp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var na=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!na.isDisabled&&na.supportsFiber)try{Za=na.inject(rm),$t=na}catch{}}pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tm;pt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Au(t))throw Error(te(200));return Zp(e,t,null,r)};pt.createRoot=function(e,t){if(!Au(e))throw Error(te(299));var r=!1,n="",i=Kh;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Lu(e,1,!1,null,null,r,!1,n,i),e[nr]=t.current,mi(e.nodeType===8?e.parentNode:e),new Du(t)};pt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=od(t),e=e===null?null:e.stateNode,e};pt.flushSync=function(e){return Xr(e)};pt.hydrate=function(e,t,r){if(!cs(t))throw Error(te(200));return ds(null,e,t,!0,r)};pt.hydrateRoot=function(e,t,r){if(!Au(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,i=!1,u="",C=Kh;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onRecoverableError!==void 0&&(C=r.onRecoverableError)),t=Bh(t,null,e,1,r??null,i,!1,u,C),e[nr]=t.current,mi(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new fs(t)};pt.render=function(e,t,r){if(!cs(t))throw Error(te(200));return ds(null,e,t,!1,r)};pt.unmountComponentAtNode=function(e){if(!cs(e))throw Error(te(40));return e._reactRootContainer?(Xr(function(){ds(null,null,e,!1,function(){e._reactRootContainer=null,e[nr]=null})}),!0):!1};pt.unstable_batchedUpdates=Tu;pt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cs(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return ds(e,t,r,!1,n)};pt.version="18.2.0-next-9e3b772b8-20220608";(function(e){function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}t(),e.exports=pt})(qv);var Wh,ac=ya;Wh=ac.createRoot,ac.hydrateRoot;var ml={},nm={get exports(){return ml},set exports(e){ml=e}},Gh={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mn=ee;function im(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var am=typeof Object.is=="function"?Object.is:im,sm=Mn.useState,om=Mn.useEffect,lm=Mn.useLayoutEffect,um=Mn.useDebugValue;function fm(e,t){var r=t(),n=sm({inst:{value:r,getSnapshot:t}}),i=n[0].inst,u=n[1];return lm(function(){i.value=r,i.getSnapshot=t,ho(i)&&u({inst:i})},[e,r,t]),om(function(){return ho(i)&&u({inst:i}),e(function(){ho(i)&&u({inst:i})})},[e]),um(r),r}function ho(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!am(e,r)}catch{return!0}}function cm(e,t){return t()}var dm=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?cm:fm;Gh.useSyncExternalStore=Mn.useSyncExternalStore!==void 0?Mn.useSyncExternalStore:dm;(function(e){e.exports=Gh})(nm);var yl={},hm={get exports(){return yl},set exports(e){yl=e}},jh={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hs=ee,vm=ml;function gm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pm=typeof Object.is=="function"?Object.is:gm,mm=vm.useSyncExternalStore,ym=hs.useRef,Em=hs.useEffect,Tm=hs.useMemo,Sm=hs.useDebugValue;jh.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var u=ym(null);if(u.current===null){var C={hasValue:!1,value:null};u.current=C}else C=u.current;u=Tm(function(){function o(B){if(!w){if(w=!0,A=B,B=n(B),i!==void 0&&C.hasValue){var F=C.value;if(i(F,B))return N=F}return N=B}if(F=N,pm(A,B))return F;var R=n(B);return i!==void 0&&i(F,R)?F:(A=B,N=R)}var w=!1,A,N,O=r===void 0?null:r;return[function(){return o(t())},O===null?void 0:function(){return o(O())}]},[t,r,n,i]);var I=mm(e,u[0],u[1]);return Em(function(){C.hasValue=!0,C.value=I},[I]),Sm(I),I};(function(e){e.exports=jh})(hm);function _m(e){e()}let Hh=_m;const xm=e=>Hh=e,Lm=()=>Hh,Ir=ee.createContext(null);function Vh(){return ee.useContext(Ir)}const Pm=()=>{throw new Error("uSES not initialized!")};let zh=Pm;const Dm=e=>{zh=e},Am=(e,t)=>e===t;function Rm(e=Ir){const t=e===Ir?Vh:()=>ee.useContext(e);return function(n,i=Am){const{store:u,subscription:C,getServerState:I}=t(),o=zh(C.addNestedSub,u.getState,I||u.getState,n,i);return ee.useDebugValue(o),o}}const Cm=Rm();var El={},Im={get exports(){return El},set exports(e){El=e}},ve={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var We=typeof Symbol=="function"&&Symbol.for,Ru=We?Symbol.for("react.element"):60103,Cu=We?Symbol.for("react.portal"):60106,vs=We?Symbol.for("react.fragment"):60107,gs=We?Symbol.for("react.strict_mode"):60108,ps=We?Symbol.for("react.profiler"):60114,ms=We?Symbol.for("react.provider"):60109,ys=We?Symbol.for("react.context"):60110,Iu=We?Symbol.for("react.async_mode"):60111,Es=We?Symbol.for("react.concurrent_mode"):60111,Ts=We?Symbol.for("react.forward_ref"):60112,Ss=We?Symbol.for("react.suspense"):60113,Om=We?Symbol.for("react.suspense_list"):60120,_s=We?Symbol.for("react.memo"):60115,xs=We?Symbol.for("react.lazy"):60116,Mm=We?Symbol.for("react.block"):60121,wm=We?Symbol.for("react.fundamental"):60117,km=We?Symbol.for("react.responder"):60118,bm=We?Symbol.for("react.scope"):60119;function yt(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Ru:switch(e=e.type,e){case Iu:case Es:case vs:case ps:case gs:case Ss:return e;default:switch(e=e&&e.$$typeof,e){case ys:case Ts:case xs:case _s:case ms:return e;default:return t}}case Cu:return t}}}function $h(e){return yt(e)===Es}ve.AsyncMode=Iu;ve.ConcurrentMode=Es;ve.ContextConsumer=ys;ve.ContextProvider=ms;ve.Element=Ru;ve.ForwardRef=Ts;ve.Fragment=vs;ve.Lazy=xs;ve.Memo=_s;ve.Portal=Cu;ve.Profiler=ps;ve.StrictMode=gs;ve.Suspense=Ss;ve.isAsyncMode=function(e){return $h(e)||yt(e)===Iu};ve.isConcurrentMode=$h;ve.isContextConsumer=function(e){return yt(e)===ys};ve.isContextProvider=function(e){return yt(e)===ms};ve.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ru};ve.isForwardRef=function(e){return yt(e)===Ts};ve.isFragment=function(e){return yt(e)===vs};ve.isLazy=function(e){return yt(e)===xs};ve.isMemo=function(e){return yt(e)===_s};ve.isPortal=function(e){return yt(e)===Cu};ve.isProfiler=function(e){return yt(e)===ps};ve.isStrictMode=function(e){return yt(e)===gs};ve.isSuspense=function(e){return yt(e)===Ss};ve.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===vs||e===Es||e===ps||e===gs||e===Ss||e===Om||typeof e=="object"&&e!==null&&(e.$$typeof===xs||e.$$typeof===_s||e.$$typeof===ms||e.$$typeof===ys||e.$$typeof===Ts||e.$$typeof===wm||e.$$typeof===km||e.$$typeof===bm||e.$$typeof===Mm)};ve.typeOf=yt;(function(e){e.exports=ve})(Im);var Yh=El,Fm={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Nm={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Xh={};Xh[Yh.ForwardRef]=Fm;Xh[Yh.Memo]=Nm;var sc={},Um={get exports(){return sc},set exports(e){sc=e}},ge={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ou=Symbol.for("react.element"),Mu=Symbol.for("react.portal"),Ls=Symbol.for("react.fragment"),Ps=Symbol.for("react.strict_mode"),Ds=Symbol.for("react.profiler"),As=Symbol.for("react.provider"),Rs=Symbol.for("react.context"),Bm=Symbol.for("react.server_context"),Cs=Symbol.for("react.forward_ref"),Is=Symbol.for("react.suspense"),Os=Symbol.for("react.suspense_list"),Ms=Symbol.for("react.memo"),ws=Symbol.for("react.lazy"),Km=Symbol.for("react.offscreen"),Qh;Qh=Symbol.for("react.module.reference");function Rt(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Ou:switch(e=e.type,e){case Ls:case Ds:case Ps:case Is:case Os:return e;default:switch(e=e&&e.$$typeof,e){case Bm:case Rs:case Cs:case ws:case Ms:case As:return e;default:return t}}case Mu:return t}}}ge.ContextConsumer=Rs;ge.ContextProvider=As;ge.Element=Ou;ge.ForwardRef=Cs;ge.Fragment=Ls;ge.Lazy=ws;ge.Memo=Ms;ge.Portal=Mu;ge.Profiler=Ds;ge.StrictMode=Ps;ge.Suspense=Is;ge.SuspenseList=Os;ge.isAsyncMode=function(){return!1};ge.isConcurrentMode=function(){return!1};ge.isContextConsumer=function(e){return Rt(e)===Rs};ge.isContextProvider=function(e){return Rt(e)===As};ge.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ou};ge.isForwardRef=function(e){return Rt(e)===Cs};ge.isFragment=function(e){return Rt(e)===Ls};ge.isLazy=function(e){return Rt(e)===ws};ge.isMemo=function(e){return Rt(e)===Ms};ge.isPortal=function(e){return Rt(e)===Mu};ge.isProfiler=function(e){return Rt(e)===Ds};ge.isStrictMode=function(e){return Rt(e)===Ps};ge.isSuspense=function(e){return Rt(e)===Is};ge.isSuspenseList=function(e){return Rt(e)===Os};ge.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Ls||e===Ds||e===Ps||e===Is||e===Os||e===Km||typeof e=="object"&&e!==null&&(e.$$typeof===ws||e.$$typeof===Ms||e.$$typeof===As||e.$$typeof===Rs||e.$$typeof===Cs||e.$$typeof===Qh||e.getModuleId!==void 0)};ge.typeOf=Rt;(function(e){e.exports=ge})(Um);function Wm(){const e=Lm();let t=null,r=null;return{clear(){t=null,r=null},notify(){e(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){let n=[],i=t;for(;i;)n.push(i),i=i.next;return n},subscribe(n){let i=!0,u=r={callback:n,next:null,prev:r};return u.prev?u.prev.next=u:t=u,function(){!i||t===null||(i=!1,u.next?u.next.prev=u.prev:r=u.prev,u.prev?u.prev.next=u.next:t=u.next)}}}}const oc={notify(){},get:()=>[]};function Gm(e,t){let r,n=oc;function i(N){return o(),n.subscribe(N)}function u(){n.notify()}function C(){A.onStateChange&&A.onStateChange()}function I(){return Boolean(r)}function o(){r||(r=t?t.addNestedSub(C):e.subscribe(C),n=Wm())}function w(){r&&(r(),r=void 0,n.clear(),n=oc)}const A={addNestedSub:i,notifyNestedSubs:u,handleChangeWrapper:C,isSubscribed:I,trySubscribe:o,tryUnsubscribe:w,getListeners:()=>n};return A}const jm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Hm=jm?ee.useLayoutEffect:ee.useEffect;function Vm({store:e,context:t,children:r,serverState:n}){const i=ee.useMemo(()=>{const I=Gm(e);return{store:e,subscription:I,getServerState:n?()=>n:void 0}},[e,n]),u=ee.useMemo(()=>e.getState(),[e]);Hm(()=>{const{subscription:I}=i;return I.onStateChange=I.notifyNestedSubs,I.trySubscribe(),u!==e.getState()&&I.notifyNestedSubs(),()=>{I.tryUnsubscribe(),I.onStateChange=void 0}},[i,u]);const C=t||Ir;return Bc.createElement(C.Provider,{value:i},r)}function Jh(e=Ir){const t=e===Ir?Vh:()=>ee.useContext(e);return function(){const{store:n}=t();return n}}const zm=Jh();function $m(e=Ir){const t=e===Ir?zm:Jh(e);return function(){return t().dispatch}}const Ym=$m();Dm(yl.useSyncExternalStoreWithSelector);xm(ya.unstable_batchedUpdates);/**
 * @remix-run/router v1.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Di.apply(this,arguments)}var pr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(pr||(pr={}));const lc="popstate";function Xm(e){e===void 0&&(e={});function t(i,u){let{pathname:C="/",search:I="",hash:o=""}=qr(i.location.hash.substr(1));return Tl("",{pathname:C,search:I,hash:o},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function r(i,u){let C=i.document.querySelector("base"),I="";if(C&&C.getAttribute("href")){let o=i.location.href,w=o.indexOf("#");I=w===-1?o:o.slice(0,w)}return I+"#"+(typeof u=="string"?u:ja(u))}function n(i,u){ks(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(u)+")")}return Jm(t,r,n,e)}function Fe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ks(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Qm(){return Math.random().toString(36).substr(2,8)}function uc(e,t){return{usr:e.state,key:e.key,idx:t}}function Tl(e,t,r,n){return r===void 0&&(r=null),Di({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?qr(t):t,{state:r,key:t&&t.key||n||Qm()})}function ja(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function qr(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Jm(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:u=!1}=n,C=i.history,I=pr.Pop,o=null,w=A();w==null&&(w=0,C.replaceState(Di({},C.state,{idx:w}),""));function A(){return(C.state||{idx:null}).idx}function N(){I=pr.Pop;let b=A(),S=b==null?null:b-w;w=b,o&&o({action:I,location:R.location,delta:S})}function O(b,S){I=pr.Push;let y=Tl(R.location,b,S);r&&r(y,b),w=A()+1;let s=uc(y,w),D=R.createHref(y);try{C.pushState(s,"",D)}catch{i.location.assign(D)}u&&o&&o({action:I,location:R.location,delta:1})}function B(b,S){I=pr.Replace;let y=Tl(R.location,b,S);r&&r(y,b),w=A();let s=uc(y,w),D=R.createHref(y);C.replaceState(s,"",D),u&&o&&o({action:I,location:R.location,delta:0})}function F(b){let S=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof b=="string"?b:ja(b);return Fe(S,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,S)}let R={get action(){return I},get location(){return e(i,C)},listen(b){if(o)throw new Error("A history only accepts one active listener");return i.addEventListener(lc,N),o=b,()=>{i.removeEventListener(lc,N),o=null}},createHref(b){return t(i,b)},createURL:F,encodeLocation(b){let S=F(b);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:O,replace:B,go(b){return C.go(b)}};return R}var fc;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(fc||(fc={}));function Zm(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?qr(t):t,i=wu(n.pathname||"/",r);if(i==null)return null;let u=Zh(e);qm(u);let C=null;for(let I=0;C==null&&I<u.length;++I)C=l0(u[I],c0(i));return C}function Zh(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(u,C,I)=>{let o={relativePath:I===void 0?u.path||"":I,caseSensitive:u.caseSensitive===!0,childrenIndex:C,route:u};o.relativePath.startsWith("/")&&(Fe(o.relativePath.startsWith(n),'Absolute route path "'+o.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),o.relativePath=o.relativePath.slice(n.length));let w=Pr([n,o.relativePath]),A=r.concat(o);u.children&&u.children.length>0&&(Fe(u.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),Zh(u.children,t,A,w)),!(u.path==null&&!u.index)&&t.push({path:w,score:s0(w,u.index),routesMeta:A})};return e.forEach((u,C)=>{var I;if(u.path===""||!((I=u.path)!=null&&I.includes("?")))i(u,C);else for(let o of qh(u.path))i(u,C,o)}),t}function qh(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),u=r.replace(/\?$/,"");if(n.length===0)return i?[u,""]:[u];let C=qh(n.join("/")),I=[];return I.push(...C.map(o=>o===""?u:[u,o].join("/"))),i&&I.push(...C),I.map(o=>e.startsWith("/")&&o===""?"/":o)}function qm(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:o0(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const e0=/^:\w+$/,t0=3,r0=2,n0=1,i0=10,a0=-2,cc=e=>e==="*";function s0(e,t){let r=e.split("/"),n=r.length;return r.some(cc)&&(n+=a0),t&&(n+=r0),r.filter(i=>!cc(i)).reduce((i,u)=>i+(e0.test(u)?t0:u===""?n0:i0),n)}function o0(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function l0(e,t){let{routesMeta:r}=e,n={},i="/",u=[];for(let C=0;C<r.length;++C){let I=r[C],o=C===r.length-1,w=i==="/"?t:t.slice(i.length)||"/",A=u0({path:I.relativePath,caseSensitive:I.caseSensitive,end:o},w);if(!A)return null;Object.assign(n,A.params);let N=I.route;u.push({params:n,pathname:Pr([i,A.pathname]),pathnameBase:g0(Pr([i,A.pathnameBase])),route:N}),A.pathnameBase!=="/"&&(i=Pr([i,A.pathnameBase]))}return u}function u0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=f0(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let u=i[0],C=u.replace(/(.)\/+$/,"$1"),I=i.slice(1);return{params:n.reduce((w,A,N)=>{if(A==="*"){let O=I[N]||"";C=u.slice(0,u.length-O.length).replace(/(.)\/+$/,"$1")}return w[A]=d0(I[N]||"",A),w},{}),pathname:u,pathnameBase:C,pattern:e}}function f0(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ks(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(C,I)=>(n.push(I),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function c0(e){try{return decodeURI(e)}catch(t){return ks(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function d0(e,t){try{return decodeURIComponent(e)}catch(r){return ks(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function wu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function h0(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?qr(e):e;return{pathname:r?r.startsWith("/")?r:v0(r,t):t,search:p0(n),hash:m0(i)}}function v0(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function vo(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ev(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function tv(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=qr(e):(i=Di({},e),Fe(!i.pathname||!i.pathname.includes("?"),vo("?","pathname","search",i)),Fe(!i.pathname||!i.pathname.includes("#"),vo("#","pathname","hash",i)),Fe(!i.search||!i.search.includes("#"),vo("#","search","hash",i)));let u=e===""||i.pathname==="",C=u?"/":i.pathname,I;if(n||C==null)I=r;else{let N=t.length-1;if(C.startsWith("..")){let O=C.split("/");for(;O[0]==="..";)O.shift(),N-=1;i.pathname=O.join("/")}I=N>=0?t[N]:"/"}let o=h0(i,I),w=C&&C!=="/"&&C.endsWith("/"),A=(u||C===".")&&r.endsWith("/");return!o.pathname.endsWith("/")&&(w||A)&&(o.pathname+="/"),o}const Pr=e=>e.join("/").replace(/\/\/+/g,"/"),g0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),p0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,m0=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function y0(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const E0=["post","put","patch","delete"];[...E0];/**
 * React Router v6.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const S0=typeof Object.is=="function"?Object.is:T0,{useState:_0,useEffect:x0,useLayoutEffect:L0,useDebugValue:P0}=xo;function D0(e,t,r){const n=t(),[{inst:i},u]=_0({inst:{value:n,getSnapshot:t}});return L0(()=>{i.value=n,i.getSnapshot=t,go(i)&&u({inst:i})},[e,n,t]),x0(()=>(go(i)&&u({inst:i}),e(()=>{go(i)&&u({inst:i})})),[e]),P0(n),n}function go(e){const t=e.getSnapshot,r=e.value;try{const n=t();return!S0(r,n)}catch{return!0}}function A0(e,t,r){return t()}const R0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",C0=!R0,I0=C0?A0:D0;"useSyncExternalStore"in xo&&(e=>e.useSyncExternalStore)(xo);const rv=ee.createContext(null),ku=ee.createContext(null),bi=ee.createContext(null),bs=ee.createContext(null),br=ee.createContext({outlet:null,matches:[]}),nv=ee.createContext(null);function Sl(){return Sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sl.apply(this,arguments)}function O0(e,t){let{relative:r}=t===void 0?{}:t;Fn()||Fe(!1);let{basename:n,navigator:i}=ee.useContext(bi),{hash:u,pathname:C,search:I}=iv(e,{relative:r}),o=C;return n!=="/"&&(o=C==="/"?n:Pr([n,C])),i.createHref({pathname:o,search:I,hash:u})}function Fn(){return ee.useContext(bs)!=null}function Nn(){return Fn()||Fe(!1),ee.useContext(bs).location}function Fi(){Fn()||Fe(!1);let{basename:e,navigator:t}=ee.useContext(bi),{matches:r}=ee.useContext(br),{pathname:n}=Nn(),i=JSON.stringify(ev(r).map(I=>I.pathnameBase)),u=ee.useRef(!1);return ee.useEffect(()=>{u.current=!0}),ee.useCallback(function(I,o){if(o===void 0&&(o={}),!u.current)return;if(typeof I=="number"){t.go(I);return}let w=tv(I,JSON.parse(i),n,o.relative==="path");e!=="/"&&(w.pathname=w.pathname==="/"?e:Pr([e,w.pathname])),(o.replace?t.replace:t.push)(w,o.state,o)},[e,t,i,n])}const M0=ee.createContext(null);function w0(e){let t=ee.useContext(br).outlet;return t&&ee.createElement(M0.Provider,{value:e},t)}function k0(){let{matches:e}=ee.useContext(br),t=e[e.length-1];return t?t.params:{}}function iv(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=ee.useContext(br),{pathname:i}=Nn(),u=JSON.stringify(ev(n).map(C=>C.pathnameBase));return ee.useMemo(()=>tv(e,JSON.parse(u),i,r==="path"),[e,u,i,r])}function b0(e,t){Fn()||Fe(!1);let{navigator:r}=ee.useContext(bi),n=ee.useContext(ku),{matches:i}=ee.useContext(br),u=i[i.length-1],C=u?u.params:{};u&&u.pathname;let I=u?u.pathnameBase:"/";u&&u.route;let o=Nn(),w;if(t){var A;let R=typeof t=="string"?qr(t):t;I==="/"||(A=R.pathname)!=null&&A.startsWith(I)||Fe(!1),w=R}else w=o;let N=w.pathname||"/",O=I==="/"?N:N.slice(I.length)||"/",B=Zm(e,{pathname:O}),F=B0(B&&B.map(R=>Object.assign({},R,{params:Object.assign({},C,R.params),pathname:Pr([I,r.encodeLocation?r.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?I:Pr([I,r.encodeLocation?r.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),i,n||void 0);return t&&F?ee.createElement(bs.Provider,{value:{location:Sl({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:pr.Pop}},F):F}function F0(){let e=j0(),t=y0(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},u=null;return ee.createElement(ee.Fragment,null,ee.createElement("h2",null,"Unexpected Application Error!"),ee.createElement("h3",{style:{fontStyle:"italic"}},t),r?ee.createElement("pre",{style:i},r):null,u)}class N0 extends ee.Component{constructor(t){super(t),this.state={location:t.location,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location?{error:t.error,location:t.location}:{error:t.error||r.error,location:r.location}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?ee.createElement(br.Provider,{value:this.props.routeContext},ee.createElement(nv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function U0(e){let{routeContext:t,match:r,children:n}=e,i=ee.useContext(rv);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),ee.createElement(br.Provider,{value:t},n)}function B0(e,t,r){if(t===void 0&&(t=[]),e==null)if(r!=null&&r.errors)e=r.matches;else return null;let n=e,i=r==null?void 0:r.errors;if(i!=null){let u=n.findIndex(C=>C.route.id&&(i==null?void 0:i[C.route.id]));u>=0||Fe(!1),n=n.slice(0,Math.min(n.length,u+1))}return n.reduceRight((u,C,I)=>{let o=C.route.id?i==null?void 0:i[C.route.id]:null,w=null;r&&(C.route.ErrorBoundary?w=ee.createElement(C.route.ErrorBoundary,null):C.route.errorElement?w=C.route.errorElement:w=ee.createElement(F0,null));let A=t.concat(n.slice(0,I+1)),N=()=>{let O=u;return o?O=w:C.route.Component?O=ee.createElement(C.route.Component,null):C.route.element&&(O=C.route.element),ee.createElement(U0,{match:C,routeContext:{outlet:u,matches:A},children:O})};return r&&(C.route.ErrorBoundary||C.route.errorElement||I===0)?ee.createElement(N0,{location:r.location,component:w,error:o,children:N(),routeContext:{outlet:null,matches:A}}):N()},null)}var dc;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"})(dc||(dc={}));var Ha;(function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"})(Ha||(Ha={}));function K0(e){let t=ee.useContext(ku);return t||Fe(!1),t}function W0(e){let t=ee.useContext(br);return t||Fe(!1),t}function G0(e){let t=W0(),r=t.matches[t.matches.length-1];return r.route.id||Fe(!1),r.route.id}function j0(){var e;let t=ee.useContext(nv),r=K0(Ha.UseRouteError),n=G0(Ha.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function H0(e){let{to:t,replace:r,state:n,relative:i}=e;Fn()||Fe(!1);let u=ee.useContext(ku),C=Fi();return ee.useEffect(()=>{u&&u.navigation.state!=="idle"||C(t,{replace:r,state:n,relative:i})}),null}function V0(e){return w0(e.context)}function rn(e){Fe(!1)}function z0(e){let{basename:t="/",children:r=null,location:n,navigationType:i=pr.Pop,navigator:u,static:C=!1}=e;Fn()&&Fe(!1);let I=t.replace(/^\/*/,"/"),o=ee.useMemo(()=>({basename:I,navigator:u,static:C}),[I,u,C]);typeof n=="string"&&(n=qr(n));let{pathname:w="/",search:A="",hash:N="",state:O=null,key:B="default"}=n,F=ee.useMemo(()=>{let R=wu(w,I);return R==null?null:{location:{pathname:R,search:A,hash:N,state:O,key:B},navigationType:i}},[I,w,A,N,O,B,i]);return F==null?null:ee.createElement(bi.Provider,{value:o},ee.createElement(bs.Provider,{children:r,value:F}))}function $0(e){let{children:t,location:r}=e,n=ee.useContext(rv),i=n&&!t?n.router.routes:_l(t);return b0(i,r)}var hc;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(hc||(hc={}));new Promise(()=>{});function _l(e,t){t===void 0&&(t=[]);let r=[];return ee.Children.forEach(e,(n,i)=>{if(!ee.isValidElement(n))return;if(n.type===ee.Fragment){r.push.apply(r,_l(n.props.children,t));return}n.type!==rn&&Fe(!1),!n.props.index||!n.props.children||Fe(!1);let u=[...t,i],C={id:n.props.id||u.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(C.children=_l(n.props.children,u)),r.push(C)}),r}/**
 * React Router DOM v6.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xl(){return xl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xl.apply(this,arguments)}function Y0(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,u;for(u=0;u<n.length;u++)i=n[u],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function X0(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Q0(e,t){return e.button===0&&(!t||t==="_self")&&!X0(e)}function Ll(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function J0(e,t){let r=Ll(e);if(t)for(let n of t.keys())r.has(n)||t.getAll(n).forEach(i=>{r.append(n,i)});return r}const Z0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function q0(e){let{basename:t,children:r,window:n}=e,i=ee.useRef();i.current==null&&(i.current=Xm({window:n,v5Compat:!0}));let u=i.current,[C,I]=ee.useState({action:u.action,location:u.location});return ee.useLayoutEffect(()=>u.listen(I),[u]),ee.createElement(z0,{basename:t,children:r,location:C.location,navigationType:C.action,navigator:u})}const ey=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ty=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ni=ee.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:u,replace:C,state:I,target:o,to:w,preventScrollReset:A}=t,N=Y0(t,Z0),{basename:O}=ee.useContext(bi),B,F=!1;if(typeof w=="string"&&ty.test(w)&&(B=w,ey)){let y=new URL(window.location.href),s=w.startsWith("//")?new URL(y.protocol+w):new URL(w),D=wu(s.pathname,O);s.origin===y.origin&&D!=null?w=D+s.search+s.hash:F=!0}let R=O0(w,{relative:i}),b=ry(w,{replace:C,state:I,target:o,preventScrollReset:A,relative:i});function S(y){n&&n(y),y.defaultPrevented||b(y)}return ee.createElement("a",xl({},N,{href:B||R,onClick:F||u?n:S,ref:r,target:o}))});var vc;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(vc||(vc={}));var gc;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gc||(gc={}));function ry(e,t){let{target:r,replace:n,state:i,preventScrollReset:u,relative:C}=t===void 0?{}:t,I=Fi(),o=Nn(),w=iv(e,{relative:C});return ee.useCallback(A=>{if(Q0(A,r)){A.preventDefault();let N=n!==void 0?n:ja(o)===ja(w);I(e,{replace:N,state:i,preventScrollReset:u,relative:C})}},[o,I,w,n,i,r,e,u,C])}function bu(e){let t=ee.useRef(Ll(e)),r=ee.useRef(!1),n=Nn(),i=ee.useMemo(()=>J0(n.search,r.current?null:t.current),[n.search]),u=Fi(),C=ee.useCallback((I,o)=>{const w=Ll(typeof I=="function"?I(i):I);r.current=!0,u("?"+w,o)},[u,i]);return[i,C]}const Fu=()=>Ym(),Ui=Cm;function ny(e,t){const[r,n]=ee.useState(()=>{if(typeof window>"u")return t;try{const u=window.localStorage.getItem(e);return u?JSON.parse(u):t}catch{return t}});return[u=>{const C=u instanceof Function?u(r):u;n(C),typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(C))}]}function iy(){const[e,t]=ee.useState({width:0,height:0});return ee.useEffect(()=>{function r(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),e}const Pl=({type:e})=>ne(Ni,{to:"/",children:ne("img",{src:e==="big"?"./images/icons/logo.svg":"./images/icons/logo-small.svg",alt:"logo"})});var dt=(e=>(e.ARROW_LEFT="icon__arrow-left",e.ARROW_LEFT_DISABLED="icon__arrow-left--disabled",e.ARROW_RIGHT="icon__arrow-right",e.ARROW_RIGHT_DISABLED="icon__arrow-right--disabled",e.ARROW_UP="icon__arrow-up",e.ARROW_UP_DISABLED="icon__arrow-up--disabled",e.PLAY="icon__play",e.PAUSE="icon__pause",e.BLOCKED="icon__blocked",e.STAR_EMPTY="icon__star-empty",e.STAR_FILLED="icon__star-filled",e.STAR_HALF_FILLED="icon__star-half-filled",e))(dt||{}),Dl={},ay={get exports(){return Dl},set exports(e){Dl=e}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var n=[],i=0;i<arguments.length;i++){var u=arguments[i];if(u){var C=typeof u;if(C==="string"||C==="number")n.push(u);else if(Array.isArray(u)){if(u.length){var I=r.apply(null,u);I&&n.push(I)}}else if(C==="object"){if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]")){n.push(u.toString());continue}for(var o in u)t.call(u,o)&&u[o]&&n.push(o)}}}return n.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(ay);const Fs=Dl;const Ut=({type:e,addClassName:t})=>ne("span",{className:Fs("icon",e,t)});const sy=()=>{const e=Nn(),t=()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})};return Ee(Ni,{to:`${e.pathname}`,className:"footer__button-top button-top",type:"button",onClick:t,children:[ne("p",{className:"button-top__text",children:"Back to top"}),ne(Ut,{type:dt.ARROW_UP,addClassName:"button-top__icon"})]})};const oy=()=>{const{width:e}=iy();return ne("footer",{className:"footer",children:Ee("div",{className:"footer__container",children:[e>640?ne(Pl,{type:"big"}):ne(Pl,{type:"small"}),ne(Ni,{to:"https://github.com/dmytro-lebedchenko",className:"footer__link",target:"_blank",rel:"noreferrer",children:"Github"}),ne(sy,{})]})})};const ly=()=>ne("header",{className:"header",children:ne(Pl,{type:"big"})});function Nt(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Or(e){return!!e&&!!e[Le]}function sr(e){var t;return!!e&&(function(r){if(!r||typeof r!="object")return!1;var n=Object.getPrototypeOf(r);if(n===null)return!0;var i=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return i===Object||typeof i=="function"&&Function.toString.call(i)===my}(e)||Array.isArray(e)||!!e[_c]||!!(!((t=e.constructor)===null||t===void 0)&&t[_c])||Nu(e)||Uu(e))}function Qr(e,t,r){r===void 0&&(r=!1),Un(e)===0?(r?Object.keys:Ln)(e).forEach(function(n){r&&typeof n=="symbol"||t(n,e[n],e)}):e.forEach(function(n,i){return t(i,n,e)})}function Un(e){var t=e[Le];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Nu(e)?2:Uu(e)?3:0}function xn(e,t){return Un(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function uy(e,t){return Un(e)===2?e.get(t):e[t]}function av(e,t,r){var n=Un(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function sv(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function Nu(e){return gy&&e instanceof Map}function Uu(e){return py&&e instanceof Set}function Br(e){return e.o||e.t}function Bu(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=lv(e);delete t[Le];for(var r=Ln(t),n=0;n<r.length;n++){var i=r[n],u=t[i];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(t[i]={configurable:!0,writable:!0,enumerable:u.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function Ku(e,t){return t===void 0&&(t=!1),Wu(e)||Or(e)||!sr(e)||(Un(e)>1&&(e.set=e.add=e.clear=e.delete=fy),Object.freeze(e),t&&Qr(e,function(r,n){return Ku(n,!0)},!0)),e}function fy(){Nt(2)}function Wu(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function Xt(e){var t=Il[e];return t||Nt(18,e),t}function cy(e,t){Il[e]||(Il[e]=t)}function Al(){return Ai}function po(e,t){t&&(Xt("Patches"),e.u=[],e.s=[],e.v=t)}function Va(e){Rl(e),e.p.forEach(dy),e.p=null}function Rl(e){e===Ai&&(Ai=e.l)}function pc(e){return Ai={p:[],l:Ai,h:e,m:!0,_:0}}function dy(e){var t=e[Le];t.i===0||t.i===1?t.j():t.O=!0}function mo(e,t){t._=t.p.length;var r=t.p[0],n=e!==void 0&&e!==r;return t.h.g||Xt("ES5").S(t,e,n),n?(r[Le].P&&(Va(t),Nt(4)),sr(e)&&(e=za(t,e),t.l||$a(t,e)),t.u&&Xt("Patches").M(r[Le].t,e,t.u,t.s)):e=za(t,r,[]),Va(t),t.u&&t.v(t.u,t.s),e!==ov?e:void 0}function za(e,t,r){if(Wu(t))return t;var n=t[Le];if(!n)return Qr(t,function(I,o){return mc(e,n,t,I,o,r)},!0),t;if(n.A!==e)return t;if(!n.P)return $a(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=n.i===4||n.i===5?n.o=Bu(n.k):n.o,u=i,C=!1;n.i===3&&(u=new Set(i),i.clear(),C=!0),Qr(u,function(I,o){return mc(e,n,i,I,o,r,C)}),$a(e,i,!1),r&&e.u&&Xt("Patches").N(n,r,e.u,e.s)}return n.o}function mc(e,t,r,n,i,u,C){if(Or(i)){var I=za(e,i,u&&t&&t.i!==3&&!xn(t.R,n)?u.concat(n):void 0);if(av(r,n,I),!Or(I))return;e.m=!1}else C&&r.add(i);if(sr(i)&&!Wu(i)){if(!e.h.D&&e._<1)return;za(e,i),t&&t.A.l||$a(e,i)}}function $a(e,t,r){r===void 0&&(r=!1),!e.l&&e.h.D&&e.m&&Ku(t,r)}function yo(e,t){var r=e[Le];return(r?Br(r):e)[t]}function yc(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function hr(e){e.P||(e.P=!0,e.l&&hr(e.l))}function Eo(e){e.o||(e.o=Bu(e.t))}function Cl(e,t,r){var n=Nu(t)?Xt("MapSet").F(t,r):Uu(t)?Xt("MapSet").T(t,r):e.g?function(i,u){var C=Array.isArray(i),I={i:C?1:0,A:u?u.A:Al(),P:!1,I:!1,R:{},l:u,t:i,k:null,o:null,j:null,C:!1},o=I,w=Ri;C&&(o=[I],w=Jn);var A=Proxy.revocable(o,w),N=A.revoke,O=A.proxy;return I.k=O,I.j=N,O}(t,r):Xt("ES5").J(t,r);return(r?r.A:Al()).p.push(n),n}function hy(e){return Or(e)||Nt(22,e),function t(r){if(!sr(r))return r;var n,i=r[Le],u=Un(r);if(i){if(!i.P&&(i.i<4||!Xt("ES5").K(i)))return i.t;i.I=!0,n=Ec(r,u),i.I=!1}else n=Ec(r,u);return Qr(n,function(C,I){i&&uy(i.t,C)===I||av(n,C,t(I))}),u===3?new Set(n):n}(e)}function Ec(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Bu(e)}function vy(){function e(u,C){var I=i[u];return I?I.enumerable=C:i[u]=I={configurable:!0,enumerable:C,get:function(){var o=this[Le];return Ri.get(o,u)},set:function(o){var w=this[Le];Ri.set(w,u,o)}},I}function t(u){for(var C=u.length-1;C>=0;C--){var I=u[C][Le];if(!I.P)switch(I.i){case 5:n(I)&&hr(I);break;case 4:r(I)&&hr(I)}}}function r(u){for(var C=u.t,I=u.k,o=Ln(I),w=o.length-1;w>=0;w--){var A=o[w];if(A!==Le){var N=C[A];if(N===void 0&&!xn(C,A))return!0;var O=I[A],B=O&&O[Le];if(B?B.t!==N:!sv(O,N))return!0}}var F=!!C[Le];return o.length!==Ln(C).length+(F?0:1)}function n(u){var C=u.k;if(C.length!==u.t.length)return!0;var I=Object.getOwnPropertyDescriptor(C,C.length-1);if(I&&!I.get)return!0;for(var o=0;o<C.length;o++)if(!C.hasOwnProperty(o))return!0;return!1}var i={};cy("ES5",{J:function(u,C){var I=Array.isArray(u),o=function(A,N){if(A){for(var O=Array(N.length),B=0;B<N.length;B++)Object.defineProperty(O,""+B,e(B,!0));return O}var F=lv(N);delete F[Le];for(var R=Ln(F),b=0;b<R.length;b++){var S=R[b];F[S]=e(S,A||!!F[S].enumerable)}return Object.create(Object.getPrototypeOf(N),F)}(I,u),w={i:I?5:4,A:C?C.A:Al(),P:!1,I:!1,R:{},l:C,t:u,k:o,o:null,O:!1,C:!1};return Object.defineProperty(o,Le,{value:w,writable:!0}),o},S:function(u,C,I){I?Or(C)&&C[Le].A===u&&t(u.p):(u.u&&function o(w){if(w&&typeof w=="object"){var A=w[Le];if(A){var N=A.t,O=A.k,B=A.R,F=A.i;if(F===4)Qr(O,function(s){s!==Le&&(N[s]!==void 0||xn(N,s)?B[s]||o(O[s]):(B[s]=!0,hr(A)))}),Qr(N,function(s){O[s]!==void 0||xn(O,s)||(B[s]=!1,hr(A))});else if(F===5){if(n(A)&&(hr(A),B.length=!0),O.length<N.length)for(var R=O.length;R<N.length;R++)B[R]=!1;else for(var b=N.length;b<O.length;b++)B[b]=!0;for(var S=Math.min(O.length,N.length),y=0;y<S;y++)O.hasOwnProperty(y)||(B[y]=!0),B[y]===void 0&&o(O[y])}}}}(u.p[0]),t(u.p))},K:function(u){return u.i===4?r(u):n(u)}})}var Tc,Ai,Gu=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",gy=typeof Map<"u",py=typeof Set<"u",Sc=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",ov=Gu?Symbol.for("immer-nothing"):((Tc={})["immer-nothing"]=!0,Tc),_c=Gu?Symbol.for("immer-draftable"):"__$immer_draftable",Le=Gu?Symbol.for("immer-state"):"__$immer_state",my=""+Object.prototype.constructor,Ln=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,lv=Object.getOwnPropertyDescriptors||function(e){var t={};return Ln(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},Il={},Ri={get:function(e,t){if(t===Le)return e;var r=Br(e);if(!xn(r,t))return function(i,u,C){var I,o=yc(u,C);return o?"value"in o?o.value:(I=o.get)===null||I===void 0?void 0:I.call(i.k):void 0}(e,r,t);var n=r[t];return e.I||!sr(n)?n:n===yo(e.t,t)?(Eo(e),e.o[t]=Cl(e.A.h,n,e)):n},has:function(e,t){return t in Br(e)},ownKeys:function(e){return Reflect.ownKeys(Br(e))},set:function(e,t,r){var n=yc(Br(e),t);if(n!=null&&n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=yo(Br(e),t),u=i==null?void 0:i[Le];if(u&&u.t===r)return e.o[t]=r,e.R[t]=!1,!0;if(sv(r,i)&&(r!==void 0||xn(e.t,t)))return!0;Eo(e),hr(e)}return e.o[t]===r&&(r!==void 0||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return yo(e.t,t)!==void 0||t in e.t?(e.R[t]=!1,Eo(e),hr(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=Br(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty:function(){Nt(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Nt(12)}},Jn={};Qr(Ri,function(e,t){Jn[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Jn.deleteProperty=function(e,t){return Jn.set.call(this,e,t,void 0)},Jn.set=function(e,t,r){return Ri.set.call(this,e[0],t,r,e[0])};var yy=function(){function e(r){var n=this;this.g=Sc,this.D=!0,this.produce=function(i,u,C){if(typeof i=="function"&&typeof u!="function"){var I=u;u=i;var o=n;return function(R){var b=this;R===void 0&&(R=I);for(var S=arguments.length,y=Array(S>1?S-1:0),s=1;s<S;s++)y[s-1]=arguments[s];return o.produce(R,function(D){var x;return(x=u).call.apply(x,[b,D].concat(y))})}}var w;if(typeof u!="function"&&Nt(6),C!==void 0&&typeof C!="function"&&Nt(7),sr(i)){var A=pc(n),N=Cl(n,i,void 0),O=!0;try{w=u(N),O=!1}finally{O?Va(A):Rl(A)}return typeof Promise<"u"&&w instanceof Promise?w.then(function(R){return po(A,C),mo(R,A)},function(R){throw Va(A),R}):(po(A,C),mo(w,A))}if(!i||typeof i!="object"){if((w=u(i))===void 0&&(w=i),w===ov&&(w=void 0),n.D&&Ku(w,!0),C){var B=[],F=[];Xt("Patches").M(i,w,B,F),C(B,F)}return w}Nt(21,i)},this.produceWithPatches=function(i,u){if(typeof i=="function")return function(w){for(var A=arguments.length,N=Array(A>1?A-1:0),O=1;O<A;O++)N[O-1]=arguments[O];return n.produceWithPatches(w,function(B){return i.apply(void 0,[B].concat(N))})};var C,I,o=n.produce(i,u,function(w,A){C=w,I=A});return typeof Promise<"u"&&o instanceof Promise?o.then(function(w){return[w,C,I]}):[o,C,I]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var t=e.prototype;return t.createDraft=function(r){sr(r)||Nt(8),Or(r)&&(r=hy(r));var n=pc(this),i=Cl(this,r,void 0);return i[Le].C=!0,Rl(n),i},t.finishDraft=function(r,n){var i=r&&r[Le],u=i.A;return po(u,n),mo(void 0,u)},t.setAutoFreeze=function(r){this.D=r},t.setUseProxies=function(r){r&&!Sc&&Nt(20),this.g=r},t.applyPatches=function(r,n){var i;for(i=n.length-1;i>=0;i--){var u=n[i];if(u.path.length===0&&u.op==="replace"){r=u.value;break}}i>-1&&(n=n.slice(i+1));var C=Xt("Patches").$;return Or(r)?C(r,n):this.produce(r,function(I){return C(I,n)})},e}(),gt=new yy,uv=gt.produce;gt.produceWithPatches.bind(gt);gt.setAutoFreeze.bind(gt);gt.setUseProxies.bind(gt);gt.applyPatches.bind(gt);gt.createDraft.bind(gt);gt.finishDraft.bind(gt);function Ci(e){return Ci=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ci(e)}function Ey(e,t){if(Ci(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ci(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ty(e){var t=Ey(e,"string");return Ci(t)==="symbol"?t:String(t)}function Sy(e,t,r){return t=Ty(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Lc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xc(Object(r),!0).forEach(function(n){Sy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xc(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Je(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Pc=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),To=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ya={INIT:"@@redux/INIT"+To(),REPLACE:"@@redux/REPLACE"+To(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+To()}};function _y(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function fv(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Je(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Je(1));return r(fv)(e,t)}if(typeof e!="function")throw new Error(Je(2));var i=e,u=t,C=[],I=C,o=!1;function w(){I===C&&(I=C.slice())}function A(){if(o)throw new Error(Je(3));return u}function N(R){if(typeof R!="function")throw new Error(Je(4));if(o)throw new Error(Je(5));var b=!0;return w(),I.push(R),function(){if(b){if(o)throw new Error(Je(6));b=!1,w();var y=I.indexOf(R);I.splice(y,1),C=null}}}function O(R){if(!_y(R))throw new Error(Je(7));if(typeof R.type>"u")throw new Error(Je(8));if(o)throw new Error(Je(9));try{o=!0,u=i(u,R)}finally{o=!1}for(var b=C=I,S=0;S<b.length;S++){var y=b[S];y()}return R}function B(R){if(typeof R!="function")throw new Error(Je(10));i=R,O({type:Ya.REPLACE})}function F(){var R,b=N;return R={subscribe:function(y){if(typeof y!="object"||y===null)throw new Error(Je(11));function s(){y.next&&y.next(A())}s();var D=b(s);return{unsubscribe:D}}},R[Pc]=function(){return this},R}return O({type:Ya.INIT}),n={dispatch:O,subscribe:N,getState:A,replaceReducer:B},n[Pc]=F,n}function xy(e){Object.keys(e).forEach(function(t){var r=e[t],n=r(void 0,{type:Ya.INIT});if(typeof n>"u")throw new Error(Je(12));if(typeof r(void 0,{type:Ya.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Je(13))})}function Ly(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];typeof e[i]=="function"&&(r[i]=e[i])}var u=Object.keys(r),C;try{xy(r)}catch(I){C=I}return function(o,w){if(o===void 0&&(o={}),C)throw C;for(var A=!1,N={},O=0;O<u.length;O++){var B=u[O],F=r[B],R=o[B],b=F(R,w);if(typeof b>"u")throw w&&w.type,new Error(Je(14));N[B]=b,A=A||b!==R}return A=A||u.length!==Object.keys(o).length,A?N:o}}function Xa(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,i){return function(){return n(i.apply(void 0,arguments))}})}function Py(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var i=n.apply(void 0,arguments),u=function(){throw new Error(Je(15))},C={getState:i.getState,dispatch:function(){return u.apply(void 0,arguments)}},I=t.map(function(o){return o(C)});return u=Xa.apply(void 0,I)(i.dispatch),Lc(Lc({},i),{},{dispatch:u})}}}function cv(e){var t=function(n){var i=n.dispatch,u=n.getState;return function(C){return function(I){return typeof I=="function"?I(i,u,e):C(I)}}};return t}var dv=cv();dv.withExtraArgument=cv;const Dc=dv;var Dy=globalThis&&globalThis.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ay=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},n,i,u,C;return C={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function I(w){return function(A){return o([w,A])}}function o(w){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(u=w[0]&2?i.return:w[0]?i.throw||((u=i.return)&&u.call(i),0):i.next)&&!(u=u.call(i,w[1])).done)return u;switch(i=0,u&&(w=[w[0]&2,u.value]),w[0]){case 0:case 1:u=w;break;case 4:return r.label++,{value:w[1],done:!1};case 5:r.label++,i=w[1],w=[0];continue;case 7:w=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(w[0]===6||w[0]===2)){r=0;continue}if(w[0]===3&&(!u||w[1]>u[0]&&w[1]<u[3])){r.label=w[1];break}if(w[0]===6&&r.label<u[1]){r.label=u[1],u=w;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(w);break}u[2]&&r.ops.pop(),r.trys.pop();continue}w=t.call(e,r)}catch(A){w=[6,A],i=0}finally{n=u=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Qa=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},Ry=Object.defineProperty,Cy=Object.defineProperties,Iy=Object.getOwnPropertyDescriptors,Ac=Object.getOwnPropertySymbols,Oy=Object.prototype.hasOwnProperty,My=Object.prototype.propertyIsEnumerable,Rc=function(e,t,r){return t in e?Ry(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Dr=function(e,t){for(var r in t||(t={}))Oy.call(t,r)&&Rc(e,r,t[r]);if(Ac)for(var n=0,i=Ac(t);n<i.length;n++){var r=i[n];My.call(t,r)&&Rc(e,r,t[r])}return e},So=function(e,t){return Cy(e,Iy(t))},wy=function(e,t,r){return new Promise(function(n,i){var u=function(o){try{I(r.next(o))}catch(w){i(w)}},C=function(o){try{I(r.throw(o))}catch(w){i(w)}},I=function(o){return o.done?n(o.value):Promise.resolve(o.value).then(u,C)};I((r=r.apply(e,t)).next())})},ky=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Xa:Xa.apply(null,arguments)};function by(e){if(typeof e!="object"||e===null)return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var r=t;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return t===r}var Fy=function(e){Dy(t,e);function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.apply(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}return Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.prototype.concat.apply(this,r)},t.prototype.prepend=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return r.length===1&&Array.isArray(r[0])?new(t.bind.apply(t,Qa([void 0],r[0].concat(this)))):new(t.bind.apply(t,Qa([void 0],r.concat(this))))},t}(Array);function Ol(e){return sr(e)?uv(e,function(){}):e}function Ny(e){return typeof e=="boolean"}function Uy(){return function(t){return By(t)}}function By(e){e===void 0&&(e={});var t=e.thunk,r=t===void 0?!0:t;e.immutableCheck,e.serializableCheck;var n=new Fy;return r&&(Ny(r)?n.push(Dc):n.push(Dc.withExtraArgument(r.extraArgument))),n}var Ky=!0;function Wy(e){var t=Uy(),r=e||{},n=r.reducer,i=n===void 0?void 0:n,u=r.middleware,C=u===void 0?t():u,I=r.devTools,o=I===void 0?!0:I,w=r.preloadedState,A=w===void 0?void 0:w,N=r.enhancers,O=N===void 0?void 0:N,B;if(typeof i=="function")B=i;else if(by(i))B=Ly(i);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var F=C;typeof F=="function"&&(F=F(t));var R=Py.apply(void 0,F),b=Xa;o&&(b=ky(Dr({trace:!Ky},typeof o=="object"&&o)));var S=[R];Array.isArray(O)?S=Qa([R],O):typeof O=="function"&&(S=O(S));var y=b.apply(void 0,S);return fv(B,A,y)}function Ar(e,t){function r(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(t){var u=t.apply(void 0,n);if(!u)throw new Error("prepareAction did not return an object");return Dr(Dr({type:e,payload:u.payload},"meta"in u&&{meta:u.meta}),"error"in u&&{error:u.error})}return{type:e,payload:n[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(n){return n.type===e},r}function hv(e){var t={},r=[],n,i={addCase:function(u,C){var I=typeof u=="string"?u:u.type;if(I in t)throw new Error("addCase cannot be called with two reducers for the same action type");return t[I]=C,i},addMatcher:function(u,C){return r.push({matcher:u,reducer:C}),i},addDefaultCase:function(u){return n=u,i}};return e(i),[t,r,n]}function Gy(e){return typeof e=="function"}function jy(e,t,r,n){r===void 0&&(r=[]);var i=typeof t=="function"?hv(t):[t,r,n],u=i[0],C=i[1],I=i[2],o;if(Gy(e))o=function(){return Ol(e())};else{var w=Ol(e);o=function(){return w}}function A(N,O){N===void 0&&(N=o());var B=Qa([u[O.type]],C.filter(function(F){var R=F.matcher;return R(O)}).map(function(F){var R=F.reducer;return R}));return B.filter(function(F){return!!F}).length===0&&(B=[I]),B.reduce(function(F,R){if(R)if(Or(F)){var b=F,S=R(b,O);return S===void 0?F:S}else{if(sr(F))return uv(F,function(y){return R(y,O)});var S=R(F,O);if(S===void 0){if(F===null)return F;throw Error("A case reducer on a non-draftable value must not return undefined")}return S}return F},N)}return A.getInitialState=o,A}function Hy(e,t){return e+"/"+t}function vv(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");typeof process<"u";var r=typeof e.initialState=="function"?e.initialState:Ol(e.initialState),n=e.reducers||{},i=Object.keys(n),u={},C={},I={};i.forEach(function(A){var N=n[A],O=Hy(t,A),B,F;"reducer"in N?(B=N.reducer,F=N.prepare):B=N,u[A]=B,C[O]=B,I[A]=F?Ar(O,F):Ar(O)});function o(){var A=typeof e.extraReducers=="function"?hv(e.extraReducers):[e.extraReducers],N=A[0],O=N===void 0?{}:N,B=A[1],F=B===void 0?[]:B,R=A[2],b=R===void 0?void 0:R,S=Dr(Dr({},O),C);return jy(r,function(y){for(var s in S)y.addCase(s,S[s]);for(var D=0,x=F;D<x.length;D++){var f=x[D];y.addMatcher(f.matcher,f.reducer)}b&&y.addDefaultCase(b)})}var w;return{name:t,reducer:function(A,N){return w||(w=o()),w(A,N)},actions:I,caseReducers:u,getInitialState:function(){return w||(w=o()),w.getInitialState()}}}var Vy="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",zy=function(e){e===void 0&&(e=21);for(var t="",r=e;r--;)t+=Vy[Math.random()*64|0];return t},$y=["name","message","stack","code"],_o=function(){function e(t,r){this.payload=t,this.meta=r}return e}(),Cc=function(){function e(t,r){this.payload=t,this.meta=r}return e}(),Yy=function(e){if(typeof e=="object"&&e!==null){for(var t={},r=0,n=$y;r<n.length;r++){var i=n[r];typeof e[i]=="string"&&(t[i]=e[i])}return t}return{message:String(e)}},gv=function(){function e(t,r,n){var i=Ar(t+"/fulfilled",function(w,A,N,O){return{payload:w,meta:So(Dr({},O||{}),{arg:N,requestId:A,requestStatus:"fulfilled"})}}),u=Ar(t+"/pending",function(w,A,N){return{payload:void 0,meta:So(Dr({},N||{}),{arg:A,requestId:w,requestStatus:"pending"})}}),C=Ar(t+"/rejected",function(w,A,N,O,B){return{payload:O,error:(n&&n.serializeError||Yy)(w||"Rejected"),meta:So(Dr({},B||{}),{arg:N,requestId:A,rejectedWithValue:!!O,requestStatus:"rejected",aborted:(w==null?void 0:w.name)==="AbortError",condition:(w==null?void 0:w.name)==="ConditionError"})}}),I=typeof AbortController<"u"?AbortController:function(){function w(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return w.prototype.abort=function(){},w}();function o(w){return function(A,N,O){var B=n!=null&&n.idGenerator?n.idGenerator(w):zy(),F=new I,R;function b(y){R=y,F.abort()}var S=function(){return wy(this,null,function(){var y,s,D,x,f,d,c;return Ay(this,function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),x=(y=n==null?void 0:n.condition)==null?void 0:y.call(n,w,{getState:N,extra:O}),Qy(x)?[4,x]:[3,2];case 1:x=h.sent(),h.label=2;case 2:if(x===!1||F.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return f=new Promise(function(_,L){return F.signal.addEventListener("abort",function(){return L({name:"AbortError",message:R||"Aborted"})})}),A(u(B,w,(s=n==null?void 0:n.getPendingMeta)==null?void 0:s.call(n,{requestId:B,arg:w},{getState:N,extra:O}))),[4,Promise.race([f,Promise.resolve(r(w,{dispatch:A,getState:N,extra:O,requestId:B,signal:F.signal,abort:b,rejectWithValue:function(_,L){return new _o(_,L)},fulfillWithValue:function(_,L){return new Cc(_,L)}})).then(function(_){if(_ instanceof _o)throw _;return _ instanceof Cc?i(_.payload,B,w,_.meta):i(_,B,w)})])];case 3:return D=h.sent(),[3,5];case 4:return d=h.sent(),D=d instanceof _o?C(null,B,w,d.payload,d.meta):C(d,B,w),[3,5];case 5:return c=n&&!n.dispatchConditionRejection&&C.match(D)&&D.meta.condition,c||A(D),[2,D]}})})}();return Object.assign(S,{abort:b,requestId:B,arg:w,unwrap:function(){return S.then(Xy)}})}}return Object.assign(o,{pending:u,rejected:C,fulfilled:i,typePrefix:t})}return e.withTypes=function(){return e},e}();function Xy(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function Qy(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var ju="listenerMiddleware";Ar(ju+"/add");Ar(ju+"/removeAll");Ar(ju+"/remove");var Ic;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);vy();const Jy="https://api.wisey.app/api/v1/core/preview-courses",Zy="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkOTRlNjg4NS1kM2U5LTQwY2EtYTVjYy01MDRkNjZlZDVlN2QiLCJwbGF0Zm9ybSI6InN1YnNjcmlwdGlvbnMiLCJpYXQiOjE2Nzg3MDQ3NjIsImV4cCI6MTY3OTYwNDc2Mn0.Qw3LF39CDp27ZxoGzt5rikJM_OTx0eNaoyFFLxxrXUM";async function qy(e,t="GET",r=null){const n={method:t,headers:{Authorization:Zy}};r&&(n.body=JSON.stringify(r),n.headers={"Content-Type":"application/json;"});const i=await fetch(`${Jy}${e}`,{...n});if(!i.ok)throw new Error;return i.json()}const pv={get:e=>qy(e)},eE=async()=>{const{courses:e}=await pv.get("");return e},tE=e=>pv.get(`/${e}`),rE={courses:[],loaded:!1,hasError:!1},pa=gv("courses/fetch",()=>eE()),nE=vv({name:"courses",initialState:rE,reducers:{setCourses:(e,t)=>({...e,courses:t.payload})},extraReducers:e=>{e.addCase(pa.pending,t=>({...t,loaded:!1,hasError:!1})),e.addCase(pa.fulfilled,(t,r)=>({...t,courses:r.payload,loaded:!0,hasError:!1})),e.addCase(pa.rejected,t=>({...t,loaded:!0,hasError:!0}))}}),iE=nE.reducer;const aE=()=>{const e=Fu();return ee.useEffect(()=>{e(pa())},[e]),Ee("div",{className:"App",children:[ne(ly,{}),ne("main",{children:ne("div",{className:"container",children:ne(V0,{})})}),ne(oy,{})]})},sE={selectedCourse:null,loaded:!1,hasError:!1},oi=gv("selectedCourse/fetch",async e=>e?tE(e):null),oE=vv({name:"selectedCourse",initialState:sE,reducers:{setSelectedCourse:(e,t)=>({...e,selectedCourse:t.payload})},extraReducers:e=>{e.addCase(oi.pending,t=>({...t,loaded:!1,hasError:!1})),e.addCase(oi.fulfilled,(t,r)=>({...t,selectedCourse:r.payload??null,loaded:!0,hasError:!1})),e.addCase(oi.rejected,t=>({...t,loaded:!0,hasError:!0}))}}),lE=oE.reducer,uE=Wy({reducer:{courses:iE,selectedCourse:lE}});const fE=()=>Ee(Ni,{to:"/",className:"back-button",type:"button","data-cy":"backButton",children:[ne(Ut,{type:dt.ARROW_LEFT,addClassName:"back-button__arrow"}),"Back"]});var Ml={},cE={get exports(){return Ml},set exports(e){Ml=e}};(function(e,t){typeof window<"u"&&function(n,i){e.exports=i()}(Cv,()=>(()=>{var r={"./src/config.ts":(C,I,o)=>{o.r(I),o.d(I,{enableStreamingMode:()=>p,hlsDefaultConfig:()=>g,mergeConfig:()=>l});var w=o("./src/controller/abr-controller.ts"),A=o("./src/controller/audio-stream-controller.ts"),N=o("./src/controller/audio-track-controller.ts"),O=o("./src/controller/subtitle-stream-controller.ts"),B=o("./src/controller/subtitle-track-controller.ts"),F=o("./src/controller/buffer-controller.ts"),R=o("./src/controller/timeline-controller.ts"),b=o("./src/controller/cap-level-controller.ts"),S=o("./src/controller/fps-controller.ts"),y=o("./src/controller/eme-controller.ts"),s=o("./src/controller/cmcd-controller.ts"),D=o("./src/utils/xhr-loader.ts"),x=o("./src/utils/fetch-loader.ts"),f=o("./src/utils/cues.ts"),d=o("./src/utils/mediakeys-helper.ts"),c=o("./src/utils/logger.ts");function h(){return h=Object.assign?Object.assign.bind():function(a){for(var E=1;E<arguments.length;E++){var k=arguments[E];for(var P in k)Object.prototype.hasOwnProperty.call(k,P)&&(a[P]=k[P])}return a},h.apply(this,arguments)}function _(a,E){var k=Object.keys(a);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(a);E&&(P=P.filter(function(U){return Object.getOwnPropertyDescriptor(a,U).enumerable})),k.push.apply(k,P)}return k}function L(a){for(var E=1;E<arguments.length;E++){var k=arguments[E]!=null?arguments[E]:{};E%2?_(Object(k),!0).forEach(function(P){v(a,P,k[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(k)):_(Object(k)).forEach(function(P){Object.defineProperty(a,P,Object.getOwnPropertyDescriptor(k,P))})}return a}function v(a,E,k){return E=T(E),E in a?Object.defineProperty(a,E,{value:k,enumerable:!0,configurable:!0,writable:!0}):a[E]=k,a}function T(a){var E=M(a,"string");return typeof E=="symbol"?E:String(E)}function M(a,E){if(typeof a!="object"||a===null)return a;var k=a[Symbol.toPrimitive];if(k!==void 0){var P=k.call(a,E||"default");if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(a)}var g=L(L({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:D.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:w.default,bufferController:F.default,capLevelController:b.default,fpsController:S.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:d.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},m()),{},{subtitleStreamController:O.SubtitleStreamController,subtitleTrackController:B.default,timelineController:R.TimelineController,audioStreamController:A.default,audioTrackController:N.default,emeController:y.default,cmcdController:s.default});function m(){return{cueHandler:f.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function l(a,E){if((E.liveSyncDurationCount||E.liveMaxLatencyDurationCount)&&(E.liveSyncDuration||E.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(E.liveMaxLatencyDurationCount!==void 0&&(E.liveSyncDurationCount===void 0||E.liveMaxLatencyDurationCount<=E.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(E.liveMaxLatencyDuration!==void 0&&(E.liveSyncDuration===void 0||E.liveMaxLatencyDuration<=E.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return h({},a,E)}function p(a){var E=a.loader;if(E!==x.default&&E!==D.default)c.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),a.progressive=!1;else{var k=(0,x.fetchSupported)();k&&(a.loader=x.default,a.progressive=!0,a.enableSoftwareAES=!0,c.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>D});var w=o("./src/polyfills/number.ts"),A=o("./src/utils/ewma-bandwidth-estimator.ts"),N=o("./src/events.ts"),O=o("./src/errors.ts"),B=o("./src/types/loader.ts"),F=o("./src/utils/logger.ts");function R(x,f){for(var d=0;d<f.length;d++){var c=f[d];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(x,S(c.key),c)}}function b(x,f,d){return f&&R(x.prototype,f),d&&R(x,d),Object.defineProperty(x,"prototype",{writable:!1}),x}function S(x){var f=y(x,"string");return typeof f=="symbol"?f:String(f)}function y(x,f){if(typeof x!="object"||x===null)return x;var d=x[Symbol.toPrimitive];if(d!==void 0){var c=d.call(x,f||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(x)}var s=function(){function x(d){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=d;var c=d.config;this.bwEstimator=new A.default(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var f=x.prototype;return f.registerListeners=function(){var c=this.hls;c.on(N.Events.FRAG_LOADING,this.onFragLoading,this),c.on(N.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.on(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(N.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var c=this.hls;c.off(N.Events.FRAG_LOADING,this.onFragLoading,this),c.off(N.Events.FRAG_LOADED,this.onFragLoaded,this),c.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.off(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(N.Events.ERROR,this.onError,this)},f.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},f.onFragLoading=function(c,h){var _=h.frag;if(_.type===B.PlaylistLevelType.MAIN&&!this.timer){var L;this.fragCurrent=_,this.partCurrent=(L=h.part)!=null?L:null,this.timer=self.setInterval(this.onCheck,100)}},f.onLevelLoaded=function(c,h){var _=this.hls.config;h.details.live?this.bwEstimator.update(_.abrEwmaSlowLive,_.abrEwmaFastLive):this.bwEstimator.update(_.abrEwmaSlowVoD,_.abrEwmaFastVoD)},f._abandonRulesCheck=function(){var c=this.fragCurrent,h=this.partCurrent,_=this.hls,L=_.autoLevelEnabled,v=_.media;if(!(!c||!v)){var T=h?h.stats:c.stats,M=h?h.duration:c.duration;if(T.aborted||T.loaded&&T.loaded===T.total||c.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!L||v.paused||!v.playbackRate||!v.readyState)){var g=_.mainForwardBufferInfo;if(g!==null){var m=performance.now()-T.loading.start,l=Math.abs(v.playbackRate);if(!(m<=500*M/l)){var p=T.loaded&&T.loading.first,a=this.bwEstimator.getEstimate(),E=_.levels,k=_.minAutoLevel,P=E[c.level],U=T.total||Math.max(T.loaded,Math.round(M*P.maxBitrate/8)),K=p?T.loaded*1e3/m:0,W=K?(U-T.loaded)/K:U*8/a,G=g.len/l;if(!(W<=G)){var j=Number.POSITIVE_INFINITY,H;for(H=c.level-1;H>k;H--){var V=E[H].maxBitrate;if(j=K?M*V/(8*.8*K):M*V/a,j<G)break}j>=W||(F.logger.warn("Fragment "+c.sn+(h?" part "+h.index:"")+" of level "+c.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+H+`
      Current BW estimate: `+((0,w.isFiniteNumber)(a)?(a/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+W.toFixed(3)+` s
      Estimated load time for the next fragment: `+j.toFixed(3)+` s
      Time to underbuffer: `+G.toFixed(3)+" s"),_.nextLoadLevel=H,p&&this.bwEstimator.sample(m,T.loaded),this.clearTimer(),(c.loader||c.keyLoader)&&(this.fragCurrent=this.partCurrent=null,c.abortRequests()),_.trigger(N.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,part:h,stats:T}))}}}}}},f.onFragLoaded=function(c,h){var _=h.frag,L=h.part;if(_.type===B.PlaylistLevelType.MAIN&&(0,w.isFiniteNumber)(_.sn)){var v=L?L.stats:_.stats,T=L?L.duration:_.duration;if(this.clearTimer(),this.lastLoadedFragLevel=_.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var M=this.hls.levels[_.level],g=(M.loaded?M.loaded.bytes:0)+v.loaded,m=(M.loaded?M.loaded.duration:0)+T;M.loaded={bytes:g,duration:m},M.realBitrate=Math.round(8*g/m)}if(_.bitrateTest){var l={stats:v,frag:_,part:L,id:_.type};this.onFragBuffered(N.Events.FRAG_BUFFERED,l)}}},f.onFragBuffered=function(c,h){var _=h.frag,L=h.part,v=L?L.stats:_.stats;if(!v.aborted&&!(_.type!==B.PlaylistLevelType.MAIN||_.sn==="initSegment")){var T=v.parsing.end-v.loading.start;this.bwEstimator.sample(T,v.loaded),v.bwEstimate=this.bwEstimator.getEstimate(),_.bitrateTest?this.bitrateTestDelay=T/1e3:this.bitrateTestDelay=0}},f.onError=function(c,h){var _;if(((_=h.frag)===null||_===void 0?void 0:_.type)===B.PlaylistLevelType.MAIN){if(h.type===O.ErrorTypes.KEY_SYSTEM_ERROR){this.clearTimer();return}switch(h.details){case O.ErrorDetails.FRAG_LOAD_ERROR:case O.ErrorDetails.FRAG_LOAD_TIMEOUT:case O.ErrorDetails.KEY_LOAD_ERROR:case O.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer();break}}},f.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},f.getNextABRAutoLevel=function(){var c=this.fragCurrent,h=this.partCurrent,_=this.hls,L=_.maxAutoLevel,v=_.config,T=_.minAutoLevel,M=_.media,g=h?h.duration:c?c.duration:0,m=M&&M.playbackRate!==0?Math.abs(M.playbackRate):1,l=this.bwEstimator?this.bwEstimator.getEstimate():v.abrEwmaDefaultEstimate,p=_.mainForwardBufferInfo,a=(p?p.len:0)/m,E=this.findBestLevel(l,T,L,a,v.abrBandWidthFactor,v.abrBandWidthUpFactor);if(E>=0)return E;F.logger.trace((a?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var k=g?Math.min(g,v.maxStarvationDelay):v.maxStarvationDelay,P=v.abrBandWidthFactor,U=v.abrBandWidthUpFactor;if(!a){var K=this.bitrateTestDelay;if(K){var W=g?Math.min(g,v.maxLoadingDelay):v.maxLoadingDelay;k=W-K,F.logger.trace("bitrate test took "+Math.round(1e3*K)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*k)+" ms"),P=U=1}}return E=this.findBestLevel(l,T,L,a+k,P,U),Math.max(E,0)},f.findBestLevel=function(c,h,_,L,v,T){for(var M,g=this.fragCurrent,m=this.partCurrent,l=this.lastLoadedFragLevel,p=this.hls.levels,a=p[l],E=!!(a!=null&&(M=a.details)!==null&&M!==void 0&&M.live),k=a==null?void 0:a.codecSet,P=m?m.duration:g?g.duration:0,U=_;U>=h;U--){var K=p[U];if(!(!K||k&&K.codecSet!==k)){var W=K.details,G=(m?W==null?void 0:W.partTarget:W==null?void 0:W.averagetargetduration)||P,j=void 0;U<=l?j=v*c:j=T*c;var H=p[U].maxBitrate,V=H*G/j;if(F.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+U+"/"+Math.round(j)+"/"+H+"/"+G+"/"+L+"/"+V),j>H&&(V===0||!(0,w.isFiniteNumber)(V)||E&&!this.bitrateTestDelay||V<L))return U}}return-1},b(x,[{key:"nextAutoLevel",get:function(){var c=this._nextAutoLevel,h=this.bwEstimator;if(c!==-1&&!h.canEstimate())return c;var _=this.getNextABRAutoLevel();return c!==-1&&this.hls.levels[_].loadError?c:(c!==-1&&(_=Math.min(c,_)),_)},set:function(c){this._nextAutoLevel=c}}]),x}();const D=s},"./src/controller/audio-stream-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>v});var w=o("./src/polyfills/number.ts"),A=o("./src/controller/base-stream-controller.ts"),N=o("./src/events.ts"),O=o("./src/utils/buffer-helper.ts"),B=o("./src/controller/fragment-tracker.ts"),F=o("./src/types/level.ts"),R=o("./src/types/loader.ts"),b=o("./src/loader/fragment.ts"),S=o("./src/demux/chunk-cache.ts"),y=o("./src/demux/transmuxer-interface.ts"),s=o("./src/types/transmuxer.ts"),D=o("./src/controller/fragment-finders.ts"),x=o("./src/utils/discontinuities.ts"),f=o("./src/errors.ts");function d(){return d=Object.assign?Object.assign.bind():function(T){for(var M=1;M<arguments.length;M++){var g=arguments[M];for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(T[m]=g[m])}return T},d.apply(this,arguments)}function c(T,M){T.prototype=Object.create(M.prototype),T.prototype.constructor=T,h(T,M)}function h(T,M){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(m,l){return m.__proto__=l,m},h(T,M)}var _=100,L=function(T){c(M,T);function M(m,l,p){var a;return a=T.call(this,m,l,p,"[audio-stream-controller]")||this,a.videoBuffer=null,a.videoTrackCC=-1,a.waitingVideoCC=-1,a.audioSwitch=!1,a.trackId=-1,a.waitingData=null,a.mainDetails=null,a.bufferFlushed=!1,a.cachedTrackLoadedData=null,a._registerListeners(),a}var g=M.prototype;return g.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},g._registerListeners=function(){var l=this.hls;l.on(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(N.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),l.on(N.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),l.on(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),l.on(N.Events.ERROR,this.onError,this),l.on(N.Events.BUFFER_RESET,this.onBufferReset,this),l.on(N.Events.BUFFER_CREATED,this.onBufferCreated,this),l.on(N.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),l.on(N.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.on(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},g._unregisterListeners=function(){var l=this.hls;l.off(N.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(N.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(N.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(N.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(N.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),l.off(N.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),l.off(N.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),l.off(N.Events.ERROR,this.onError,this),l.off(N.Events.BUFFER_RESET,this.onBufferReset,this),l.off(N.Events.BUFFER_CREATED,this.onBufferCreated,this),l.off(N.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),l.off(N.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.off(N.Events.FRAG_BUFFERED,this.onFragBuffered,this)},g.onInitPtsFound=function(l,p){var a=p.frag,E=p.id,k=p.initPTS;if(E==="main"){var P=a.cc;this.initPTS[a.cc]=k,this.log("InitPTS for cc: "+P+" found from main: "+k),this.videoTrackCC=P,this.state===A.State.WAITING_INIT_PTS&&this.tick()}},g.startLoad=function(l){if(!this.levels){this.startPosition=l,this.state=A.State.STOPPED;return}var p=this.lastCurrentTime;this.stopLoad(),this.setInterval(_),this.fragLoadError=0,p>0&&l===-1?(this.log("Override startPosition with lastCurrentTime @"+p.toFixed(3)),l=p,this.state=A.State.IDLE):(this.loadedmetadata=!1,this.state=A.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=l,this.tick()},g.doTick=function(){switch(this.state){case A.State.IDLE:this.doTickIdle();break;case A.State.WAITING_TRACK:{var l,p=this.levels,a=this.trackId,E=p==null||(l=p[a])===null||l===void 0?void 0:l.details;if(E){if(this.waitForCdnTuneIn(E))break;this.state=A.State.WAITING_INIT_PTS}break}case A.State.FRAG_LOADING_WAITING_RETRY:{var k,P=performance.now(),U=this.retryDate;(!U||P>=U||(k=this.media)!==null&&k!==void 0&&k.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=A.State.IDLE);break}case A.State.WAITING_INIT_PTS:{var K=this.waitingData;if(K){var W=K.frag,G=K.part,j=K.cache,H=K.complete;if(this.initPTS[W.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=A.State.FRAG_LOADING;var V=j.flush(),z={frag:W,part:G,payload:V,networkDetails:null};this._handleFragmentLoadProgress(z),H&&T.prototype._handleFragmentLoadComplete.call(this,z)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+W.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var $=this.getLoadPosition(),Y=O.BufferHelper.bufferInfo(this.mediaBuffer,$,this.config.maxBufferHole),X=(0,D.fragmentWithinToleranceTest)(Y.end,this.config.maxFragLookUpTolerance,W);X<0&&(this.log("Waiting fragment cc ("+W.cc+") @ "+W.start+" cancelled because another fragment at "+Y.end+" is needed"),this.clearWaitingFragment())}}else this.state=A.State.IDLE}}this.onTickEnd()},g.clearWaitingFragment=function(){var l=this.waitingData;l&&(this.fragmentTracker.removeFragment(l.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=A.State.IDLE)},g.resetLoadingState=function(){this.clearWaitingFragment(),T.prototype.resetLoadingState.call(this)},g.onTickEnd=function(){var l=this.media;!l||!l.readyState||(this.lastCurrentTime=l.currentTime)},g.doTickIdle=function(){var l=this.hls,p=this.levels,a=this.media,E=this.trackId,k=l.config;if(!(!p||!p[E])&&!(!a&&(this.startFragRequested||!k.startFragPrefetch))){var P=p[E],U=P.details;if(!U||U.live&&this.levelLastLoaded!==E||this.waitForCdnTuneIn(U)){this.state=A.State.WAITING_TRACK;return}var K=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&K&&(this.bufferFlushed=!1,this.afterBufferFlushed(K,b.ElementaryStreamTypes.AUDIO,R.PlaylistLevelType.AUDIO));var W=this.getFwdBufferInfo(K,R.PlaylistLevelType.AUDIO);if(W!==null){var G=this.audioSwitch;if(!G&&this._streamEnded(W,U)){l.trigger(N.Events.BUFFER_EOS,{type:"audio"}),this.state=A.State.ENDED;return}var j=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,R.PlaylistLevelType.MAIN),H=W.len,V=this.getMaxBufferLength(j==null?void 0:j.len);if(!(H>=V&&!G)){var z=U.fragments,$=z[0].start,Y=W.end;if(G&&a){var X=this.getLoadPosition();Y=X,U.PTSKnown&&X<$&&(W.end>$||W.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=$+.05)}if(!(j&&Y>j.end+U.targetduration)&&!((!j||!j.len)&&W.len)){var Z=this.getNextFragment(Y,U);if(!Z){this.bufferFlushed=!0;return}this.loadFragment(Z,U,Y)}}}}},g.getMaxBufferLength=function(l){var p=T.prototype.getMaxBufferLength.call(this);return l?Math.max(p,l):p},g.onMediaDetaching=function(){this.videoBuffer=null,T.prototype.onMediaDetaching.call(this)},g.onAudioTracksUpdated=function(l,p){var a=p.audioTracks;this.resetTransmuxer(),this.levels=a.map(function(E){return new F.Level(E)})},g.onAudioTrackSwitching=function(l,p){var a=!!p.url;this.trackId=p.id;var E=this.fragCurrent;E&&E.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),a?this.setInterval(_):this.resetTransmuxer(),a?(this.audioSwitch=!0,this.state=A.State.IDLE):this.state=A.State.STOPPED,this.tick()},g.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},g.onLevelLoaded=function(l,p){this.mainDetails=p.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(N.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},g.onAudioTrackLoaded=function(l,p){var a;if(this.mainDetails==null){this.cachedTrackLoadedData=p;return}var E=this.levels,k=p.details,P=p.id;if(!E){this.warn("Audio tracks were reset while loading level "+P);return}this.log("Track "+P+" loaded ["+k.startSN+","+k.endSN+"],duration:"+k.totalduration);var U=E[P],K=0;if(k.live||(a=U.details)!==null&&a!==void 0&&a.live){var W=this.mainDetails;if(k.fragments[0]||(k.deltaUpdateFailed=!0),k.deltaUpdateFailed||!W)return;!U.details&&k.hasProgramDateTime&&W.hasProgramDateTime?((0,x.alignMediaPlaylistByPDT)(k,W),K=k.fragments[0].start):K=this.alignPlaylists(k,U.details)}U.details=k,this.levelLastLoaded=P,!this.startFragRequested&&(this.mainDetails||!k.live)&&this.setStartPosition(U.details,K),this.state===A.State.WAITING_TRACK&&!this.waitForCdnTuneIn(k)&&(this.state=A.State.IDLE),this.tick()},g._handleFragmentLoadProgress=function(l){var p,a=l.frag,E=l.part,k=l.payload,P=this.config,U=this.trackId,K=this.levels;if(!K){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+a.sn+" of level "+a.level+" will not be buffered");return}var W=K[U];console.assert(W,"Audio track is defined on fragment load progress");var G=W.details;console.assert(G,"Audio track details are defined on fragment load progress");var j=P.defaultAudioCodec||W.audioCodec||"mp4a.40.2",H=this.transmuxer;H||(H=this.transmuxer=new y.default(this.hls,R.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var V=this.initPTS[a.cc],z=(p=a.initSegment)===null||p===void 0?void 0:p.data;if(V!==void 0){var $=!1,Y=E?E.index:-1,X=Y!==-1,Z=new s.ChunkMetadata(a.level,a.sn,a.stats.chunkCount,k.byteLength,Y,X);H.push(k,z,j,"",a,E,G.totalduration,$,Z,V)}else{this.log("Unknown video PTS for cc "+a.cc+", waiting for video PTS before demuxing audio frag "+a.sn+" of ["+G.startSN+" ,"+G.endSN+"],track "+U);var Q=this.waitingData=this.waitingData||{frag:a,part:E,cache:new S.default,complete:!1},J=Q.cache;J.push(new Uint8Array(k)),this.waitingVideoCC=this.videoTrackCC,this.state=A.State.WAITING_INIT_PTS}},g._handleFragmentLoadComplete=function(l){if(this.waitingData){this.waitingData.complete=!0;return}T.prototype._handleFragmentLoadComplete.call(this,l)},g.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},g.onBufferCreated=function(l,p){var a=p.tracks.audio;a&&(this.mediaBuffer=a.buffer||null),p.tracks.video&&(this.videoBuffer=p.tracks.video.buffer||null)},g.onFragBuffered=function(l,p){var a=p.frag,E=p.part;if(a.type!==R.PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&a.type===R.PlaylistLevelType.MAIN){var k;(k=this.videoBuffer||this.media)!==null&&k!==void 0&&k.buffered.length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(a)){this.warn("Fragment "+a.sn+(E?" p: "+E.index:"")+" of level "+a.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}a.sn!=="initSegment"&&(this.fragPrevious=a,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(N.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(a,E)},g.onError=function(l,p){if(p.type===f.ErrorTypes.KEY_SYSTEM_ERROR){this.onFragmentOrKeyLoadError(R.PlaylistLevelType.AUDIO,p);return}switch(p.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:case f.ErrorDetails.FRAG_PARSING_ERROR:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(R.PlaylistLevelType.AUDIO,p);break;case f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case f.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==A.State.ERROR&&this.state!==A.State.STOPPED&&(this.state=p.fatal?A.State.ERROR:A.State.IDLE,this.warn(p.details+" while loading frag, switching to "+this.state+" state"));break;case f.ErrorDetails.BUFFER_FULL_ERROR:if(p.parent==="audio"&&(this.state===A.State.PARSING||this.state===A.State.PARSED)){var a=!0,E=this.getFwdBufferInfo(this.mediaBuffer,R.PlaylistLevelType.AUDIO);E&&E.len>.5&&(a=!this.reduceMaxBufferLength(E.len)),a&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,T.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},g.onBufferFlushed=function(l,p){var a=p.type;a===b.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===A.State.ENDED&&(this.state=A.State.IDLE))},g._handleTransmuxComplete=function(l){var p,a="audio",E=this.hls,k=l.remuxResult,P=l.chunkMeta,U=this.getCurrentContext(P);if(!U){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(P.level);return}var K=U.frag,W=U.part,G=U.level.details,j=k.audio,H=k.text,V=k.id3,z=k.initSegment;if(!(this.fragContextChanged(K)||!G)){if(this.state=A.State.PARSING,this.audioSwitch&&j&&this.completeAudioSwitch(),z!=null&&z.tracks&&(this._bufferInitSegment(z.tracks,K,P),E.trigger(N.Events.FRAG_PARSING_INIT_SEGMENT,{frag:K,id:a,tracks:z.tracks})),j){var $=j.startPTS,Y=j.endPTS,X=j.startDTS,Z=j.endDTS;W&&(W.elementaryStreams[b.ElementaryStreamTypes.AUDIO]={startPTS:$,endPTS:Y,startDTS:X,endDTS:Z}),K.setElementaryStreamInfo(b.ElementaryStreamTypes.AUDIO,$,Y,X,Z),this.bufferFragmentData(j,K,W,P)}if(V!=null&&(p=V.samples)!==null&&p!==void 0&&p.length){var Q=d({id:a,frag:K,details:G},V);E.trigger(N.Events.FRAG_PARSING_METADATA,Q)}if(H){var J=d({id:a,frag:K,details:G},H);E.trigger(N.Events.FRAG_PARSING_USERDATA,J)}}},g._bufferInitSegment=function(l,p,a){if(this.state===A.State.PARSING){l.video&&delete l.video;var E=l.audio;if(E){E.levelCodec=E.codec,E.id="audio",this.log("Init audio buffer, container:"+E.container+", codecs[parsed]=["+E.codec+"]"),this.hls.trigger(N.Events.BUFFER_CODECS,l);var k=E.initSegment;if(k!=null&&k.byteLength){var P={type:"audio",frag:p,part:null,chunkMeta:a,parent:p.type,data:k};this.hls.trigger(N.Events.BUFFER_APPENDING,P)}this.tick()}}},g.loadFragment=function(l,p,a){var E=this.fragmentTracker.getState(l);this.fragCurrent=l,(this.audioSwitch||E===B.FragmentState.NOT_LOADED||E===B.FragmentState.PARTIAL)&&(l.sn==="initSegment"?this._loadInitSegment(l,p):p.live&&!(0,w.isFiniteNumber)(this.initPTS[l.cc])?(this.log("Waiting for video PTS in continuity counter "+l.cc+" of live stream before loading audio fragment "+l.sn+" of level "+this.trackId),this.state=A.State.WAITING_INIT_PTS):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,l,p,a)))},g.completeAudioSwitch=function(){var l=this.hls,p=this.media,a=this.trackId;p&&(this.log("Switching audio track : flushing all audio"),T.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,l.trigger(N.Events.AUDIO_TRACK_SWITCHED,{id:a})},M}(A.default);const v=L},"./src/controller/audio-track-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>D});var w=o("./src/events.ts"),A=o("./src/errors.ts"),N=o("./src/controller/base-playlist-controller.ts"),O=o("./src/types/loader.ts");function B(x,f){for(var d=0;d<f.length;d++){var c=f[d];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(x,R(c.key),c)}}function F(x,f,d){return f&&B(x.prototype,f),d&&B(x,d),Object.defineProperty(x,"prototype",{writable:!1}),x}function R(x){var f=b(x,"string");return typeof f=="symbol"?f:String(f)}function b(x,f){if(typeof x!="object"||x===null)return x;var d=x[Symbol.toPrimitive];if(d!==void 0){var c=d.call(x,f||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(x)}function S(x,f){x.prototype=Object.create(f.prototype),x.prototype.constructor=x,y(x,f)}function y(x,f){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,h){return c.__proto__=h,c},y(x,f)}var s=function(x){S(f,x);function f(c){var h;return h=x.call(this,c,"[audio-track-controller]")||this,h.tracks=[],h.groupId=null,h.tracksInGroup=[],h.trackId=-1,h.trackName="",h.selectDefaultTrack=!0,h.registerListeners(),h}var d=f.prototype;return d.registerListeners=function(){var h=this.hls;h.on(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.on(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),h.on(w.Events.LEVEL_LOADING,this.onLevelLoading,this),h.on(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),h.on(w.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),h.on(w.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var h=this.hls;h.off(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.off(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),h.off(w.Events.LEVEL_LOADING,this.onLevelLoading,this),h.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),h.off(w.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),h.off(w.Events.ERROR,this.onError,this)},d.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,x.prototype.destroy.call(this)},d.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},d.onManifestParsed=function(h,_){this.tracks=_.audioTracks||[]},d.onAudioTrackLoaded=function(h,_){var L=_.id,v=_.details,T=this.tracksInGroup[L];if(!T){this.warn("Invalid audio track id "+L);return}var M=T.details;T.details=_.details,this.log("audioTrack "+L+" loaded ["+v.startSN+"-"+v.endSN+"]"),L===this.trackId&&(this.retryCount=0,this.playlistLoaded(L,_,M))},d.onLevelLoading=function(h,_){this.switchLevel(_.level)},d.onLevelSwitching=function(h,_){this.switchLevel(_.level)},d.switchLevel=function(h){var _=this.hls.levels[h];if(_!=null&&_.audioGroupIds){var L=_.audioGroupIds[_.urlId];if(this.groupId!==L){this.groupId=L;var v=this.tracks.filter(function(M){return!L||M.groupId===L});this.selectDefaultTrack&&!v.some(function(M){return M.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=v;var T={audioTracks:v};this.log("Updating audio tracks, "+v.length+' track(s) found in "'+L+'" group-id'),this.hls.trigger(w.Events.AUDIO_TRACKS_UPDATED,T),this.selectInitialTrack()}}},d.onError=function(h,_){x.prototype.onError.call(this,h,_),!(_.fatal||!_.context)&&_.context.type===O.PlaylistContextType.AUDIO_TRACK&&_.context.id===this.trackId&&_.context.groupId===this.groupId&&this.retryLoadingOrFail(_)},d.setAudioTrack=function(h){var _=this.tracksInGroup;if(h<0||h>=_.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var L=_[this.trackId];this.log("Now switching to audio-track index "+h);var v=_[h],T=v.id,M=v.groupId,g=M===void 0?"":M,m=v.name,l=v.type,p=v.url;if(this.trackId=h,this.trackName=m,this.selectDefaultTrack=!1,this.hls.trigger(w.Events.AUDIO_TRACK_SWITCHING,{id:T,groupId:g,name:m,type:l,url:p}),!(v.details&&!v.details.live)){var a=this.switchParams(v.url,L==null?void 0:L.details);this.loadPlaylist(a)}},d.selectInitialTrack=function(){var h=this.tracksInGroup;console.assert(h.length,"Initial audio track should be selected when tracks are known");var _=this.trackName,L=this.findTrackId(_)||this.findTrackId();L!==-1?this.setAudioTrack(L):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(w.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},d.findTrackId=function(h){for(var _=this.tracksInGroup,L=0;L<_.length;L++){var v=_[L];if((!this.selectDefaultTrack||v.default)&&(!h||h===v.name))return v.id}return-1},d.loadPlaylist=function(h){x.prototype.loadPlaylist.call(this);var _=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(_)){var L=_.id,v=_.groupId,T=_.url;if(h)try{T=h.addDirectives(T)}catch(M){this.warn("Could not construct new URL with HLS Delivery Directives: "+M)}this.log("loading audio-track playlist for id: "+L),this.clearTimer(),this.hls.trigger(w.Events.AUDIO_TRACK_LOADING,{url:T,id:L,groupId:v,deliveryDirectives:h||null})}},F(f,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(h){this.selectDefaultTrack=!1,this.setAudioTrack(h)}}]),f}(N.default);const D=s},"./src/controller/base-playlist-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>B});var w=o("./src/types/level.ts"),A=o("./src/controller/level-helper.ts"),N=o("./src/utils/logger.ts"),O=o("./src/errors.ts"),B=function(){function F(b,S){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=N.logger.log.bind(N.logger,S+":"),this.warn=N.logger.warn.bind(N.logger,S+":"),this.hls=b}var R=F.prototype;return R.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},R.onError=function(S,y){y.fatal&&(y.type===O.ErrorTypes.NETWORK_ERROR||y.type===O.ErrorTypes.KEY_SYSTEM_ERROR)&&this.stopLoad()},R.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},R.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},R.stopLoad=function(){this.canLoad=!1,this.clearTimer()},R.switchParams=function(S,y){var s=y==null?void 0:y.renditionReports;if(s)for(var D=0;D<s.length;D++){var x=s[D],f=void 0;try{f=new self.URL(x.URI,y.url).href}catch(_){N.logger.warn("Could not construct new URL for Rendition Report: "+_),f=x.URI||""}if(f===S.slice(-f.length)){var d=parseInt(x["LAST-MSN"])||(y==null?void 0:y.lastPartSn),c=parseInt(x["LAST-PART"])||(y==null?void 0:y.lastPartIndex);if(this.hls.config.lowLatencyMode){var h=Math.min(y.age-y.partTarget,y.targetduration);c>=0&&h>y.partTarget&&(c+=1)}return new w.HlsUrlParameters(d,c>=0?c:void 0,w.HlsSkip.No)}}},R.loadPlaylist=function(S){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())},R.shouldLoadTrack=function(S){return this.canLoad&&S&&!!S.url&&(!S.details||S.details.live)},R.playlistLoaded=function(S,y,s){var D=this,x=y.details,f=y.stats,d=self.performance.now(),c=f.loading.first?Math.max(0,d-f.loading.first):0;if(x.advancedDateTime=Date.now()-c,x.live||s!=null&&s.live){if(x.reloaded(s),s&&this.log("live playlist "+S+" "+(x.advanced?"REFRESHED "+x.lastPartSn+"-"+x.lastPartIndex:"MISSED")),s&&x.fragments.length>0&&(0,A.mergeDetails)(s,x),!this.canLoad||!x.live)return;var h,_=void 0,L=void 0;if(x.canBlockReload&&x.endSN&&x.advanced){var v=this.hls.config.lowLatencyMode,T=x.lastPartSn,M=x.endSN,g=x.lastPartIndex,m=g!==-1,l=T===M,p=v?0:g;m?(_=l?M+1:T,L=l?p:g+1):_=M+1;var a=x.age,E=a+x.ageHeader,k=Math.min(E-x.partTarget,x.targetduration*1.5);if(k>0){if(s&&k>s.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+s.tuneInGoal+" to: "+k+" with playlist age: "+x.age),k=0;else{var P=Math.floor(k/x.targetduration);if(_+=P,L!==void 0){var U=Math.round(k%x.targetduration/x.partTarget);L+=U}this.log("CDN Tune-in age: "+x.ageHeader+"s last advanced "+a.toFixed(2)+"s goal: "+k+" skip sn "+P+" to part "+L)}x.tuneInGoal=k}if(h=this.getDeliveryDirectives(x,y.deliveryDirectives,_,L),v||!l){this.loadPlaylist(h);return}}else h=this.getDeliveryDirectives(x,y.deliveryDirectives,_,L);var K=this.hls.mainForwardBufferInfo,W=K?K.end-K.len:0,G=(x.edge-W)*1e3,j=(0,A.computeReloadInterval)(x,G);x.updated?d>this.requestScheduled+j&&(this.requestScheduled=f.loading.start):this.requestScheduled=-1,_!==void 0&&x.canBlockReload?this.requestScheduled=f.loading.first+j-(x.partTarget*1e3||1e3):this.requestScheduled=(this.requestScheduled===-1?d:this.requestScheduled)+j;var H=this.requestScheduled-d;H=Math.max(0,H),this.log("reload live playlist "+S+" in "+Math.round(H)+" ms"),this.timer=self.setTimeout(function(){return D.loadPlaylist(h)},H)}else this.clearTimer()},R.getDeliveryDirectives=function(S,y,s,D){var x=(0,w.getSkipValue)(S,s);return y!=null&&y.skip&&S.deltaUpdateFailed&&(s=y.msn,D=y.part,x=w.HlsSkip.No),new w.HlsUrlParameters(s,D,x)},R.retryLoadingOrFail=function(S){var y=this,s=this.hls.config,D=this.retryCount<s.levelLoadingMaxRetry;if(D){var x;if(this.requestScheduled=-1,this.retryCount++,S.details.indexOf("LoadTimeOut")>-1&&(x=S.context)!==null&&x!==void 0&&x.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+S.details+'"'),this.loadPlaylist();else{var f=Math.min(Math.pow(2,this.retryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return y.loadPlaylist()},f),this.warn("retry playlist loading #"+this.retryCount+" in "+f+' ms after "'+S.details+'"')}}else this.warn('cannot recover from error "'+S.details+'"'),this.clearTimer(),S.fatal=!0;return D},F}()},"./src/controller/base-stream-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{State:()=>m,default:()=>l});var w=o("./src/polyfills/number.ts"),A=o("./src/task-loop.ts"),N=o("./src/controller/fragment-tracker.ts"),O=o("./src/utils/buffer-helper.ts"),B=o("./src/utils/logger.ts"),F=o("./src/events.ts"),R=o("./src/errors.ts"),b=o("./src/types/transmuxer.ts"),S=o("./src/utils/mp4-tools.ts"),y=o("./src/utils/discontinuities.ts"),s=o("./src/controller/fragment-finders.ts"),D=o("./src/controller/level-helper.ts"),x=o("./src/loader/fragment-loader.ts"),f=o("./src/crypt/decrypter.ts"),d=o("./src/utils/time-ranges.ts"),c=o("./src/types/loader.ts");function h(p,a){for(var E=0;E<a.length;E++){var k=a[E];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(p,L(k.key),k)}}function _(p,a,E){return a&&h(p.prototype,a),E&&h(p,E),Object.defineProperty(p,"prototype",{writable:!1}),p}function L(p){var a=v(p,"string");return typeof a=="symbol"?a:String(a)}function v(p,a){if(typeof p!="object"||p===null)return p;var E=p[Symbol.toPrimitive];if(E!==void 0){var k=E.call(p,a||"default");if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(p)}function T(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function M(p,a){p.prototype=Object.create(a.prototype),p.prototype.constructor=p,g(p,a)}function g(p,a){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(k,P){return k.__proto__=P,k},g(p,a)}var m={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},l=function(p){M(a,p);function a(k,P,U,K){var W;return W=p.call(this)||this,W.hls=void 0,W.fragPrevious=null,W.fragCurrent=null,W.fragmentTracker=void 0,W.transmuxer=null,W._state=m.STOPPED,W.media=null,W.mediaBuffer=null,W.config=void 0,W.bitrateTest=!1,W.lastCurrentTime=0,W.nextLoadPosition=0,W.startPosition=0,W.loadedmetadata=!1,W.fragLoadError=0,W.retryDate=0,W.levels=null,W.fragmentLoader=void 0,W.keyLoader=void 0,W.levelLastLoaded=null,W.startFragRequested=!1,W.decrypter=void 0,W.initPTS=[],W.onvseeking=null,W.onvended=null,W.logPrefix="",W.log=void 0,W.warn=void 0,W.logPrefix=K,W.log=B.logger.log.bind(B.logger,K+":"),W.warn=B.logger.warn.bind(B.logger,K+":"),W.hls=k,W.fragmentLoader=new x.default(k.config),W.keyLoader=U,W.fragmentTracker=P,W.config=k.config,W.decrypter=new f.default(k.config),k.on(F.Events.LEVEL_SWITCHING,W.onLevelSwitching,T(W)),W}var E=a.prototype;return E.doTick=function(){this.onTickEnd()},E.onTickEnd=function(){},E.startLoad=function(P){},E.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var P=this.fragCurrent;P&&(P.abortRequests(),this.fragmentTracker.removeFragment(P)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=m.STOPPED},E._streamEnded=function(P,U){if(U.live||P.nextStart||!P.end||!this.media)return!1;var K=U.partList;if(K!=null&&K.length){var W=K[K.length-1],G=O.BufferHelper.isBuffered(this.media,W.start+W.duration/2);return G}var j=U.fragments[U.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(j)},E.getLevelDetails=function(){if(this.levels&&this.levelLastLoaded!==null){var P;return(P=this.levels[this.levelLastLoaded])===null||P===void 0?void 0:P.details}},E.onMediaAttached=function(P,U){var K=this.media=this.mediaBuffer=U.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),K.addEventListener("seeking",this.onvseeking),K.addEventListener("ended",this.onvended);var W=this.config;this.levels&&W.autoStartLoad&&this.state===m.STOPPED&&this.startLoad(W.startPosition)},E.onMediaDetaching=function(){var P=this.media;P!=null&&P.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),P&&this.onvseeking&&this.onvended&&(P.removeEventListener("seeking",this.onvseeking),P.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},E.onMediaSeeking=function(){var P=this.config,U=this.fragCurrent,K=this.media,W=this.mediaBuffer,G=this.state,j=K?K.currentTime:0,H=O.BufferHelper.bufferInfo(W||K,j,P.maxBufferHole);if(this.log("media seeking to "+((0,w.isFiniteNumber)(j)?j.toFixed(3):j)+", state: "+G),this.state===m.ENDED)this.resetLoadingState();else if(U){var V=P.maxFragLookUpTolerance,z=U.start-V,$=U.start+U.duration+V;if(!H.len||$<H.start||z>H.end){var Y=j>$;(j<z||Y)&&(Y&&U.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),U.abortRequests()),this.resetLoadingState())}}K&&(this.lastCurrentTime=j),!this.loadedmetadata&&!H.len&&(this.nextLoadPosition=this.startPosition=j),this.tickImmediate()},E.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},E.onLevelSwitching=function(P,U){this.fragLoadError=0},E.onHandlerDestroying=function(){this.stopLoad(),p.prototype.onHandlerDestroying.call(this)},E.onHandlerDestroyed=function(){this.state=m.STOPPED,this.hls.off(F.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,p.prototype.onHandlerDestroyed.call(this)},E.loadFragment=function(P,U,K){this._loadFragForPlayback(P,U,K)},E._loadFragForPlayback=function(P,U,K){var W=this,G=function(H){if(W.fragContextChanged(P)){W.warn("Fragment "+P.sn+(H.part?" p: "+H.part.index:"")+" of level "+P.level+" was dropped during download."),W.fragmentTracker.removeFragment(P);return}P.stats.chunkCount++,W._handleFragmentLoadProgress(H)};this._doFragLoad(P,U,K,G).then(function(j){if(j){W.fragLoadError=0;var H=W.state;if(W.fragContextChanged(P)){(H===m.FRAG_LOADING||!W.fragCurrent&&H===m.PARSING)&&(W.fragmentTracker.removeFragment(P),W.state=m.IDLE);return}"payload"in j&&(W.log("Loaded fragment "+P.sn+" of level "+P.level),W.hls.trigger(F.Events.FRAG_LOADED,j)),W._handleFragmentLoadComplete(j)}}).catch(function(j){W.state===m.STOPPED||W.state===m.ERROR||(W.warn(j),W.resetFragmentLoading(P))})},E.flushMainBuffer=function(P,U,K){if(K===void 0&&(K=null),!!(P-U)){var W={startOffset:P,endOffset:U,type:K};this.fragLoadError=0,this.hls.trigger(F.Events.BUFFER_FLUSHING,W)}},E._loadInitSegment=function(P,U){var K=this;this._doFragLoad(P,U).then(function(W){if(!W||K.fragContextChanged(P)||!K.levels)throw new Error("init load aborted");return W}).then(function(W){var G=K.hls,j=W.payload,H=P.decryptdata;if(j&&j.byteLength>0&&H&&H.key&&H.iv&&H.method==="AES-128"){var V=self.performance.now();return K.decrypter.decrypt(new Uint8Array(j),H.key.buffer,H.iv.buffer).then(function(z){var $=self.performance.now();return G.trigger(F.Events.FRAG_DECRYPTED,{frag:P,payload:z,stats:{tstart:V,tdecrypt:$}}),W.payload=z,W})}return W}).then(function(W){var G=K.fragCurrent,j=K.hls,H=K.levels;if(!H)throw new Error("init load aborted, missing levels");var V=H[P.level].details;console.assert(V,"Level details are defined when init segment is loaded");var z=P.stats;K.state=m.IDLE,K.fragLoadError=0,P.data=new Uint8Array(W.payload),z.parsing.start=z.buffering.start=self.performance.now(),z.parsing.end=z.buffering.end=self.performance.now(),W.frag===G&&j.trigger(F.Events.FRAG_BUFFERED,{stats:z,frag:G,part:null,id:P.type}),K.tick()}).catch(function(W){K.state===m.STOPPED||K.state===m.ERROR||(K.warn(W),K.resetFragmentLoading(P))})},E.fragContextChanged=function(P){var U=this.fragCurrent;return!P||!U||P.level!==U.level||P.sn!==U.sn||P.urlId!==U.urlId},E.fragBufferedComplete=function(P,U){var K,W,G,j,H=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+P.type+" sn: "+P.sn+(U?" part: "+U.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+P.level+" (frag:["+((K=P.startPTS)!=null?K:NaN).toFixed(3)+"-"+((W=P.endPTS)!=null?W:NaN).toFixed(3)+"] > buffer:"+(H?d.default.toString(O.BufferHelper.getBuffered(H)):"(detached)")+")"),this.state=m.IDLE,H&&(!this.loadedmetadata&&P.type==c.PlaylistLevelType.MAIN&&H.buffered.length&&((G=this.fragCurrent)===null||G===void 0?void 0:G.sn)===((j=this.fragPrevious)===null||j===void 0?void 0:j.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},E.seekToStartPos=function(){},E._handleFragmentLoadComplete=function(P){var U=this.transmuxer;if(U){var K=P.frag,W=P.part,G=P.partsLoaded,j=!G||G.length===0||G.some(function(V){return!V}),H=new b.ChunkMetadata(K.level,K.sn,K.stats.chunkCount+1,0,W?W.index:-1,!j);U.flush(H)}},E._handleFragmentLoadProgress=function(P){},E._doFragLoad=function(P,U,K,W){var G,j=this;if(K===void 0&&(K=null),!this.levels)throw new Error("frag load aborted, missing levels");var H=null;if(P.encrypted&&!((G=P.decryptdata)!==null&&G!==void 0&&G.key)?(this.log("Loading key for "+P.sn+" of ["+U.startSN+"-"+U.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+P.level),this.state=m.KEY_LOADING,this.fragCurrent=P,H=this.keyLoader.load(P).then(function(X){if(!j.fragContextChanged(X.frag))return j.hls.trigger(F.Events.KEY_LOADED,X),j.state===m.KEY_LOADING&&(j.state=m.IDLE),X}),this.hls.trigger(F.Events.KEY_LOADING,{frag:P}),this.throwIfFragContextChanged("KEY_LOADING")):!P.encrypted&&U.encryptedFragments.length&&this.keyLoader.loadClear(P,U.encryptedFragments),K=Math.max(P.start,K||0),this.config.lowLatencyMode&&U){var V=U.partList;if(V&&W){K>P.end&&U.fragmentHint&&(P=U.fragmentHint);var z=this.getNextPart(V,P,K);if(z>-1){var $=V[z];return this.log("Loading part sn: "+P.sn+" p: "+$.index+" cc: "+P.cc+" of playlist ["+U.startSN+"-"+U.endSN+"] parts [0-"+z+"-"+(V.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+P.level+", target: "+parseFloat(K.toFixed(3))),this.nextLoadPosition=$.start+$.duration,this.state=m.FRAG_LOADING,this.hls.trigger(F.Events.FRAG_LOADING,{frag:P,part:V[z],targetBufferTime:K}),this.throwIfFragContextChanged("FRAG_LOADING parts"),H?H.then(function(X){return!X||j.fragContextChanged(X.frag)?null:j.doFragPartsLoad(P,V,z,W)}).catch(function(X){return j.handleFragLoadError(X)}):this.doFragPartsLoad(P,V,z,W).catch(function(X){return j.handleFragLoadError(X)})}else if(!P.url||this.loadedEndOfParts(V,K))return Promise.resolve(null)}}this.log("Loading fragment "+P.sn+" cc: "+P.cc+" "+(U?"of ["+U.startSN+"-"+U.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+P.level+", target: "+parseFloat(K.toFixed(3))),(0,w.isFiniteNumber)(P.sn)&&!this.bitrateTest&&(this.nextLoadPosition=P.start+P.duration),this.state=m.FRAG_LOADING,this.hls.trigger(F.Events.FRAG_LOADING,{frag:P,targetBufferTime:K}),this.throwIfFragContextChanged("FRAG_LOADING");var Y=this.config.progressive;return Y&&H?H.then(function(X){return!X||j.fragContextChanged(X==null?void 0:X.frag)?null:j.fragmentLoader.load(P,W)}).catch(function(X){return j.handleFragLoadError(X)}):Promise.all([this.fragmentLoader.load(P,Y?W:void 0),H]).then(function(X){var Z=X[0];return!Y&&Z&&W&&W(Z),Z}).catch(function(X){return j.handleFragLoadError(X)})},E.throwIfFragContextChanged=function(P){if(this.fragCurrent===null)throw new Error("frag load aborted, context changed in "+P)},E.doFragPartsLoad=function(P,U,K,W){var G=this;return new Promise(function(j,H){var V=[],z=function $(Y){var X=U[Y];G.fragmentLoader.loadPart(P,X,W).then(function(Z){V[X.index]=Z;var Q=Z.part;G.hls.trigger(F.Events.FRAG_LOADED,Z);var J=U[Y+1];if(J&&J.fragment===P)$(Y+1);else return j({frag:P,part:Q,partsLoaded:V})}).catch(H)};z(K)})},E.handleFragLoadError=function(P){if("data"in P){var U=P.data;P.data&&U.details===R.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(U.frag,U.part):this.hls.trigger(F.Events.ERROR,U)}else this.hls.trigger(F.Events.ERROR,{type:R.ErrorTypes.OTHER_ERROR,details:R.ErrorDetails.INTERNAL_EXCEPTION,err:P,fatal:!0});return null},E._handleTransmuxerFlush=function(P){var U=this.getCurrentContext(P);if(!U||this.state!==m.PARSING){!this.fragCurrent&&this.state!==m.STOPPED&&this.state!==m.ERROR&&(this.state=m.IDLE);return}var K=U.frag,W=U.part,G=U.level,j=self.performance.now();K.stats.parsing.end=j,W&&(W.stats.parsing.end=j),this.updateLevelTiming(K,W,G,P.partial)},E.getCurrentContext=function(P){var U=this.levels,K=P.level,W=P.sn,G=P.part;if(!U||!U[K])return this.warn("Levels object was unset while buffering fragment "+W+" of level "+K+". The current chunk will not be buffered."),null;var j=U[K],H=G>-1?(0,D.getPartWith)(j,W,G):null,V=H?H.fragment:(0,D.getFragmentWithSN)(j,W,this.fragCurrent);return V?{frag:V,part:H,level:j}:null},E.bufferFragmentData=function(P,U,K,W){if(!(!P||this.state!==m.PARSING)){var G=P.data1,j=P.data2,H=G;if(G&&j&&(H=(0,S.appendUint8Array)(G,j)),!(!H||!H.length)){var V={type:P.type,frag:U,part:K,chunkMeta:W,parent:U.type,data:H};this.hls.trigger(F.Events.BUFFER_APPENDING,V),P.dropped&&P.independent&&!K&&this.flushBufferGap(U)}}},E.flushBufferGap=function(P){var U=this.media;if(U){if(!O.BufferHelper.isBuffered(U,U.currentTime)){this.flushMainBuffer(0,P.start);return}var K=U.currentTime,W=O.BufferHelper.bufferInfo(U,K,0),G=P.duration,j=Math.min(this.config.maxFragLookUpTolerance*2,G*.25),H=Math.max(Math.min(P.start-j,W.end-j),K+j);P.start-H>j&&this.flushMainBuffer(H,P.start)}},E.getFwdBufferInfo=function(P,U){var K=this.config,W=this.getLoadPosition();if(!(0,w.isFiniteNumber)(W))return null;var G=O.BufferHelper.bufferInfo(P,W,K.maxBufferHole);if(G.len===0&&G.nextStart!==void 0){var j=this.fragmentTracker.getBufferedFrag(W,U);if(j&&G.nextStart<j.end)return O.BufferHelper.bufferInfo(P,W,Math.max(G.nextStart,K.maxBufferHole))}return G},E.getMaxBufferLength=function(P){var U=this.config,K;return P?K=Math.max(8*U.maxBufferSize/P,U.maxBufferLength):K=U.maxBufferLength,Math.min(K,U.maxMaxBufferLength)},E.reduceMaxBufferLength=function(P){var U=this.config,K=P||U.maxBufferLength;return U.maxMaxBufferLength>=K?(U.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+U.maxMaxBufferLength+"s"),!0):!1},E.getNextFragment=function(P,U){var K=U.fragments,W=K.length;if(!W)return null;var G=this.config,j=K[0].start,H;if(U.live){var V=G.initialLiveManifestSize;if(W<V)return this.warn("Not enough fragments to start playback (have: "+W+", need: "+V+")"),null;!U.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(H=this.getInitialLiveFragment(U,K),this.startPosition=H?this.hls.liveSyncPosition||H.start:P)}else P<=j&&(H=K[0]);if(!H){var z=G.lowLatencyMode?U.partEnd:U.fragmentEnd;H=this.getFragmentAtPosition(P,z,U)}return this.mapToInitFragWhenRequired(H)},E.mapToInitFragWhenRequired=function(P){return P!=null&&P.initSegment&&!(P!=null&&P.initSegment.data)&&!this.bitrateTest?P.initSegment:P},E.getNextPart=function(P,U,K){for(var W=-1,G=!1,j=!0,H=0,V=P.length;H<V;H++){var z=P[H];if(j=j&&!z.independent,W>-1&&K<z.start)break;var $=z.loaded;$?W=-1:(G||z.independent||j)&&z.fragment===U&&(W=H),G=$}return W},E.loadedEndOfParts=function(P,U){var K=P[P.length-1];return K&&U>K.start&&K.loaded},E.getInitialLiveFragment=function(P,U){var K=this.fragPrevious,W=null;if(K){if(P.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+K.programDateTime),W=(0,s.findFragmentByPDT)(U,K.endProgramDateTime,this.config.maxFragLookUpTolerance)),!W){var G=K.sn+1;if(G>=P.startSN&&G<=P.endSN){var j=U[G-P.startSN];K.cc===j.cc&&(W=j,this.log("Live playlist, switching playlist, load frag with next SN: "+W.sn))}W||(W=(0,s.findFragWithCC)(U,K.cc),W&&this.log("Live playlist, switching playlist, load frag with same CC: "+W.sn))}}else{var H=this.hls.liveSyncPosition;H!==null&&(W=this.getFragmentAtPosition(H,this.bitrateTest?P.fragmentEnd:P.edge,P))}return W},E.getFragmentAtPosition=function(P,U,K){var W=this.config,G=this.fragPrevious,j=K.fragments,H=K.endSN,V=K.fragmentHint,z=W.maxFragLookUpTolerance,$=!!(W.lowLatencyMode&&K.partList&&V);$&&V&&!this.bitrateTest&&(j=j.concat(V),H=V.sn);var Y;if(P<U){var X=P>U-z?0:z;Y=(0,s.findFragmentByPTS)(G,j,P,X)}else Y=j[j.length-1];if(Y){var Z=Y.sn-K.startSN;if(this.fragmentTracker.getState(Y)===N.FragmentState.OK&&(G=Y),G&&Y.sn===G.sn&&!$){var Q=G&&Y.level===G.level;if(Q){var J=j[Z+1];Y.sn<H&&this.fragmentTracker.getState(J)!==N.FragmentState.OK?(this.log("SN "+Y.sn+" just loaded, load next one: "+J.sn),Y=J):Y=null}}}return Y},E.synchronizeToLiveEdge=function(P){var U=this.config,K=this.media;if(K){var W=this.hls.liveSyncPosition,G=K.currentTime,j=P.fragments[0].start,H=P.edge,V=G>=j-U.maxFragLookUpTolerance&&G<=H;if(W!==null&&K.duration>W&&(G<W||!V)){var z=U.liveMaxLatencyDuration!==void 0?U.liveMaxLatencyDuration:U.liveMaxLatencyDurationCount*P.targetduration;(!V&&K.readyState<4||G<H-z)&&(this.loadedmetadata||(this.nextLoadPosition=W),K.readyState&&(this.warn("Playback: "+G.toFixed(3)+" is located too far from the end of live sliding playlist: "+H+", reset currentTime to : "+W.toFixed(3)),K.currentTime=W))}}},E.alignPlaylists=function(P,U){var K=this.levels,W=this.levelLastLoaded,G=this.fragPrevious,j=W!==null?K[W]:null,H=P.fragments.length;if(!H)return this.warn("No fragments in live playlist"),0;var V=P.fragments[0].start,z=!U,$=P.alignedSliding&&(0,w.isFiniteNumber)(V);if(z||!$&&!V){(0,y.alignStream)(G,j,P);var Y=P.fragments[0].start;return this.log("Live playlist sliding: "+Y.toFixed(2)+" start-sn: "+(U?U.startSN:"na")+"->"+P.startSN+" prev-sn: "+(G?G.sn:"na")+" fragments: "+H),Y}return V},E.waitForCdnTuneIn=function(P){var U=3;return P.live&&P.canBlockReload&&P.partTarget&&P.tuneInGoal>Math.max(P.partHoldBack,P.partTarget*U)},E.setStartPosition=function(P,U){var K=this.startPosition;if(K<U&&(K=-1),K===-1||this.lastCurrentTime===-1){var W=P.startTimeOffset;(0,w.isFiniteNumber)(W)?(K=U+W,W<0&&(K+=P.totalduration),K=Math.min(Math.max(U,K),U+P.totalduration),this.log("Start time offset "+W+" found in playlist, adjust startPosition to "+K),this.startPosition=K):P.live?K=this.hls.liveSyncPosition||U:this.startPosition=K=0,this.lastCurrentTime=K}this.nextLoadPosition=K},E.getLoadPosition=function(){var P=this.media,U=0;return this.loadedmetadata&&P?U=P.currentTime:this.nextLoadPosition&&(U=this.nextLoadPosition),U},E.handleFragLoadAborted=function(P,U){this.transmuxer&&P.sn!=="initSegment"&&P.stats.aborted&&(this.warn("Fragment "+P.sn+(U?" part"+U.index:"")+" of level "+P.level+" was aborted"),this.resetFragmentLoading(P))},E.resetFragmentLoading=function(P){(!this.fragCurrent||!this.fragContextChanged(P)&&this.state!==m.FRAG_LOADING_WAITING_RETRY)&&(this.state=m.IDLE)},E.onFragmentOrKeyLoadError=function(P,U){if(U.fatal){this.stopLoad(),this.state=m.ERROR;return}var K=this.config;if(U.chunkMeta){var W=this.getCurrentContext(U.chunkMeta);W&&(U.frag=W.frag,U.levelRetry=!0,this.fragLoadError=K.fragLoadingMaxRetry)}var G=U.frag;if(!(!G||G.type!==P)){var j=this.fragCurrent;if(console.assert(j&&G.sn===j.sn&&G.level===j.level&&G.urlId===j.urlId,"Frag load error must match current frag to retry"),this.fragLoadError+1<=K.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var H=Math.min(Math.pow(2,this.fragLoadError)*K.fragLoadingRetryDelay,K.fragLoadingMaxRetryTimeout);this.warn("Fragment "+G.sn+" of "+P+" "+G.level+" failed to load, retrying in "+H+"ms"),this.retryDate=self.performance.now()+H,this.fragLoadError++,this.state=m.FRAG_LOADING_WAITING_RETRY}else U.levelRetry?(P===c.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=m.IDLE):(B.logger.error(U.details+" reaches max retry, redispatch as fatal ..."),U.fatal=!0,this.hls.stopLoad(),this.state=m.ERROR)}},E.afterBufferFlushed=function(P,U,K){if(P){var W=O.BufferHelper.getBuffered(P);this.fragmentTracker.detectEvictedFragments(U,W,K),this.state===m.ENDED&&this.resetLoadingState()}},E.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=m.IDLE},E.resetStartWhenNotLoaded=function(P){if(!this.loadedmetadata){this.startFragRequested=!1;var U=this.levels?this.levels[P].details:null;U!=null&&U.live?(this.startPosition=-1,this.setStartPosition(U,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},E.updateLevelTiming=function(P,U,K,W){var G=this,j=K.details;console.assert(!!j,"level.details must be defined");var H=Object.keys(P.elementaryStreams).reduce(function(V,z){var $=P.elementaryStreams[z];if($){var Y=$.endPTS-$.startPTS;if(Y<=0)return G.warn("Could not parse fragment "+P.sn+" "+z+" duration reliably ("+Y+")"),V||!1;var X=W?0:(0,D.updateFragPTSDTS)(j,P,$.startPTS,$.endPTS,$.startDTS,$.endDTS);return G.hls.trigger(F.Events.LEVEL_PTS_UPDATED,{details:j,level:K,drift:X,type:z,frag:P,start:$.startPTS,end:$.endPTS}),!0}return V},!1);H||(this.warn("Found no media in fragment "+P.sn+" of level "+K.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=m.PARSED,this.hls.trigger(F.Events.FRAG_PARSED,{frag:P,part:U})},E.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},_(a,[{key:"state",get:function(){return this._state},set:function(P){var U=this._state;U!==P&&(this._state=P,this.log(U+"->"+P))}}]),a}(A.default)},"./src/controller/buffer-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>s});var w=o("./src/polyfills/number.ts"),A=o("./src/events.ts"),N=o("./src/utils/logger.ts"),O=o("./src/errors.ts"),B=o("./src/utils/buffer-helper.ts"),F=o("./src/utils/mediasource-helper.ts"),R=o("./src/loader/fragment.ts"),b=o("./src/controller/buffer-operation-queue.ts"),S=(0,F.getMediaSource)(),y=/([ha]vc.)(?:\.[^.,]+)+/,s=function(){function D(f){var d=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var c=d.media,h=d.mediaSource;N.logger.log("[buffer-controller]: Media source opened"),c&&(c.removeEventListener("emptied",d._onMediaEmptied),d.updateMediaElementDuration(),d.hls.trigger(A.Events.MEDIA_ATTACHED,{media:c})),h&&h.removeEventListener("sourceopen",d._onMediaSourceOpen),d.checkPendingTracks()},this._onMediaSourceClose=function(){N.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){N.logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=function(){var c=d.media,h=d._objectUrl;c&&c.src!==h&&N.logger.error("Media element src was set while attaching MediaSource ("+h+" > "+c.src+")")},this.hls=f,this._initSourceBuffer(),this.registerListeners()}var x=D.prototype;return x.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},x.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},x.registerListeners=function(){var d=this.hls;d.on(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.on(A.Events.BUFFER_RESET,this.onBufferReset,this),d.on(A.Events.BUFFER_APPENDING,this.onBufferAppending,this),d.on(A.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.on(A.Events.BUFFER_EOS,this.onBufferEos,this),d.on(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),d.on(A.Events.LEVEL_UPDATED,this.onLevelUpdated,this),d.on(A.Events.FRAG_PARSED,this.onFragParsed,this),d.on(A.Events.FRAG_CHANGED,this.onFragChanged,this)},x.unregisterListeners=function(){var d=this.hls;d.off(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.off(A.Events.BUFFER_RESET,this.onBufferReset,this),d.off(A.Events.BUFFER_APPENDING,this.onBufferAppending,this),d.off(A.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.off(A.Events.BUFFER_EOS,this.onBufferEos,this),d.off(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),d.off(A.Events.LEVEL_UPDATED,this.onLevelUpdated,this),d.off(A.Events.FRAG_PARSED,this.onFragParsed,this),d.off(A.Events.FRAG_CHANGED,this.onFragChanged,this)},x._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new b.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},x.onManifestParsed=function(d,c){var h=2;(c.audio&&!c.video||!c.altAudio)&&(h=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=h,this.details=null,N.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},x.onMediaAttaching=function(d,c){var h=this.media=c.media;if(h&&S){var _=this.mediaSource=new S;_.addEventListener("sourceopen",this._onMediaSourceOpen),_.addEventListener("sourceended",this._onMediaSourceEnded),_.addEventListener("sourceclose",this._onMediaSourceClose),h.src=self.URL.createObjectURL(_),this._objectUrl=h.src,h.addEventListener("emptied",this._onMediaEmptied)}},x.onMediaDetaching=function(){var d=this.media,c=this.mediaSource,h=this._objectUrl;if(c){if(N.logger.log("[buffer-controller]: media source detaching"),c.readyState==="open")try{c.endOfStream()}catch(_){N.logger.warn("[buffer-controller]: onMediaDetaching: "+_.message+" while calling endOfStream")}this.onBufferReset(),c.removeEventListener("sourceopen",this._onMediaSourceOpen),c.removeEventListener("sourceended",this._onMediaSourceEnded),c.removeEventListener("sourceclose",this._onMediaSourceClose),d&&(d.removeEventListener("emptied",this._onMediaEmptied),h&&self.URL.revokeObjectURL(h),d.src===h?(d.removeAttribute("src"),d.load()):N.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(A.Events.MEDIA_DETACHED,void 0)},x.onBufferReset=function(){var d=this;this.getSourceBufferTypes().forEach(function(c){var h=d.sourceBuffer[c];try{h&&(d.removeBufferListeners(c),d.mediaSource&&d.mediaSource.removeSourceBuffer(h),d.sourceBuffer[c]=void 0)}catch(_){N.logger.warn("[buffer-controller]: Failed to reset the "+c+" buffer",_)}}),this._initSourceBuffer()},x.onBufferCodecs=function(d,c){var h=this,_=this.getSourceBufferTypes().length;Object.keys(c).forEach(function(L){if(_){var v=h.tracks[L];if(v&&typeof v.buffer.changeType=="function"){var T=c[L],M=T.id,g=T.codec,m=T.levelCodec,l=T.container,p=T.metadata,a=(v.levelCodec||v.codec).replace(y,"$1"),E=(m||g).replace(y,"$1");if(a!==E){var k=l+";codecs="+(m||g);h.appendChangeType(L,k),N.logger.log("[buffer-controller]: switching codec "+a+" to "+E),h.tracks[L]={buffer:v.buffer,codec:g,container:l,levelCodec:m,metadata:p,id:M}}}}else h.pendingTracks[L]=c[L]}),!_&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},x.appendChangeType=function(d,c){var h=this,_=this.operationQueue,L={execute:function(){var T=h.sourceBuffer[d];T&&(N.logger.log("[buffer-controller]: changing "+d+" sourceBuffer type to "+c),T.changeType(c)),_.shiftAndExecuteNext(d)},onStart:function(){},onComplete:function(){},onError:function(T){N.logger.warn("[buffer-controller]: Failed to change "+d+" SourceBuffer type",T)}};_.append(L,d)},x.onBufferAppending=function(d,c){var h=this,_=this.hls,L=this.operationQueue,v=this.tracks,T=c.data,M=c.type,g=c.frag,m=c.part,l=c.chunkMeta,p=l.buffering[M],a=self.performance.now();p.start=a;var E=g.stats.buffering,k=m?m.stats.buffering:null;E.start===0&&(E.start=a),k&&k.start===0&&(k.start=a);var P=v.audio,U=!1;M==="audio"&&(P==null?void 0:P.container)==="audio/mpeg"&&(U=!this.lastMpegAudioChunk||l.id===1||this.lastMpegAudioChunk.sn!==l.sn,this.lastMpegAudioChunk=l);var K=g.start,W={execute:function(){if(p.executeStart=self.performance.now(),U){var j=h.sourceBuffer[M];if(j){var H=K-j.timestampOffset;Math.abs(H)>=.1&&(N.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+K+" (delta: "+H+") sn: "+g.sn+")"),j.timestampOffset=K)}}h.appendExecutor(T,M)},onStart:function(){},onComplete:function(){var j=self.performance.now();p.executeEnd=p.end=j,E.first===0&&(E.first=j),k&&k.first===0&&(k.first=j);var H=h.sourceBuffer,V={};for(var z in H)V[z]=B.BufferHelper.getBuffered(H[z]);h.appendError=0,h.hls.trigger(A.Events.BUFFER_APPENDED,{type:M,frag:g,part:m,chunkMeta:l,parent:g.type,timeRanges:V})},onError:function(j){N.logger.error("[buffer-controller]: Error encountered while trying to append to the "+M+" SourceBuffer",j);var H={type:O.ErrorTypes.MEDIA_ERROR,parent:g.type,details:O.ErrorDetails.BUFFER_APPEND_ERROR,err:j,fatal:!1};j.code===DOMException.QUOTA_EXCEEDED_ERR?H.details=O.ErrorDetails.BUFFER_FULL_ERROR:(h.appendError++,H.details=O.ErrorDetails.BUFFER_APPEND_ERROR,h.appendError>_.config.appendErrorMaxRetry&&(N.logger.error("[buffer-controller]: Failed "+_.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),H.fatal=!0,_.stopLoad())),_.trigger(A.Events.ERROR,H)}};L.append(W,M)},x.onBufferFlushing=function(d,c){var h=this,_=this.operationQueue,L=function(T){return{execute:h.removeExecutor.bind(h,T,c.startOffset,c.endOffset),onStart:function(){},onComplete:function(){h.hls.trigger(A.Events.BUFFER_FLUSHED,{type:T})},onError:function(g){N.logger.warn("[buffer-controller]: Failed to remove from "+T+" SourceBuffer",g)}}};c.type?_.append(L(c.type),c.type):this.getSourceBufferTypes().forEach(function(v){_.append(L(v),v)})},x.onFragParsed=function(d,c){var h=this,_=c.frag,L=c.part,v=[],T=L?L.elementaryStreams:_.elementaryStreams;T[R.ElementaryStreamTypes.AUDIOVIDEO]?v.push("audiovideo"):(T[R.ElementaryStreamTypes.AUDIO]&&v.push("audio"),T[R.ElementaryStreamTypes.VIDEO]&&v.push("video"));var M=function(){var m=self.performance.now();_.stats.buffering.end=m,L&&(L.stats.buffering.end=m);var l=L?L.stats:_.stats;h.hls.trigger(A.Events.FRAG_BUFFERED,{frag:_,part:L,stats:l,id:_.type})};v.length===0&&N.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+_.type+" level: "+_.level+" sn: "+_.sn),this.blockBuffers(M,v)},x.onFragChanged=function(d,c){this.flushBackBuffer()},x.onBufferEos=function(d,c){var h=this,_=this.getSourceBufferTypes().reduce(function(L,v){var T=h.sourceBuffer[v];return T&&(!c.type||c.type===v)&&(T.ending=!0,T.ended||(T.ended=!0,N.logger.log("[buffer-controller]: "+v+" sourceBuffer now EOS"))),L&&!!(!T||T.ended)},!0);_&&(N.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){h.getSourceBufferTypes().forEach(function(v){var T=h.sourceBuffer[v];T&&(T.ending=!1)});var L=h.mediaSource;if(!L||L.readyState!=="open"){L&&N.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+L.readyState);return}N.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),L.endOfStream()}))},x.onLevelUpdated=function(d,c){var h=c.details;h.fragments.length&&(this.details=h,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},x.flushBackBuffer=function(){var d=this.hls,c=this.details,h=this.media,_=this.sourceBuffer;if(!(!h||c===null)){var L=this.getSourceBufferTypes();if(L.length){var v=c.live&&d.config.liveBackBufferLength!==null?d.config.liveBackBufferLength:d.config.backBufferLength;if(!(!(0,w.isFiniteNumber)(v)||v<0)){var T=h.currentTime,M=c.levelTargetDuration,g=Math.max(v,M),m=Math.floor(T/M)*M-g;L.forEach(function(l){var p=_[l];if(p){var a=B.BufferHelper.getBuffered(p);if(a.length>0&&m>a.start(0)){if(d.trigger(A.Events.BACK_BUFFER_REACHED,{bufferEnd:m}),c.live)d.trigger(A.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:m});else if(p.ended&&a.end(a.length-1)-T<M*2){N.logger.info("[buffer-controller]: Cannot flush "+l+" back buffer while SourceBuffer is in ended state");return}d.trigger(A.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:m,type:l})}}})}}}},x.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var d=this.details,c=this.hls,h=this.media,_=this.mediaSource,L=d.fragments[0].start+d.totalduration,v=h.duration,T=(0,w.isFiniteNumber)(_.duration)?_.duration:0;d.live&&c.config.liveDurationInfinity?(N.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),_.duration=1/0,this.updateSeekableRange(d)):(L>T&&L>v||!(0,w.isFiniteNumber)(v))&&(N.logger.log("[buffer-controller]: Updating Media Source duration to "+L.toFixed(3)),_.duration=L)}},x.updateSeekableRange=function(d){var c=this.mediaSource,h=d.fragments,_=h.length;if(_&&d.live&&c!==null&&c!==void 0&&c.setLiveSeekableRange){var L=Math.max(0,h[0].start),v=Math.max(L,L+d.totalduration);c.setLiveSeekableRange(L,v)}},x.checkPendingTracks=function(){var d=this.bufferCodecEventsExpected,c=this.operationQueue,h=this.pendingTracks,_=Object.keys(h).length;if(_&&!d||_===2){this.createSourceBuffers(h),this.pendingTracks={};var L=this.getSourceBufferTypes();if(L.length===0){this.hls.trigger(A.Events.ERROR,{type:O.ErrorTypes.MEDIA_ERROR,details:O.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}L.forEach(function(v){c.executeNext(v)})}},x.createSourceBuffers=function(d){var c=this.sourceBuffer,h=this.mediaSource;if(!h)throw Error("createSourceBuffers called when mediaSource was null");var _=0;for(var L in d)if(!c[L]){var v=d[L];if(!v)throw Error("source buffer exists for track "+L+", however track does not");var T=v.levelCodec||v.codec,M=v.container+";codecs="+T;N.logger.log("[buffer-controller]: creating sourceBuffer("+M+")");try{var g=c[L]=h.addSourceBuffer(M),m=L;this.addBufferListener(m,"updatestart",this._onSBUpdateStart),this.addBufferListener(m,"updateend",this._onSBUpdateEnd),this.addBufferListener(m,"error",this._onSBUpdateError),this.tracks[L]={buffer:g,codec:T,container:v.container,levelCodec:v.levelCodec,metadata:v.metadata,id:v.id},_++}catch(l){N.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+l.message),this.hls.trigger(A.Events.ERROR,{type:O.ErrorTypes.MEDIA_ERROR,details:O.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:l,mimeType:M})}}_&&this.hls.trigger(A.Events.BUFFER_CREATED,{tracks:this.tracks})},x._onSBUpdateStart=function(d){var c=this.operationQueue,h=c.current(d);h.onStart()},x._onSBUpdateEnd=function(d){var c=this.operationQueue,h=c.current(d);h.onComplete(),c.shiftAndExecuteNext(d)},x._onSBUpdateError=function(d,c){N.logger.error("[buffer-controller]: "+d+" SourceBuffer error",c),this.hls.trigger(A.Events.ERROR,{type:O.ErrorTypes.MEDIA_ERROR,details:O.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var h=this.operationQueue.current(d);h&&h.onError(c)},x.removeExecutor=function(d,c,h){var _=this.media,L=this.mediaSource,v=this.operationQueue,T=this.sourceBuffer,M=T[d];if(!_||!L||!M){N.logger.warn("[buffer-controller]: Attempting to remove from the "+d+" SourceBuffer, but it does not exist"),v.shiftAndExecuteNext(d);return}var g=(0,w.isFiniteNumber)(_.duration)?_.duration:1/0,m=(0,w.isFiniteNumber)(L.duration)?L.duration:1/0,l=Math.max(0,c),p=Math.min(h,g,m);p>l&&!M.ending?(M.ended=!1,N.logger.log("[buffer-controller]: Removing ["+l+","+p+"] from the "+d+" SourceBuffer"),console.assert(!M.updating,d+" sourceBuffer must not be updating"),M.remove(l,p)):v.shiftAndExecuteNext(d)},x.appendExecutor=function(d,c){var h=this.operationQueue,_=this.sourceBuffer,L=_[c];if(!L){N.logger.warn("[buffer-controller]: Attempting to append to the "+c+" SourceBuffer, but it does not exist"),h.shiftAndExecuteNext(c);return}L.ended=!1,console.assert(!L.updating,c+" sourceBuffer must not be updating"),L.appendBuffer(d)},x.blockBuffers=function(d,c){var h=this;if(c===void 0&&(c=this.getSourceBufferTypes()),!c.length){N.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(d);return}var _=this.operationQueue,L=c.map(function(v){return _.appendBlocker(v)});Promise.all(L).then(function(){d(),c.forEach(function(v){var T=h.sourceBuffer[v];(!T||!T.updating)&&_.shiftAndExecuteNext(v)})})},x.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},x.addBufferListener=function(d,c,h){var _=this.sourceBuffer[d];if(_){var L=h.bind(this,d);this.listeners[d].push({event:c,listener:L}),_.addEventListener(c,L)}},x.removeBufferListeners=function(d){var c=this.sourceBuffer[d];c&&this.listeners[d].forEach(function(h){c.removeEventListener(h.event,h.listener)})},D}()},"./src/controller/buffer-operation-queue.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>A});var w=o("./src/utils/logger.ts"),A=function(){function N(B){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=B}var O=N.prototype;return O.append=function(F,R){var b=this.queues[R];b.push(F),b.length===1&&this.buffers[R]&&this.executeNext(R)},O.insertAbort=function(F,R){var b=this.queues[R];b.unshift(F),this.executeNext(R)},O.appendBlocker=function(F){var R,b=new Promise(function(y){R=y}),S={execute:R,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(S,F),b},O.executeNext=function(F){var R=this.buffers,b=this.queues,S=R[F],y=b[F];if(y.length){var s=y[0];try{s.execute()}catch(D){w.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),s.onError(D),(!S||!S.updating)&&(y.shift(),this.executeNext(F))}}},O.shiftAndExecuteNext=function(F){this.queues[F].shift(),this.executeNext(F)},O.current=function(F){return this.queues[F][0]},N}()},"./src/controller/cap-level-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>R});var w=o("./src/events.ts");function A(b,S){for(var y=0;y<S.length;y++){var s=S[y];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(b,O(s.key),s)}}function N(b,S,y){return S&&A(b.prototype,S),y&&A(b,y),Object.defineProperty(b,"prototype",{writable:!1}),b}function O(b){var S=B(b,"string");return typeof S=="symbol"?S:String(S)}function B(b,S){if(typeof b!="object"||b===null)return b;var y=b[Symbol.toPrimitive];if(y!==void 0){var s=y.call(b,S||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(b)}var F=function(){function b(y){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=y,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var S=b.prototype;return S.setStreamController=function(s){this.streamController=s},S.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},S.registerListeners=function(){var s=this.hls;s.on(w.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),s.on(w.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),s.on(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),s.on(w.Events.BUFFER_CODECS,this.onBufferCodecs,this),s.on(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},S.unregisterListener=function(){var s=this.hls;s.off(w.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),s.off(w.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),s.off(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),s.off(w.Events.BUFFER_CODECS,this.onBufferCodecs,this),s.off(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},S.onFpsDropLevelCapping=function(s,D){b.isLevelAllowed(D.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(D.droppedLevel)},S.onMediaAttaching=function(s,D){this.media=D.media instanceof HTMLVideoElement?D.media:null,this.clientRect=null},S.onManifestParsed=function(s,D){var x=this.hls;this.restrictedLevels=[],this.firstLevel=D.firstLevel,x.config.capLevelToPlayerSize&&D.video&&this.startCapping()},S.onBufferCodecs=function(s,D){var x=this.hls;x.config.capLevelToPlayerSize&&D.video&&this.startCapping()},S.onMediaDetaching=function(){this.stopCapping()},S.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var s=this.hls.levels;if(s.length){var D=this.hls;D.autoLevelCapping=this.getMaxLevel(s.length-1),D.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=D.autoLevelCapping}}},S.getMaxLevel=function(s){var D=this,x=this.hls.levels;if(!x.length)return-1;var f=x.filter(function(d,c){return b.isLevelAllowed(c,D.restrictedLevels)&&c<=s});return this.clientRect=null,b.getMaxLevelByMediaSize(f,this.mediaWidth,this.mediaHeight)},S.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},S.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},S.getDimensions=function(){if(this.clientRect)return this.clientRect;var s=this.media,D={width:0,height:0};if(s){var x=s.getBoundingClientRect();D.width=x.width,D.height=x.height,!D.width&&!D.height&&(D.width=x.right-x.left||s.width||0,D.height=x.bottom-x.top||s.height||0)}return this.clientRect=D,D},b.isLevelAllowed=function(s,D){return D===void 0&&(D=[]),D.indexOf(s)===-1},b.getMaxLevelByMediaSize=function(s,D,x){if(!s||!s.length)return-1;for(var f=function(L,v){return v?L.width!==v.width||L.height!==v.height:!0},d=s.length-1,c=0;c<s.length;c+=1){var h=s[c];if((h.width>=D||h.height>=x)&&f(h,s[c+1])){d=c;break}}return d},N(b,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var s=1;if(!this.hls.config.ignoreDevicePixelRatio)try{s=self.devicePixelRatio}catch{}return s}}]),b}();const R=F},"./src/controller/cmcd-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>x});var w=o("./src/events.ts"),A=o("./src/types/cmcd.ts"),N=o("./src/utils/buffer-helper.ts"),O=o("./src/utils/logger.ts");function B(f,d){for(var c=0;c<d.length;c++){var h=d[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(f,R(h.key),h)}}function F(f,d,c){return d&&B(f.prototype,d),c&&B(f,c),Object.defineProperty(f,"prototype",{writable:!1}),f}function R(f){var d=b(f,"string");return typeof d=="symbol"?d:String(d)}function b(f,d){if(typeof f!="object"||f===null)return f;var c=f[Symbol.toPrimitive];if(c!==void 0){var h=c.call(f,d||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(f)}function S(f,d){var c=typeof Symbol<"u"&&f[Symbol.iterator]||f["@@iterator"];if(c)return(c=c.call(f)).next.bind(c);if(Array.isArray(f)||(c=y(f))||d&&f&&typeof f.length=="number"){c&&(f=c);var h=0;return function(){return h>=f.length?{done:!0}:{done:!1,value:f[h++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y(f,d){if(f){if(typeof f=="string")return s(f,d);var c=Object.prototype.toString.call(f).slice(8,-1);if(c==="Object"&&f.constructor&&(c=f.constructor.name),c==="Map"||c==="Set")return Array.from(f);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return s(f,d)}}function s(f,d){(d==null||d>f.length)&&(d=f.length);for(var c=0,h=new Array(d);c<d;c++)h[c]=f[c];return h}function D(){return D=Object.assign?Object.assign.bind():function(f){for(var d=1;d<arguments.length;d++){var c=arguments[d];for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(f[h]=c[h])}return f},D.apply(this,arguments)}var x=function(){function f(c){var h=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){h.initialized&&(h.starved=!0),h.buffering=!0},this.onPlaying=function(){h.initialized||(h.initialized=!0),h.buffering=!1},this.applyPlaylistData=function(v){try{h.apply(v,{ot:A.CMCDObjectType.MANIFEST,su:!h.initialized})}catch(T){O.logger.warn("Could not generate manifest CMCD data.",T)}},this.applyFragmentData=function(v){try{var T=v.frag,M=h.hls.levels[T.level],g=h.getObjectType(T),m={d:T.duration*1e3,ot:g};(g===A.CMCDObjectType.VIDEO||g===A.CMCDObjectType.AUDIO||g==A.CMCDObjectType.MUXED)&&(m.br=M.bitrate/1e3,m.tb=h.getTopBandwidth(g)/1e3,m.bl=h.getBufferLength(g)),h.apply(v,m)}catch(l){O.logger.warn("Could not generate segment CMCD data.",l)}},this.hls=c;var _=this.config=c.config,L=_.cmcd;L!=null&&(_.pLoader=this.createPlaylistLoader(),_.fLoader=this.createFragmentLoader(),this.sid=L.sessionId||f.uuid(),this.cid=L.contentId,this.useHeaders=L.useHeaders===!0,this.registerListeners())}var d=f.prototype;return d.registerListeners=function(){var h=this.hls;h.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.on(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),h.on(w.Events.BUFFER_CREATED,this.onBufferCreated,this)},d.unregisterListeners=function(){var h=this.hls;h.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.off(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),h.off(w.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},d.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},d.onMediaAttached=function(h,_){this.media=_.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},d.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},d.onBufferCreated=function(h,_){var L,v;this.audioBuffer=(L=_.tracks.audio)===null||L===void 0?void 0:L.buffer,this.videoBuffer=(v=_.tracks.video)===null||v===void 0?void 0:v.buffer},d.createData=function(){var h;return{v:A.CMCDVersion,sf:A.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(h=this.media)===null||h===void 0?void 0:h.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},d.apply=function(h,_){_===void 0&&(_={}),D(_,this.createData());var L=_.ot===A.CMCDObjectType.INIT||_.ot===A.CMCDObjectType.VIDEO||_.ot===A.CMCDObjectType.MUXED;if(this.starved&&L&&(_.bs=!0,_.su=!0,this.starved=!1),_.su==null&&(_.su=this.buffering),this.useHeaders){var v=f.toHeaders(_);if(!Object.keys(v).length)return;h.headers||(h.headers={}),D(h.headers,v)}else{var T=f.toQuery(_);if(!T)return;h.url=f.appendQueryToUri(h.url,T)}},d.getObjectType=function(h){var _=h.type;if(_==="subtitle")return A.CMCDObjectType.TIMED_TEXT;if(h.sn==="initSegment")return A.CMCDObjectType.INIT;if(_==="audio")return A.CMCDObjectType.AUDIO;if(_==="main")return this.hls.audioTracks.length?A.CMCDObjectType.VIDEO:A.CMCDObjectType.MUXED},d.getTopBandwidth=function(h){var _=0,L,v=this.hls;if(h===A.CMCDObjectType.AUDIO)L=v.audioTracks;else{var T=v.maxAutoLevel,M=T>-1?T+1:v.levels.length;L=v.levels.slice(0,M)}for(var g=S(L),m;!(m=g()).done;){var l=m.value;l.bitrate>_&&(_=l.bitrate)}return _>0?_:NaN},d.getBufferLength=function(h){var _=this.hls.media,L=h===A.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!L||!_)return NaN;var v=N.BufferHelper.bufferInfo(L,_.currentTime,this.config.maxBufferHole);return v.len*1e3},d.createPlaylistLoader=function(){var h=this.config.pLoader,_=this.applyPlaylistData,L=h||this.config.loader;return function(){function v(M){this.loader=void 0,this.loader=new L(M)}var T=v.prototype;return T.destroy=function(){this.loader.destroy()},T.abort=function(){this.loader.abort()},T.load=function(g,m,l){_(g),this.loader.load(g,m,l)},F(v,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),v}()},d.createFragmentLoader=function(){var h=this.config.fLoader,_=this.applyFragmentData,L=h||this.config.loader;return function(){function v(M){this.loader=void 0,this.loader=new L(M)}var T=v.prototype;return T.destroy=function(){this.loader.destroy()},T.abort=function(){this.loader.abort()},T.load=function(g,m,l){_(g),this.loader.load(g,m,l)},F(v,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),v}()},f.uuid=function(){var h=URL.createObjectURL(new Blob),_=h.toString();return URL.revokeObjectURL(h),_.slice(_.lastIndexOf("/")+1)},f.serialize=function(h){for(var _=[],L=function(W){return!Number.isNaN(W)&&W!=null&&W!==""&&W!==!1},v=function(W){return Math.round(W)},T=function(W){return v(W/100)*100},M=function(W){return encodeURIComponent(W)},g={br:v,d:v,bl:T,dl:T,mtp:T,nor:M,rtp:T,tb:v},m=Object.keys(h||{}).sort(),l=S(m),p;!(p=l()).done;){var a=p.value,E=h[a];if(L(E)&&!(a==="v"&&E===1)&&!(a=="pr"&&E===1)){var k=g[a];k&&(E=k(E));var P=typeof E,U=void 0;a==="ot"||a==="sf"||a==="st"?U=a+"="+E:P==="boolean"?U=a:P==="number"?U=a+"="+E:U=a+"="+JSON.stringify(E),_.push(U)}}return _.join(",")},f.toHeaders=function(h){for(var _=Object.keys(h),L={},v=["Object","Request","Session","Status"],T=[{},{},{},{}],M={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},g=0,m=_;g<m.length;g++){var l=m[g],p=M[l]!=null?M[l]:1;T[p][l]=h[l]}for(var a=0;a<T.length;a++){var E=f.serialize(T[a]);E&&(L["CMCD-"+v[a]]=E)}return L},f.toQuery=function(h){return"CMCD="+encodeURIComponent(f.serialize(h))},f.appendQueryToUri=function(h,_){if(!_)return h;var L=h.includes("?")?"&":"?";return""+h+L+_},f}()},"./src/controller/eme-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>g});var w=o("./src/events.ts"),A=o("./src/errors.ts"),N=o("./src/utils/logger.ts"),O=o("./src/utils/mediakeys-helper.ts"),B=o("./src/utils/keysystem-util.ts"),F=o("./src/utils/numeric-encoding-utils.ts"),R=o("./src/loader/level-key.ts"),b=o("./src/utils/hex.ts"),S=o("./src/utils/mp4-tools.ts"),y=o("./node_modules/eventemitter3/index.js"),s=o.n(y);function D(m,l){m.prototype=Object.create(l.prototype),m.prototype.constructor=m,h(m,l)}function x(m){var l=typeof Map=="function"?new Map:void 0;return x=function(a){if(a===null||!c(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l<"u"){if(l.has(a))return l.get(a);l.set(a,E)}function E(){return f(a,arguments,_(this).constructor)}return E.prototype=Object.create(a.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),h(E,a)},x(m)}function f(m,l,p){return d()?f=Reflect.construct.bind():f=function(E,k,P){var U=[null];U.push.apply(U,k);var K=Function.bind.apply(E,U),W=new K;return P&&h(W,P.prototype),W},f.apply(null,arguments)}function d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c(m){return Function.toString.call(m).indexOf("[native code]")!==-1}function h(m,l){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,E){return a.__proto__=E,a},h(m,l)}function _(m){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},_(m)}var L=3,v="[eme]",T=function(){function m(p){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=m.CDMCleanupPromise?[m.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=N.logger.debug.bind(N.logger,v),this.log=N.logger.log.bind(N.logger,v),this.warn=N.logger.warn.bind(N.logger,v),this.error=N.logger.error.bind(N.logger,v),this.hls=p,this.config=p.config,this.registerListeners()}var l=m.prototype;return l.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},l.registerListeners=function(){this.hls.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(w.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},l.unregisterListeners=function(){this.hls.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(w.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(w.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},l.getLicenseServerUrl=function(a){var E=this.config,k=E.drmSystems,P=E.widevineLicenseUrl,U=k[a];if(U)return U.licenseUrl;if(a===O.KeySystems.WIDEVINE&&P)return P;throw new Error('no license server URL configured for key-system "'+a+'"')},l.getServerCertificateUrl=function(a){var E=this.config.drmSystems,k=E[a];if(k)return k.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+a+'"]')},l.attemptKeySystemAccess=function(a){var E=this,k=this.hls.levels,P=function(G,j,H){return!!G&&H.indexOf(G)===j},U=k.map(function(W){return W.audioCodec}).filter(P),K=k.map(function(W){return W.videoCodec}).filter(P);return U.length+K.length===0&&K.push("avc1.42e01e"),new Promise(function(W,G){var j=function H(V){var z=V.shift();E.getMediaKeysPromise(z,U,K).then(function($){return W({keySystem:z,mediaKeys:$})}).catch(function($){V.length?H(V):$ instanceof M?G($):G(new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:$,fatal:!0},$.message))})};j(a)})},l.requestMediaKeySystemAccess=function(a,E){var k=this.config.requestMediaKeySystemAccessFunc;if(typeof k!="function"){var P="Configured requestMediaKeySystemAccess is not a function "+k;return O.requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(P="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(P))}return k(a,E)},l.getMediaKeysPromise=function(a,E,k){var P=this,U=(0,O.getSupportedMediaKeySystemConfigurations)(a,E,k,this.config.drmSystemOptions),K=this.keySystemAccessPromises[a],W=K==null?void 0:K.keySystemAccess;if(!W){this.log('Requesting encrypted media "'+a+'" key-system access with config: '+JSON.stringify(U)),W=this.requestMediaKeySystemAccess(a,U);var G=this.keySystemAccessPromises[a]={keySystemAccess:W};return W.catch(function(j){P.log('Failed to obtain access to key-system "'+a+'": '+j)}),W.then(function(j){P.log('Access for key-system "'+j.keySystem+'" obtained');var H=P.fetchServerCertificate(a);return P.log('Create media-keys for "'+a+'"'),G.mediaKeys=j.createMediaKeys().then(function(V){return P.log('Media-keys created for "'+a+'"'),H.then(function(z){return z?P.setMediaKeysServerCertificate(V,a,z):V})}),G.mediaKeys.catch(function(V){P.error('Failed to create media-keys for "'+a+'"}: '+V)}),G.mediaKeys})}return W.then(function(){return K.mediaKeys})},l.createMediaKeySessionContext=function(a){var E=a.decryptdata,k=a.keySystem,P=a.mediaKeys;console.assert(!!P,"mediaKeys is defined"),this.log('Creating key-system session "'+k+'" keyId: '+b.default.hexDump(E.keyId||[]));var U=P.createSession(),K={decryptdata:E,keySystem:k,mediaKeys:P,mediaKeysSession:U,keyStatus:"status-pending"};return this.mediaKeySessions.push(K),K},l.renewKeySession=function(a){var E=a.decryptdata;if(E.pssh){var k=this.createMediaKeySessionContext(a),P=this.getKeyIdString(E),U="cenc";this.keyIdToKeySessionPromise[P]=this.generateRequestWithPreferredKeySession(k,U,E.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(a)},l.getKeyIdString=function(a){if(!a)throw new Error("Could not read keyId of undefined decryptdata");if(a.keyId===null)throw new Error("keyId is null");return b.default.hexDump(a.keyId)},l.updateKeySession=function(a,E){var k,P=a.mediaKeysSession;return this.log('Updating key-session "'+P.sessionId+'" for keyID '+b.default.hexDump(((k=a.decryptdata)===null||k===void 0?void 0:k.keyId)||[])+`
      } (data length: `+(E&&E.byteLength)+")"),P.update(E)},l.selectKeySystemFormat=function(a){var E=Object.keys(a.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+a.sn+" "+a.type+": "+a.level+") key formats "+E.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(E)),this.keyFormatPromise},l.getKeyFormatPromise=function(a){var E=this;return new Promise(function(k,P){var U=(0,O.getKeySystemsForConfig)(E.config),K=a.map(O.keySystemFormatToKeySystemDomain).filter(function(W){return!!W&&U.indexOf(W)!==-1});return E.getKeySystemSelectionPromise(K).then(function(W){var G=W.keySystem,j=(0,O.keySystemDomainToKeySystemFormat)(G);j?k(j):P(new Error('Unable to find format for key-system "'+G+'"'))}).catch(P)})},l.loadKey=function(a){var E=this,k=a.keyInfo.decryptdata,P=this.getKeyIdString(k),U="(keyId: "+P+' format: "'+k.keyFormat+'" method: '+k.method+" uri: "+k.uri+")";this.log("Starting session for key "+U);var K=this.keyIdToKeySessionPromise[P];return K||(K=this.keyIdToKeySessionPromise[P]=this.getKeySystemForKeyPromise(k).then(function(W){var G=W.keySystem,j=W.mediaKeys;return E.throwIfDestroyed(),E.log("Handle encrypted media sn: "+a.frag.sn+" "+a.frag.type+": "+a.frag.level+" using key "+U),E.attemptSetMediaKeys(G,j).then(function(){E.throwIfDestroyed();var H=E.createMediaKeySessionContext({keySystem:G,mediaKeys:j,decryptdata:k}),V="cenc";return E.generateRequestWithPreferredKeySession(H,V,k.pssh,"playlist-key")})}),K.catch(function(W){return E.handleError(W)})),K},l.throwIfDestroyed=function(a){if(!this.hls)throw new Error("invalid state")},l.handleError=function(a){this.hls&&(this.error(a.message),a instanceof M?this.hls.trigger(w.Events.ERROR,a.data):this.hls.trigger(w.Events.ERROR,{type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:a,fatal:!0}))},l.getKeySystemForKeyPromise=function(a){var E=this.getKeyIdString(a),k=this.keyIdToKeySessionPromise[E];if(!k){var P=(0,O.keySystemFormatToKeySystemDomain)(a.keyFormat),U=P?[P]:(0,O.getKeySystemsForConfig)(this.config);return this.attemptKeySystemAccess(U)}return k},l.getKeySystemSelectionPromise=function(a){if(a.length||(a=(0,O.getKeySystemsForConfig)(this.config)),a.length===0)throw new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(a)},l._onMediaEncrypted=function(a){var E=this,k=a.initDataType,P=a.initData;if(this.debug('"'+a.type+'" event: init data type: "'+k+'"'),P!==null){var U,K;if(k==="sinf"&&this.config.drmSystems[O.KeySystems.FAIRPLAY]){var W=(0,S.bin2str)(new Uint8Array(P));try{var G=(0,F.base64Decode)(JSON.parse(W).sinf),j=(0,S.parseSinf)(new Uint8Array(G));if(!j)return;U=j.subarray(8,24),K=O.KeySystems.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{var H=(0,S.parsePssh)(P);if(H===null)return;H.version===0&&H.systemId===O.KeySystemIds.WIDEVINE&&H.data&&(U=H.data.subarray(8,24)),K=(0,O.keySystemIdToKeySystemDomain)(H.systemId)}if(!(!K||!U)){for(var V=b.default.hexDump(U),z=this.keyIdToKeySessionPromise,$=this.mediaKeySessions,Y=z[V],X=function(re){var se=$[re],ie=se.decryptdata;if(ie.pssh||!ie.keyId)return"continue";var q=b.default.hexDump(ie.keyId);if(V===q||ie.uri.replace(/-/g,"").indexOf(V)!==-1)return Y=z[q],delete z[q],ie.pssh=new Uint8Array(P),ie.keyId=U,Y=z[V]=Y.then(function(){return E.generateRequestWithPreferredKeySession(se,k,P,"encrypted-event-key-match")}),"break"},Z=0;Z<$.length;Z++){var Q=X(Z);if(Q!=="continue"&&Q==="break")break}Y||(Y=z[V]=this.getKeySystemSelectionPromise([K]).then(function(J){var re,se=J.keySystem,ie=J.mediaKeys;E.throwIfDestroyed();var q=new R.LevelKey("ISO-23001-7",V,(re=(0,O.keySystemDomainToKeySystemFormat)(se))!=null?re:"");return q.pssh=new Uint8Array(P),q.keyId=U,E.attemptSetMediaKeys(se,ie).then(function(){E.throwIfDestroyed();var oe=E.createMediaKeySessionContext({decryptdata:q,keySystem:se,mediaKeys:ie});return E.generateRequestWithPreferredKeySession(oe,k,P,"encrypted-event-no-match")})})),Y.catch(function(J){return E.handleError(J)})}}},l._onWaitingForKey=function(a){this.log('"'+a.type+'" event')},l.attemptSetMediaKeys=function(a,E){var k=this,P=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+a+'"');var U=Promise.all(P).then(function(){if(!k.media)throw new Error("Attempted to set mediaKeys without media element attached");return k.media.setMediaKeys(E)});return this.setMediaKeysQueue.push(U),U.then(function(){k.log('Media-keys set for "'+a+'"'),P.push(U),k.setMediaKeysQueue=k.setMediaKeysQueue.filter(function(K){return P.indexOf(K)===-1})})},l.generateRequestWithPreferredKeySession=function(a,E,k,P){var U,K,W=this,G=(U=this.config.drmSystems)===null||U===void 0||(K=U[a.keySystem])===null||K===void 0?void 0:K.generateRequest;if(G)try{var j=G.call(this.hls,E,k,a);if(!j)throw new Error("Invalid response from configured generateRequest filter");E=j.initDataType,k=a.decryptdata.pssh=j.initData?new Uint8Array(j.initData):null}catch(Y){var H;if(this.warn(Y.message),(H=this.hls)!==null&&H!==void 0&&H.config.debug)throw Y}if(k===null)return this.log('Skipping key-session request for "'+P+'" (no initData)'),Promise.resolve(a);var V=this.getKeyIdString(a.decryptdata);this.log('Generating key-session request for "'+P+'": '+V+" (init data type: "+E+" length: "+(k?k.byteLength:null)+")");var z=new(s());a.mediaKeysSession.onmessage=function(Y){var X=a.mediaKeysSession;if(!X){z.emit("error",new Error("invalid state"));return}var Z=Y.messageType,Q=Y.message;W.log('"'+Z+'" message event for session "'+X.sessionId+'" message size: '+Q.byteLength),Z==="license-request"||Z==="license-renewal"?W.renewLicense(a,Q).catch(function(J){W.handleError(J),z.emit("error",J)}):Z==="license-release"?a.keySystem===O.KeySystems.FAIRPLAY&&(W.updateKeySession(a,(0,B.strToUtf8array)("acknowledged")),W.removeSession(a)):W.warn('unhandled media key message type "'+Z+'"')},a.mediaKeysSession.onkeystatuseschange=function(Y){var X=a.mediaKeysSession;if(!X){z.emit("error",new Error("invalid state"));return}W.onKeyStatusChange(a);var Z=a.keyStatus;z.emit("keyStatus",Z),Z==="expired"&&(W.warn(a.keySystem+" expired for key "+V),W.renewKeySession(a))};var $=new Promise(function(Y,X){z.on("error",X),z.on("keyStatus",function(Z){Z.startsWith("usable")?Y():Z==="output-restricted"?X(new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):Z==="internal-error"?X(new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+Z+'"')):Z==="expired"?X(new Error("key expired while generating request")):W.warn('unhandled key status change "'+Z+'"')})});return a.mediaKeysSession.generateRequest(E,k).then(function(){var Y;W.log('Request generated for key-session "'+((Y=a.mediaKeysSession)===null||Y===void 0?void 0:Y.sessionId)+'" keyId: '+V)}).catch(function(Y){throw new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:Y,fatal:!1},"Error generating key-session request: "+Y)}).then(function(){return $}).catch(function(Y){throw z.removeAllListeners(),W.removeSession(a),Y}).then(function(){return z.removeAllListeners(),a})},l.onKeyStatusChange=function(a){var E=this;a.mediaKeysSession.keyStatuses.forEach(function(k,P){E.log('key status change "'+k+'" for keyStatuses keyId: '+b.default.hexDump("buffer"in P?new Uint8Array(P.buffer,P.byteOffset,P.byteLength):new Uint8Array(P))+" session keyId: "+b.default.hexDump(new Uint8Array(a.decryptdata.keyId||[]))+" uri: "+a.decryptdata.uri),a.keyStatus=k})},l.fetchServerCertificate=function(a){var E=this;return new Promise(function(k,P){var U=E.getServerCertificateUrl(a);if(!U)return k();E.log('Fetching serverCertificate for "'+a+'"');var K=new XMLHttpRequest;K.open("GET",U,!0),K.responseType="arraybuffer",K.onreadystatechange=function(){K.readyState===XMLHttpRequest.DONE&&(K.status===200?k(K.response):P(new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:K},'"'+a+'" certificate request XHR failed ('+U+"). Status: "+K.status+" ("+K.statusText+")")))},K.send()})},l.setMediaKeysServerCertificate=function(a,E,k){var P=this;return new Promise(function(U,K){a.setServerCertificate(k).then(function(W){P.log("setServerCertificate "+(W?"success":"not supported by CDM")+" ("+(k==null?void 0:k.byteLength)+') on "'+E+'"'),U(a)}).catch(function(W){K(new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:W,fatal:!0},W.message))})})},l.renewLicense=function(a,E){var k=this;return this.requestLicense(a,new Uint8Array(E)).then(function(P){return k.updateKeySession(a,new Uint8Array(P)).catch(function(U){throw new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:U,fatal:!0},U.message)})})},l.setupLicenseXHR=function(a,E,k,P){var U=this,K=this.config.licenseXhrSetup;return K?Promise.resolve().then(function(){if(!k.decryptdata)throw new Error("Key removed");return K.call(U.hls,a,E,k,P)}).catch(function(W){if(!k.decryptdata)throw W;return a.open("POST",E,!0),K.call(U.hls,a,E,k,P)}).then(function(W){a.readyState||a.open("POST",E,!0);var G=W||P;return{xhr:a,licenseChallenge:G}}):(a.open("POST",E,!0),Promise.resolve({xhr:a,licenseChallenge:P}))},l.requestLicense=function(a,E){var k=this;return new Promise(function(P,U){var K=k.getLicenseServerUrl(a.keySystem);k.log("Sending license request to URL: "+K);var W=new XMLHttpRequest;W.responseType="arraybuffer",W.onreadystatechange=function(){if(!k.hls||!a.mediaKeysSession)return U(new Error("invalid state"));if(W.readyState===4)if(W.status===200){k._requestLicenseFailureCount=0;var G=W.response;k.log("License received "+(G instanceof ArrayBuffer?G.byteLength:G));var j=k.config.licenseResponseCallback;if(j)try{G=j.call(k.hls,W,K,a)}catch(V){k.error(V)}P(G)}else if(k._requestLicenseFailureCount++,k._requestLicenseFailureCount>L||W.status>=400&&W.status<500)U(new M({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:W},"License Request XHR failed ("+K+"). Status: "+W.status+" ("+W.statusText+")"));else{var H=L-k._requestLicenseFailureCount+1;k.warn("Retrying license request, "+H+" attempts left"),k.requestLicense(a,E).then(P,U)}},a.licenseXhr&&a.licenseXhr.readyState!==XMLHttpRequest.DONE&&a.licenseXhr.abort(),a.licenseXhr=W,k.setupLicenseXHR(W,K,a,E).then(function(G){var j=G.xhr,H=G.licenseChallenge;j.send(H)})})},l.onMediaAttached=function(a,E){if(this.config.emeEnabled){var k=E.media;this.media=k,k.addEventListener("encrypted",this.onMediaEncrypted),k.addEventListener("waitingforkey",this.onWaitingForKey)}},l.onMediaDetached=function(){var a=this,E=this.media,k=this.mediaKeySessions;E&&(E.removeEventListener("encrypted",this.onMediaEncrypted),E.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},R.LevelKey.clearKeyUriToKeyIdMap();var P=k.length;m.CDMCleanupPromise=Promise.all(k.map(function(U){return a.removeSession(U)}).concat(E==null?void 0:E.setMediaKeys(null).catch(function(U){a.log("Could not clear media keys: "+U+". media.src: "+(E==null?void 0:E.src))}))).then(function(){P&&(a.log("finished closing key sessions and clearing media keys"),k.length=0)}).catch(function(U){a.log("Could not close sessions and clear media keys: "+U+". media.src: "+(E==null?void 0:E.src))})},l.onManifestLoaded=function(a,E){var k=E.sessionKeys;if(!(!k||!this.config.emeEnabled)&&!this.keyFormatPromise){var P=k.reduce(function(U,K){return U.indexOf(K.keyFormat)===-1&&U.push(K.keyFormat),U},[]);this.log("Selecting key-system from session-keys "+P.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(P)}},l.removeSession=function(a){var E=this,k=a.mediaKeysSession,P=a.licenseXhr;if(k){this.log("Remove licenses and keys and close session "+k.sessionId),k.onmessage=null,k.onkeystatuseschange=null,P&&P.readyState!==XMLHttpRequest.DONE&&P.abort(),a.mediaKeysSession=a.decryptdata=a.licenseXhr=void 0;var U=this.mediaKeySessions.indexOf(a);return U>-1&&this.mediaKeySessions.splice(U,1),k.remove().catch(function(K){E.log("Could not remove session: "+K)}).then(function(){return k.close()}).catch(function(K){E.log("Could not close session: "+K)})}},m}();T.CDMCleanupPromise=void 0;var M=function(m){D(l,m);function l(p,a){var E;return E=m.call(this,a)||this,E.data=void 0,E.data=p,p.err=p.error,E}return l}(x(Error));const g=T},"./src/controller/fps-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>O});var w=o("./src/events.ts"),A=o("./src/utils/logger.ts"),N=function(){function B(R){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=R,this.registerListeners()}var F=B.prototype;return F.setStreamController=function(b){this.streamController=b},F.registerListeners=function(){this.hls.on(w.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},F.unregisterListeners=function(){this.hls.off(w.Events.MEDIA_ATTACHING,this.onMediaAttaching)},F.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},F.onMediaAttaching=function(b,S){var y=this.hls.config;if(y.capLevelOnFPSDrop){var s=S.media instanceof self.HTMLVideoElement?S.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),y.fpsDroppedMonitoringPeriod)}},F.checkFPS=function(b,S,y){var s=performance.now();if(S){if(this.lastTime){var D=s-this.lastTime,x=y-this.lastDroppedFrames,f=S-this.lastDecodedFrames,d=1e3*x/D,c=this.hls;if(c.trigger(w.Events.FPS_DROP,{currentDropped:x,currentDecoded:f,totalDroppedFrames:y}),d>0&&x>c.config.fpsDroppedMonitoringThreshold*f){var h=c.currentLevel;A.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=h)&&(h=h-1,c.trigger(w.Events.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:c.currentLevel}),c.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=y,this.lastDecodedFrames=S}},F.checkFPSInterval=function(){var b=this.media;if(b)if(this.isVideoPlaybackQualityAvailable){var S=b.getVideoPlaybackQuality();this.checkFPS(b,S.totalVideoFrames,S.droppedVideoFrames)}else this.checkFPS(b,b.webkitDecodedFrameCount,b.webkitDroppedFrameCount)},B}();const O=N},"./src/controller/fragment-finders.ts":(C,I,o)=>{o.r(I),o.d(I,{findFragWithCC:()=>R,findFragmentByPDT:()=>N,findFragmentByPTS:()=>O,fragmentWithinToleranceTest:()=>B,pdtWithinToleranceTest:()=>F});var w=o("./src/polyfills/number.ts"),A=o("./src/utils/binary-search.ts");function N(b,S,y){if(S===null||!Array.isArray(b)||!b.length||!(0,w.isFiniteNumber)(S))return null;var s=b[0].programDateTime;if(S<(s||0))return null;var D=b[b.length-1].endProgramDateTime;if(S>=(D||0))return null;y=y||0;for(var x=0;x<b.length;++x){var f=b[x];if(F(S,y,f))return f}return null}function O(b,S,y,s){y===void 0&&(y=0),s===void 0&&(s=0);var D=null;if(b?D=S[b.sn-S[0].sn+1]||null:y===0&&S[0].start===0&&(D=S[0]),D&&B(y,s,D)===0)return D;var x=A.default.search(S,B.bind(null,y,s));return x&&(x!==b||!D)?x:D}function B(b,S,y){if(b===void 0&&(b=0),S===void 0&&(S=0),y.start<=b&&y.start+y.duration>b)return 0;var s=Math.min(S,y.duration+(y.deltaPTS?y.deltaPTS:0));return y.start+y.duration-s<=b?1:y.start-s>b&&y.start?-1:0}function F(b,S,y){var s=Math.min(S,y.duration+(y.deltaPTS?y.deltaPTS:0))*1e3,D=y.endProgramDateTime||0;return D-s>b}function R(b,S){return A.default.search(b,function(y){return y.cc<S?1:y.cc>S?-1:0})}},"./src/controller/fragment-tracker.ts":(C,I,o)=>{o.r(I),o.d(I,{FragmentState:()=>N,FragmentTracker:()=>O});var w=o("./src/events.ts"),A=o("./src/types/loader.ts"),N;(function(R){R.NOT_LOADED="NOT_LOADED",R.APPENDING="APPENDING",R.PARTIAL="PARTIAL",R.OK="OK"})(N||(N={}));var O=function(){function R(S){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=S,this._registerListeners()}var b=R.prototype;return b._registerListeners=function(){var y=this.hls;y.on(w.Events.BUFFER_APPENDED,this.onBufferAppended,this),y.on(w.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.on(w.Events.FRAG_LOADED,this.onFragLoaded,this)},b._unregisterListeners=function(){var y=this.hls;y.off(w.Events.BUFFER_APPENDED,this.onBufferAppended,this),y.off(w.Events.FRAG_BUFFERED,this.onFragBuffered,this),y.off(w.Events.FRAG_LOADED,this.onFragLoaded,this)},b.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},b.getAppendedFrag=function(y,s){if(s===A.PlaylistLevelType.MAIN){var D=this.activeFragment,x=this.activeParts;if(!D)return null;if(x)for(var f=x.length;f--;){var d=x[f],c=d?d.end:D.appendedPTS;if(d.start<=y&&c!==void 0&&y<=c)return f>9&&(this.activeParts=x.slice(f-9)),d}else if(D.start<=y&&D.appendedPTS!==void 0&&y<=D.appendedPTS)return D}return this.getBufferedFrag(y,s)},b.getBufferedFrag=function(y,s){for(var D=this.fragments,x=Object.keys(D),f=x.length;f--;){var d=D[x[f]];if((d==null?void 0:d.body.type)===s&&d.buffered){var c=d.body;if(c.start<=y&&y<=c.end)return c}}return null},b.detectEvictedFragments=function(y,s,D){var x=this;this.timeRanges&&(this.timeRanges[y]=s),Object.keys(this.fragments).forEach(function(f){var d=x.fragments[f];if(d){if(!d.buffered&&!d.loaded){d.body.type===D&&x.removeFragment(d.body);return}var c=d.range[y];c&&c.time.some(function(h){var _=!x.isTimeBuffered(h.startPTS,h.endPTS,s);return _&&x.removeFragment(d.body),_})}})},b.detectPartialFragments=function(y){var s=this,D=this.timeRanges,x=y.frag,f=y.part;if(!(!D||x.sn==="initSegment")){var d=F(x),c=this.fragments[d];c&&(Object.keys(D).forEach(function(h){var _=x.elementaryStreams[h];if(_){var L=D[h],v=f!==null||_.partial===!0;c.range[h]=s.getBufferedTimes(x,f,v,L)}}),c.loaded=null,Object.keys(c.range).length?(c.buffered=!0,c.body.endList&&(this.endListFragments[c.body.type]=c)):this.removeFragment(c.body))}},b.fragBuffered=function(y){var s=F(y),D=this.fragments[s];D&&(D.loaded=null,D.buffered=!0)},b.getBufferedTimes=function(y,s,D,x){for(var f={time:[],partial:D},d=s?s.start:y.start,c=s?s.end:y.end,h=y.minEndPTS||c,_=y.maxStartPTS||d,L=0;L<x.length;L++){var v=x.start(L)-this.bufferPadding,T=x.end(L)+this.bufferPadding;if(_>=v&&h<=T){f.time.push({startPTS:Math.max(d,x.start(L)),endPTS:Math.min(c,x.end(L))});break}else if(d<T&&c>v)f.partial=!0,f.time.push({startPTS:Math.max(d,x.start(L)),endPTS:Math.min(c,x.end(L))});else if(c<=v)break}return f},b.getPartialFragment=function(y){var s=null,D,x,f,d=0,c=this.bufferPadding,h=this.fragments;return Object.keys(h).forEach(function(_){var L=h[_];L&&B(L)&&(x=L.body.start-c,f=L.body.end+c,y>=x&&y<=f&&(D=Math.min(y-x,f-y),d<=D&&(s=L.body,d=D)))}),s},b.isEndListAppended=function(y){var s=this.endListFragments[y];return s!==void 0&&(s.buffered||B(s))},b.getState=function(y){var s=F(y),D=this.fragments[s];return D?D.buffered?B(D)?N.PARTIAL:N.OK:N.APPENDING:N.NOT_LOADED},b.isTimeBuffered=function(y,s,D){for(var x,f,d=0;d<D.length;d++){if(x=D.start(d)-this.bufferPadding,f=D.end(d)+this.bufferPadding,y>=x&&s<=f)return!0;if(s<=x)return!1}return!1},b.onFragLoaded=function(y,s){var D=s.frag,x=s.part;if(!(D.sn==="initSegment"||D.bitrateTest||x)){var f=F(D);this.fragments[f]={body:D,loaded:s,buffered:!1,range:Object.create(null)}}},b.onBufferAppended=function(y,s){var D=this,x=s.frag,f=s.part,d=s.timeRanges;if(x.type===A.PlaylistLevelType.MAIN)if(this.activeFragment!==x&&(this.activeFragment=x,x.appendedPTS=void 0),f){var c=this.activeParts;c||(this.activeParts=c=[]),c.push(f)}else this.activeParts=null;this.timeRanges=d,Object.keys(d).forEach(function(h){var _=d[h];if(D.detectEvictedFragments(h,_),!f&&x.type===A.PlaylistLevelType.MAIN){var L=x.elementaryStreams[h];if(!L)return;for(var v=0;v<_.length;v++){var T=_.end(v);T<=L.endPTS&&T>L.startPTS?x.appendedPTS=Math.max(T,x.appendedPTS||0):x.appendedPTS=L.endPTS}}})},b.onFragBuffered=function(y,s){this.detectPartialFragments(s)},b.hasFragment=function(y){var s=F(y);return!!this.fragments[s]},b.removeFragmentsInRange=function(y,s,D){var x=this;Object.keys(this.fragments).forEach(function(f){var d=x.fragments[f];if(d&&d.buffered){var c=d.body;c.type===D&&c.start<s&&c.end>y&&x.removeFragment(c)}})},b.removeFragment=function(y){var s=F(y);y.stats.loaded=0,y.clearElementaryStreamInfo(),y.appendedPTS=void 0,delete this.fragments[s],y.endList&&delete this.endListFragments[y.type]},b.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},R}();function B(R){var b,S;return R.buffered&&(((b=R.range.video)===null||b===void 0?void 0:b.partial)||((S=R.range.audio)===null||S===void 0?void 0:S.partial))}function F(R){return R.type+"_"+R.level+"_"+R.urlId+"_"+R.sn}},"./src/controller/gap-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{MAX_START_GAP_JUMP:()=>F,SKIP_BUFFER_HOLE_STEP_SECONDS:()=>R,SKIP_BUFFER_RANGE_START:()=>b,STALL_MINIMUM_DURATION_MS:()=>B,default:()=>S});var w=o("./src/utils/buffer-helper.ts"),A=o("./src/errors.ts"),N=o("./src/events.ts"),O=o("./src/utils/logger.ts"),B=250,F=2,R=.1,b=.05,S=function(){function y(D,x,f,d){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=D,this.media=x,this.fragmentTracker=f,this.hls=d}var s=y.prototype;return s.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},s.poll=function(x,f){var d=this.config,c=this.media,h=this.stalled;if(c!==null){var _=c.currentTime,L=c.seeking,v=this.seeking&&!L,T=!this.seeking&&L;if(this.seeking=L,_!==x){if(this.moved=!0,h!==null){if(this.stallReported){var M=self.performance.now()-h;O.logger.warn("playback not stuck anymore @"+_+", after "+Math.round(M)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((T||v)&&(this.stalled=null),!(c.paused&&!L||c.ended||c.playbackRate===0||!w.BufferHelper.getBuffered(c).length)){var g=w.BufferHelper.bufferInfo(c,_,0),m=g.len>0,l=g.nextStart||0;if(!(!m&&!l)){if(L){var p=g.len>F,a=!l||f&&f.start<=_||l-_>F&&!this.fragmentTracker.getPartialFragment(_);if(p||a)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var E,k=Math.max(l,g.start||0)-_,P=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,U=P==null||(E=P.details)===null||E===void 0?void 0:E.live,K=U?P.details.targetduration*2:F;if(k>0&&k<=K){this._trySkipBufferHole(null);return}}var W=self.performance.now();if(h===null){this.stalled=W;return}var G=W-h;if(!(!L&&G>=B&&(this._reportStall(g),!this.media))){var j=w.BufferHelper.bufferInfo(c,_,d.maxBufferHole);this._tryFixBufferStall(j,G)}}}}},s._tryFixBufferStall=function(x,f){var d=this.config,c=this.fragmentTracker,h=this.media;if(h!==null){var _=h.currentTime,L=c.getPartialFragment(_);if(L){var v=this._trySkipBufferHole(L);if(v||!this.media)return}x.len>d.maxBufferHole&&f>d.highBufferWatchdogPeriod*1e3&&(O.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},s._reportStall=function(x){var f=this.hls,d=this.media,c=this.stallReported;!c&&d&&(this.stallReported=!0,O.logger.warn("Playback stalling at @"+d.currentTime+" due to low buffer ("+JSON.stringify(x)+")"),f.trigger(N.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:x.len}))},s._trySkipBufferHole=function(x){var f=this.config,d=this.hls,c=this.media;if(c===null)return 0;for(var h=c.currentTime,_=0,L=w.BufferHelper.getBuffered(c),v=0;v<L.length;v++){var T=L.start(v);if(h+f.maxBufferHole>=_&&h<T){var M=Math.max(T+b,c.currentTime+R);return O.logger.warn("skipping hole, adjusting currentTime from "+h+" to "+M),this.moved=!0,this.stalled=null,c.currentTime=M,x&&d.trigger(N.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+h+" to "+M,frag:x}),M}_=L.end(v)}return 0},s._tryNudgeBuffer=function(){var x=this.config,f=this.hls,d=this.media,c=this.nudgeRetry;if(d!==null){var h=d.currentTime;if(this.nudgeRetry++,c<x.nudgeMaxRetry){var _=h+(c+1)*x.nudgeOffset;O.logger.warn("Nudging 'currentTime' from "+h+" to "+_),d.currentTime=_,f.trigger(N.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else O.logger.error("Playhead still not moving while enough data buffered @"+h+" after "+x.nudgeMaxRetry+" nudges"),f.trigger(N.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},y}()},"./src/controller/id3-track-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>x});var w=o("./src/polyfills/number.ts"),A=o("./src/events.ts"),N=o("./src/utils/texttrack-utils.ts"),O=o("./src/demux/id3.ts"),B=o("./src/loader/date-range.ts"),F=o("./src/types/demuxer.ts"),R=.25;function b(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var S=function(){var f=b();try{new f(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function y(f,d){return f.getTime()/1e3-d}function s(f){return Uint8Array.from(f.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var D=function(){function f(c){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=c,this._registerListeners()}var d=f.prototype;return d.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},d._registerListeners=function(){var h=this.hls;h.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.on(A.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),h.on(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),h.on(A.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},d._unregisterListeners=function(){var h=this.hls;h.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),h.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.off(A.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),h.off(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),h.off(A.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},d.onMediaAttached=function(h,_){this.media=_.media},d.onMediaDetaching=function(){this.id3Track&&((0,N.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},d.onManifestLoading=function(){this.dateRangeCuesAppended={}},d.createTrack=function(h){var _=this.getID3Track(h.textTracks);return _.mode="hidden",_},d.getID3Track=function(h){if(this.media){for(var _=0;_<h.length;_++){var L=h[_];if(L.kind==="metadata"&&L.label==="id3")return(0,N.sendAddTrackEvent)(L,this.media),L}return this.media.addTextTrack("metadata","id3")}},d.onFragParsingMetadata=function(h,_){if(this.media){var L=this.hls.config,v=L.enableEmsgMetadataCues,T=L.enableID3MetadataCues;if(!(!v&&!T)){var M=_.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var g=b(),m=0;m<M.length;m++){var l=M[m].type;if(!(l===F.MetadataSchema.emsg&&!v||!T)){var p=O.getID3Frames(M[m].data);if(p){var a=M[m].pts,E=a+M[m].duration;E>S&&(E=S);var k=E-a;k<=0&&(E=a+R);for(var P=0;P<p.length;P++){var U=p[P];if(!O.isTimeStampFrame(U)){this.updateId3CueEnds(a);var K=new g(a,E,"");K.value=U,l&&(K.type=l),this.id3Track.addCue(K)}}}}}}}},d.updateId3CueEnds=function(h){var _,L=(_=this.id3Track)===null||_===void 0?void 0:_.cues;if(L)for(var v=L.length;v--;){var T=L[v];T.startTime<h&&T.endTime===S&&(T.endTime=h)}},d.onBufferFlushing=function(h,_){var L=_.startOffset,v=_.endOffset,T=_.type,M=this.id3Track,g=this.hls;if(g){var m=g.config,l=m.enableEmsgMetadataCues,p=m.enableID3MetadataCues;if(M&&(l||p)){var a;T==="audio"?a=function(k){return k.type===F.MetadataSchema.audioId3&&p}:T==="video"?a=function(k){return k.type===F.MetadataSchema.emsg&&l}:a=function(k){return k.type===F.MetadataSchema.audioId3&&p||k.type===F.MetadataSchema.emsg&&l},(0,N.removeCuesInRange)(M,L,v,a)}}},d.onLevelUpdated=function(h,_){var L=this,v=_.details;if(!(!this.media||!v.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var T=this.dateRangeCuesAppended,M=this.id3Track,g=v.dateRanges,m=Object.keys(g);if(M)for(var l=Object.keys(T).filter(function(W){return!m.includes(W)}),p=function(G){var j=l[G];Object.keys(T[j].cues).forEach(function(H){M.removeCue(T[j].cues[H])}),delete T[j]},a=l.length;a--;)p(a);var E=v.fragments[v.fragments.length-1];if(!(m.length===0||!(0,w.isFiniteNumber)(E==null?void 0:E.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var k=E.programDateTime/1e3-E.start,P=b(),U=function(G){var j=m[G],H=g[j],V=T[j],z=(V==null?void 0:V.cues)||{},$=(V==null?void 0:V.durationKnown)||!1,Y=y(H.startDate,k),X=S,Z=H.endDate;if(Z)X=y(Z,k),$=!0;else if(H.endOnNext&&!$){var Q=m.reduce(function(oe,le){var fe=g[le];return fe.class===H.class&&fe.id!==le&&fe.startDate>H.startDate&&oe.push(fe),oe},[]).sort(function(oe,le){return oe.startDate.getTime()-le.startDate.getTime()})[0];Q&&(X=y(Q.startDate,k),$=!0)}for(var J=Object.keys(H.attr),re=0;re<J.length;re++){var se=J[re];if(!(se===B.DateRangeAttribute.ID||se===B.DateRangeAttribute.CLASS||se===B.DateRangeAttribute.START_DATE||se===B.DateRangeAttribute.DURATION||se===B.DateRangeAttribute.END_DATE||se===B.DateRangeAttribute.END_ON_NEXT)){var ie=z[se];if(ie)$&&!V.durationKnown&&(ie.endTime=X);else{var q=H.attr[se];ie=new P(Y,X,""),(se===B.DateRangeAttribute.SCTE35_OUT||se===B.DateRangeAttribute.SCTE35_IN)&&(q=s(q)),ie.value={key:se,data:q},ie.type=F.MetadataSchema.dateRange,L.id3Track.addCue(ie),z[se]=ie}}}T[j]={cues:z,dateRange:H,durationKnown:$}},K=0;K<m.length;K++)U(K)}}},f}();const x=D},"./src/controller/latency-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>b});var w=o("./src/errors.ts"),A=o("./src/events.ts"),N=o("./src/utils/logger.ts");function O(S,y){for(var s=0;s<y.length;s++){var D=y[s];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(S,F(D.key),D)}}function B(S,y,s){return y&&O(S.prototype,y),s&&O(S,s),Object.defineProperty(S,"prototype",{writable:!1}),S}function F(S){var y=R(S,"string");return typeof y=="symbol"?y:String(y)}function R(S,y){if(typeof S!="object"||S===null)return S;var s=S[Symbol.toPrimitive];if(s!==void 0){var D=s.call(S,y||"default");if(typeof D!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(y==="string"?String:Number)(S)}var b=function(){function S(s){var D=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return D.timeupdate()},this.hls=s,this.config=s.config,this.registerListeners()}var y=S.prototype;return y.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},y.registerListeners=function(){this.hls.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(A.Events.ERROR,this.onError,this)},y.unregisterListeners=function(){this.hls.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(A.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(A.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(A.Events.ERROR,this.onError)},y.onMediaAttached=function(D,x){this.media=x.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},y.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},y.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},y.onLevelUpdated=function(D,x){var f=x.details;this.levelDetails=f,f.advanced&&this.timeupdate(),!f.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},y.onError=function(D,x){x.details===w.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,N.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},y.timeupdate=function(){var D=this.media,x=this.levelDetails;if(!(!D||!x)){this.currentTime=D.currentTime;var f=this.computeLatency();if(f!==null){this._latency=f;var d=this.config,c=d.lowLatencyMode,h=d.maxLiveSyncPlaybackRate;if(!(!c||h===1)){var _=this.targetLatency;if(_!==null){var L=f-_,v=Math.min(this.maxLatency,_+x.targetduration),T=L<v;if(x.live&&T&&L>.05&&this.forwardBufferLength>1){var M=Math.min(2,Math.max(1,h)),g=Math.round(2/(1+Math.exp(-.75*L-this.edgeStalled))*20)/20;D.playbackRate=Math.min(M,Math.max(1,g))}else D.playbackRate!==1&&D.playbackRate!==0&&(D.playbackRate=1)}}}}},y.estimateLiveEdge=function(){var D=this.levelDetails;return D===null?null:D.edge+D.age},y.computeLatency=function(){var D=this.estimateLiveEdge();return D===null?null:D-this.currentTime},B(S,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var D=this.config,x=this.levelDetails;return D.liveMaxLatencyDuration!==void 0?D.liveMaxLatencyDuration:x?D.liveMaxLatencyDurationCount*x.targetduration:0}},{key:"targetLatency",get:function(){var D=this.levelDetails;if(D===null)return null;var x=D.holdBack,f=D.partHoldBack,d=D.targetduration,c=this.config,h=c.liveSyncDuration,_=c.liveSyncDurationCount,L=c.lowLatencyMode,v=this.hls.userConfig,T=L&&f||x;(v.liveSyncDuration||v.liveSyncDurationCount||T===0)&&(T=h!==void 0?h:_*d);var M=d,g=1;return T+Math.min(this.stallCount*g,M)}},{key:"liveSyncPosition",get:function(){var D=this.estimateLiveEdge(),x=this.targetLatency,f=this.levelDetails;if(D===null||x===null||f===null)return null;var d=f.edge,c=D-x-this.edgeStalled,h=d-f.totalduration,_=d-(this.config.lowLatencyMode&&f.partTarget||f.targetduration);return Math.min(Math.max(h,c),_)}},{key:"drift",get:function(){var D=this.levelDetails;return D===null?1:D.drift}},{key:"edgeStalled",get:function(){var D=this.levelDetails;if(D===null)return 0;var x=(this.config.lowLatencyMode&&D.partTarget||D.targetduration)*3;return Math.max(D.age-x,0)}},{key:"forwardBufferLength",get:function(){var D=this.media,x=this.levelDetails;if(!D||!x)return 0;var f=D.buffered.length;return(f?D.buffered.end(f-1):x.edge)-this.currentTime}}]),S}()},"./src/controller/level-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>c});var w=o("./src/types/level.ts"),A=o("./src/events.ts"),N=o("./src/errors.ts"),O=o("./src/utils/codecs.ts"),B=o("./src/controller/level-helper.ts"),F=o("./src/controller/base-playlist-controller.ts"),R=o("./src/types/loader.ts");function b(){return b=Object.assign?Object.assign.bind():function(h){for(var _=1;_<arguments.length;_++){var L=arguments[_];for(var v in L)Object.prototype.hasOwnProperty.call(L,v)&&(h[v]=L[v])}return h},b.apply(this,arguments)}function S(h,_){for(var L=0;L<_.length;L++){var v=_[L];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(h,s(v.key),v)}}function y(h,_,L){return _&&S(h.prototype,_),L&&S(h,L),Object.defineProperty(h,"prototype",{writable:!1}),h}function s(h){var _=D(h,"string");return typeof _=="symbol"?_:String(_)}function D(h,_){if(typeof h!="object"||h===null)return h;var L=h[Symbol.toPrimitive];if(L!==void 0){var v=L.call(h,_||"default");if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(h)}function x(h,_){h.prototype=Object.create(_.prototype),h.prototype.constructor=h,f(h,_)}function f(h,_){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,T){return v.__proto__=T,v},f(h,_)}var d=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(h){x(_,h);function _(v){var T;return T=h.call(this,v,"[level-controller]")||this,T._levels=[],T._firstLevel=-1,T._startLevel=void 0,T.currentLevelIndex=-1,T.manualLevelIndex=-1,T.onParsedComplete=void 0,T._registerListeners(),T}var L=_.prototype;return L._registerListeners=function(){var T=this.hls;T.on(A.Events.MANIFEST_LOADED,this.onManifestLoaded,this),T.on(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.on(A.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),T.on(A.Events.FRAG_LOADED,this.onFragLoaded,this),T.on(A.Events.ERROR,this.onError,this)},L._unregisterListeners=function(){var T=this.hls;T.off(A.Events.MANIFEST_LOADED,this.onManifestLoaded,this),T.off(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.off(A.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),T.off(A.Events.FRAG_LOADED,this.onFragLoaded,this),T.off(A.Events.ERROR,this.onError,this)},L.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,h.prototype.destroy.call(this)},L.startLoad=function(){var T=this._levels;T.forEach(function(M){M.loadError=0}),h.prototype.startLoad.call(this)},L.onManifestLoaded=function(T,M){var g=[],m=[],l=[],p,a={},E,k=!1,P=!1,U=!1;if(M.levels.forEach(function(j){var H=j.attrs;k=k||!!(j.width&&j.height),P=P||!!j.videoCodec,U=U||!!j.audioCodec,d&&j.audioCodec&&j.audioCodec.indexOf("mp4a.40.34")!==-1&&(j.audioCodec=void 0);var V=j.bitrate+"-"+j.attrs.RESOLUTION+"-"+j.attrs.CODECS;E=a[V],E?E.url.push(j.url):(E=new w.Level(j),a[V]=E,g.push(E)),H&&(H.AUDIO&&(0,B.addGroupId)(E,"audio",H.AUDIO),H.SUBTITLES&&(0,B.addGroupId)(E,"text",H.SUBTITLES))}),(k||P)&&U&&(g=g.filter(function(j){var H=j.videoCodec,V=j.width,z=j.height;return!!H||!!(V&&z)})),g=g.filter(function(j){var H=j.audioCodec,V=j.videoCodec;return(!H||(0,O.isCodecSupportedInMp4)(H,"audio"))&&(!V||(0,O.isCodecSupportedInMp4)(V,"video"))}),M.audioTracks&&(m=M.audioTracks.filter(function(j){return!j.audioCodec||(0,O.isCodecSupportedInMp4)(j.audioCodec,"audio")}),(0,B.assignTrackIdsByGroup)(m)),M.subtitles&&(l=M.subtitles,(0,B.assignTrackIdsByGroup)(l)),g.length>0){p=g[0].bitrate,g.sort(function(j,H){return j.attrs["HDCP-LEVEL"]!==H.attrs["HDCP-LEVEL"]?(j.attrs["HDCP-LEVEL"]||"")>(H.attrs["HDCP-LEVEL"]||"")?1:-1:j.bitrate!==H.bitrate?j.bitrate-H.bitrate:j.attrs.SCORE!==H.attrs.SCORE?j.attrs.decimalFloatingPoint("SCORE")-H.attrs.decimalFloatingPoint("SCORE"):k&&j.height!==H.height?j.height-H.height:0}),this._levels=g;for(var K=0;K<g.length;K++)if(g[K].bitrate===p){this._firstLevel=K,this.log("manifest loaded, "+g.length+" level(s) found, first bitrate: "+p);break}var W=U&&!P,G={levels:g,audioTracks:m,subtitleTracks:l,sessionData:M.sessionData,sessionKeys:M.sessionKeys,firstLevel:this._firstLevel,stats:M.stats,audio:U,video:P,altAudio:!W&&m.some(function(j){return!!j.url})};this.hls.trigger(A.Events.MANIFEST_PARSED,G),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(A.Events.ERROR,{type:N.ErrorTypes.MEDIA_ERROR,details:N.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:M.url,reason:"no level with compatible codecs found in manifest"})},L.onError=function(T,M){var g,m;if(h.prototype.onError.call(this,T,M),!M.fatal){var l=M.context,p=this._levels[this.currentLevelIndex];if(l&&(l.type===R.PlaylistContextType.AUDIO_TRACK&&p.audioGroupIds&&l.groupId===p.audioGroupIds[p.urlId]||l.type===R.PlaylistContextType.SUBTITLE_TRACK&&p.textGroupIds&&l.groupId===p.textGroupIds[p.urlId])){this.redundantFailover(this.currentLevelIndex);return}var a=!1,E=!0,k;switch(M.details){case N.ErrorDetails.FRAG_LOAD_ERROR:case N.ErrorDetails.FRAG_LOAD_TIMEOUT:case N.ErrorDetails.KEY_LOAD_ERROR:case N.ErrorDetails.KEY_LOAD_TIMEOUT:if(M.frag){var P=M.frag.type===R.PlaylistLevelType.MAIN?M.frag.level:this.currentLevelIndex,U=this._levels[P];U?(U.fragmentError++,U.fragmentError>this.hls.config.fragLoadingMaxRetry&&(k=P)):k=P}break;case N.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{var K=p.attrs["HDCP-LEVEL"];K&&(this.hls.maxHdcpLevel=w.HdcpLevels[w.HdcpLevels.indexOf(K)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'))}case N.ErrorDetails.FRAG_PARSING_ERROR:case N.ErrorDetails.KEY_SYSTEM_NO_SESSION:k=((g=M.frag)===null||g===void 0?void 0:g.type)===R.PlaylistLevelType.MAIN?M.frag.level:this.currentLevelIndex,M.levelRetry=!1;break;case N.ErrorDetails.LEVEL_LOAD_ERROR:case N.ErrorDetails.LEVEL_LOAD_TIMEOUT:l&&(l.deliveryDirectives&&(E=!1),k=l.level),a=!0;break;case N.ErrorDetails.REMUX_ALLOC_ERROR:k=(m=M.level)!=null?m:this.currentLevelIndex,a=!0;break}k!==void 0&&this.recoverLevel(M,k,a,E)}},L.recoverLevel=function(T,M,g,m){var l=T.details,p=this._levels[M];if(p.loadError++,g){var a=this.retryLoadingOrFail(T);if(a)T.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(m){var E=p.url.length;if(E>1&&p.loadError<E)T.levelRetry=!0,this.redundantFailover(M);else if(this.manualLevelIndex===-1){for(var k=-1,P=this._levels,U=P.length;U--;){var K=(U+this.currentLevelIndex)%P.length;if(K!==this.currentLevelIndex&&P[K].loadError===0){k=K;break}}k>-1&&this.currentLevelIndex!==k?(this.warn(l+": switch to "+k),T.levelRetry=!0,this.hls.nextAutoLevel=k):T.levelRetry===!1&&(T.fatal=!0)}}},L.redundantFailover=function(T){var M=this._levels[T],g=M.url.length;if(g>1){var m=(M.urlId+1)%g;this.warn("Switching to redundant URL-id "+m),this._levels.forEach(function(l){l.urlId=m}),this.level=T}},L.onFragLoaded=function(T,M){var g=M.frag;if(g!==void 0&&g.type===R.PlaylistLevelType.MAIN){var m=this._levels[g.level];m!==void 0&&(m.fragmentError=0,m.loadError=0)}},L.onLevelLoaded=function(T,M){var g,m=M.level,l=M.details,p=this._levels[m];if(!p){var a;this.warn("Invalid level index "+m),(a=M.deliveryDirectives)!==null&&a!==void 0&&a.skip&&(l.deltaUpdateFailed=!0);return}m===this.currentLevelIndex?(p.fragmentError===0&&(p.loadError=0,this.retryCount=0),this.playlistLoaded(m,M,p.details)):(g=M.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(l.deltaUpdateFailed=!0)},L.onAudioTrackSwitched=function(T,M){var g=this.hls.levels[this.currentLevelIndex];if(g&&g.audioGroupIds){for(var m=-1,l=this.hls.audioTracks[M.id].groupId,p=0;p<g.audioGroupIds.length;p++)if(g.audioGroupIds[p]===l){m=p;break}m!==g.urlId&&(g.urlId=m,this.startLoad())}},L.loadPlaylist=function(T){h.prototype.loadPlaylist.call(this);var M=this.currentLevelIndex,g=this._levels[M];if(this.canLoad&&g&&g.url.length>0){var m=g.urlId,l=g.url[m];if(T)try{l=T.addDirectives(l)}catch(p){this.warn("Could not construct new URL with HLS Delivery Directives: "+p)}this.log("Attempt loading level index "+M+((T==null?void 0:T.msn)!==void 0?" at sn "+T.msn+" part "+T.part:"")+" with URL-id "+m+" "+l),this.clearTimer(),this.hls.trigger(A.Events.LEVEL_LOADING,{url:l,level:M,id:m,deliveryDirectives:T||null})}},L.removeLevel=function(T,M){var g=function(p,a){return a!==M},m=this._levels.filter(function(l,p){return p!==T?!0:l.url.length>1&&M!==void 0?(l.url=l.url.filter(g),l.audioGroupIds&&(l.audioGroupIds=l.audioGroupIds.filter(g)),l.textGroupIds&&(l.textGroupIds=l.textGroupIds.filter(g)),l.urlId=0,!0):!1}).map(function(l,p){var a=l.details;return a!=null&&a.fragments&&a.fragments.forEach(function(E){E.level=p}),l});this._levels=m,this.hls.trigger(A.Events.LEVELS_UPDATED,{levels:m})},y(_,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(T){var M,g=this._levels;if(g.length!==0&&!(this.currentLevelIndex===T&&(M=g[T])!==null&&M!==void 0&&M.details)){if(T<0||T>=g.length){var m=T<0;if(this.hls.trigger(A.Events.ERROR,{type:N.ErrorTypes.OTHER_ERROR,details:N.ErrorDetails.LEVEL_SWITCH_ERROR,level:T,fatal:m,reason:"invalid level idx"}),m)return;T=Math.min(T,g.length-1)}this.clearTimer();var l=this.currentLevelIndex,p=g[l],a=g[T];this.log("switching to level "+T+" from "+l),this.currentLevelIndex=T;var E=b({},a,{level:T,maxBitrate:a.maxBitrate,uri:a.uri,urlId:a.urlId});delete E._urlId,this.hls.trigger(A.Events.LEVEL_SWITCHING,E);var k=a.details;if(!k||k.live){var P=this.switchParams(a.uri,p==null?void 0:p.details);this.loadPlaylist(P)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(T){this.manualLevelIndex=T,this._startLevel===void 0&&(this._startLevel=T),T!==-1&&(this.level=T)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(T){this._firstLevel=T}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var T=this.hls.config.startLevel;return T!==void 0?T:this._firstLevel}else return this._startLevel},set:function(T){this._startLevel=T}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(T){this.level=T,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=T)}}]),_}(F.default)},"./src/controller/level-helper.ts":(C,I,o)=>{o.r(I),o.d(I,{addGroupId:()=>B,addSliding:()=>d,adjustSliding:()=>f,assignTrackIdsByGroup:()=>F,computeReloadInterval:()=>c,getFragmentWithSN:()=>h,getPartWith:()=>_,mapFragmentIntersection:()=>x,mapPartIntersection:()=>D,mergeDetails:()=>y,updateFragPTSDTS:()=>S,updatePTS:()=>R});var w=o("./src/polyfills/number.ts"),A=o("./src/utils/logger.ts"),N=o("./src/loader/date-range.ts");function O(){return O=Object.assign?Object.assign.bind():function(L){for(var v=1;v<arguments.length;v++){var T=arguments[v];for(var M in T)Object.prototype.hasOwnProperty.call(T,M)&&(L[M]=T[M])}return L},O.apply(this,arguments)}function B(L,v,T){switch(v){case"audio":L.audioGroupIds||(L.audioGroupIds=[]),L.audioGroupIds.push(T);break;case"text":L.textGroupIds||(L.textGroupIds=[]),L.textGroupIds.push(T);break}}function F(L){var v={};L.forEach(function(T){var M=T.groupId||"";T.id=v[M]=v[M]||0,v[M]++})}function R(L,v,T){var M=L[v],g=L[T];b(M,g)}function b(L,v){var T=v.startPTS;if((0,w.isFiniteNumber)(T)){var M=0,g;v.sn>L.sn?(M=T-L.start,g=L):(M=L.start-T,g=v),g.duration!==M&&(g.duration=M)}else if(v.sn>L.sn){var m=L.cc===v.cc;m&&L.minEndPTS?v.start=L.start+(L.minEndPTS-L.start):v.start=L.start+L.duration}else v.start=Math.max(L.start-v.duration,0)}function S(L,v,T,M,g,m){var l=M-T;l<=0&&(A.logger.warn("Fragment should have a positive duration",v),M=T+v.duration,m=g+v.duration);var p=T,a=M,E=v.startPTS,k=v.endPTS;if((0,w.isFiniteNumber)(E)){var P=Math.abs(E-T);(0,w.isFiniteNumber)(v.deltaPTS)?v.deltaPTS=Math.max(P,v.deltaPTS):v.deltaPTS=P,p=Math.max(T,E),T=Math.min(T,E),g=Math.min(g,v.startDTS),a=Math.min(M,k),M=Math.max(M,k),m=Math.max(m,v.endDTS)}v.duration=M-T;var U=T-v.start;v.start=v.startPTS=T,v.maxStartPTS=p,v.startDTS=g,v.endPTS=M,v.minEndPTS=a,v.endDTS=m;var K=v.sn;if(!L||K<L.startSN||K>L.endSN)return 0;var W,G=K-L.startSN,j=L.fragments;for(j[G]=v,W=G;W>0;W--)b(j[W],j[W-1]);for(W=G;W<j.length-1;W++)b(j[W],j[W+1]);return L.fragmentHint&&b(j[j.length-1],L.fragmentHint),L.PTSKnown=L.alignedSliding=!0,U}function y(L,v){for(var T=null,M=L.fragments,g=M.length-1;g>=0;g--){var m=M[g].initSegment;if(m){T=m;break}}L.fragmentHint&&delete L.fragmentHint.endPTS;var l=0,p;if(x(L,v,function(W,G){W.relurl&&(l=W.cc-G.cc),(0,w.isFiniteNumber)(W.startPTS)&&(0,w.isFiniteNumber)(W.endPTS)&&(G.start=G.startPTS=W.startPTS,G.startDTS=W.startDTS,G.appendedPTS=W.appendedPTS,G.maxStartPTS=W.maxStartPTS,G.endPTS=W.endPTS,G.endDTS=W.endDTS,G.minEndPTS=W.minEndPTS,G.duration=W.endPTS-W.startPTS,G.duration&&(p=G),v.PTSKnown=v.alignedSliding=!0),G.elementaryStreams=W.elementaryStreams,G.loader=W.loader,G.stats=W.stats,G.urlId=W.urlId,W.initSegment&&(G.initSegment=W.initSegment,T=W.initSegment)}),T){var a=v.fragmentHint?v.fragments.concat(v.fragmentHint):v.fragments;a.forEach(function(W){var G;(!W.initSegment||W.initSegment.relurl===((G=T)===null||G===void 0?void 0:G.relurl))&&(W.initSegment=T)})}if(v.skippedSegments)if(v.deltaUpdateFailed=v.fragments.some(function(W){return!W}),v.deltaUpdateFailed){A.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var E=v.skippedSegments;E--;)v.fragments.shift();v.startSN=v.fragments[0].sn,v.startCC=v.fragments[0].cc}else v.canSkipDateRanges&&(v.dateRanges=s(L.dateRanges,v.dateRanges,v.recentlyRemovedDateranges));var k=v.fragments;if(l){A.logger.warn("discontinuity sliding from playlist, take drift into account");for(var P=0;P<k.length;P++)k[P].cc+=l}v.skippedSegments&&(v.startCC=v.fragments[0].cc),D(L.partList,v.partList,function(W,G){G.elementaryStreams=W.elementaryStreams,G.stats=W.stats}),p?S(v,p,p.startPTS,p.endPTS,p.startDTS,p.endDTS):f(L,v),k.length&&(v.totalduration=v.edge-k[0].start),v.driftStartTime=L.driftStartTime,v.driftStart=L.driftStart;var U=v.advancedDateTime;if(v.advanced&&U){var K=v.edge;v.driftStart||(v.driftStartTime=U,v.driftStart=K),v.driftEndTime=U,v.driftEnd=K}else v.driftEndTime=L.driftEndTime,v.driftEnd=L.driftEnd,v.advancedDateTime=L.advancedDateTime}function s(L,v,T){var M=O({},L);return T&&T.forEach(function(g){delete M[g]}),Object.keys(v).forEach(function(g){var m=new N.DateRange(v[g].attr,M[g]);m.isValid?M[g]=m:A.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(v[g].attr)+'"')}),M}function D(L,v,T){if(L&&v)for(var M=0,g=0,m=L.length;g<=m;g++){var l=L[g],p=v[g+M];l&&p&&l.index===p.index&&l.fragment.sn===p.fragment.sn?T(l,p):M--}}function x(L,v,T){for(var M=v.skippedSegments,g=Math.max(L.startSN,v.startSN)-v.startSN,m=(L.fragmentHint?1:0)+(M?v.endSN:Math.min(L.endSN,v.endSN))-v.startSN,l=v.startSN-L.startSN,p=v.fragmentHint?v.fragments.concat(v.fragmentHint):v.fragments,a=L.fragmentHint?L.fragments.concat(L.fragmentHint):L.fragments,E=g;E<=m;E++){var k=a[l+E],P=p[E];M&&!P&&E<M&&(P=v.fragments[E]=k),k&&P&&T(k,P)}}function f(L,v){var T=v.startSN+v.skippedSegments-L.startSN,M=L.fragments;T<0||T>=M.length||d(v,M[T].start)}function d(L,v){if(v){for(var T=L.fragments,M=L.skippedSegments;M<T.length;M++)T[M].start+=v;L.fragmentHint&&(L.fragmentHint.start+=v)}}function c(L,v){v===void 0&&(v=1/0);var T=1e3*L.targetduration;if(L.updated){var M=L.fragments,g=4;if(M.length&&T*g>v){var m=M[M.length-1].duration*1e3;m<T&&(T=m)}}else T/=2;return Math.round(T)}function h(L,v,T){if(!L||!L.details)return null;var M=L.details,g=M.fragments[v-M.startSN];return g||(g=M.fragmentHint,g&&g.sn===v)?g:v<M.startSN&&T&&T.sn===v?T:null}function _(L,v,T){if(!L||!L.details)return null;var M=L.details.partList;if(M)for(var g=M.length;g--;){var m=M[g];if(m.index===T&&m.fragment.sn===v)return m}return null}},"./src/controller/stream-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>v});var w=o("./src/polyfills/number.ts"),A=o("./src/controller/base-stream-controller.ts"),N=o("./src/is-supported.ts"),O=o("./src/events.ts"),B=o("./src/utils/buffer-helper.ts"),F=o("./src/controller/fragment-tracker.ts"),R=o("./src/types/loader.ts"),b=o("./src/loader/fragment.ts"),S=o("./src/demux/transmuxer-interface.ts"),y=o("./src/types/transmuxer.ts"),s=o("./src/controller/gap-controller.ts"),D=o("./src/errors.ts");function x(T,M){for(var g=0;g<M.length;g++){var m=M[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(T,d(m.key),m)}}function f(T,M,g){return M&&x(T.prototype,M),g&&x(T,g),Object.defineProperty(T,"prototype",{writable:!1}),T}function d(T){var M=c(T,"string");return typeof M=="symbol"?M:String(M)}function c(T,M){if(typeof T!="object"||T===null)return T;var g=T[Symbol.toPrimitive];if(g!==void 0){var m=g.call(T,M||"default");if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(M==="string"?String:Number)(T)}function h(T,M){T.prototype=Object.create(M.prototype),T.prototype.constructor=T,_(T,M)}function _(T,M){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(m,l){return m.__proto__=l,m},_(T,M)}var L=100,v=function(T){h(M,T);function M(m,l,p){var a;return a=T.call(this,m,l,p,"[stream-controller]")||this,a.audioCodecSwap=!1,a.gapController=null,a.level=-1,a._forceStartLoad=!1,a.altAudio=!1,a.audioOnly=!1,a.fragPlaying=null,a.onvplaying=null,a.onvseeked=null,a.fragLastKbps=0,a.couldBacktrack=!1,a.backtrackFragment=null,a.audioCodecSwitch=!1,a.videoBuffer=null,a._registerListeners(),a}var g=M.prototype;return g._registerListeners=function(){var l=this.hls;l.on(O.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(O.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(O.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(O.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(O.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(O.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.on(O.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),l.on(O.Events.ERROR,this.onError,this),l.on(O.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),l.on(O.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.on(O.Events.BUFFER_CREATED,this.onBufferCreated,this),l.on(O.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),l.on(O.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),l.on(O.Events.FRAG_BUFFERED,this.onFragBuffered,this)},g._unregisterListeners=function(){var l=this.hls;l.off(O.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(O.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(O.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(O.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(O.Events.LEVEL_LOADED,this.onLevelLoaded,this),l.off(O.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),l.off(O.Events.ERROR,this.onError,this),l.off(O.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),l.off(O.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),l.off(O.Events.BUFFER_CREATED,this.onBufferCreated,this),l.off(O.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),l.off(O.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),l.off(O.Events.FRAG_BUFFERED,this.onFragBuffered,this)},g.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},g.startLoad=function(l){if(this.levels){var p=this.lastCurrentTime,a=this.hls;if(this.stopLoad(),this.setInterval(L),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var E=a.startLevel;E===-1&&(a.config.testBandwidth&&this.levels.length>1?(E=0,this.bitrateTest=!0):E=a.nextAutoLevel),this.level=a.nextLoadLevel=E,this.loadedmetadata=!1}p>0&&l===-1&&(this.log("Override startPosition with lastCurrentTime @"+p.toFixed(3)),l=p),this.state=A.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=l,this.tick()}else this._forceStartLoad=!0,this.state=A.State.STOPPED},g.stopLoad=function(){this._forceStartLoad=!1,T.prototype.stopLoad.call(this)},g.doTick=function(){switch(this.state){case A.State.IDLE:this.doTickIdle();break;case A.State.WAITING_LEVEL:{var l,p=this.levels,a=this.level,E=p==null||(l=p[a])===null||l===void 0?void 0:l.details;if(E&&(!E.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(E))break;this.state=A.State.IDLE;break}break}case A.State.FRAG_LOADING_WAITING_RETRY:{var k,P=self.performance.now(),U=this.retryDate;(!U||P>=U||(k=this.media)!==null&&k!==void 0&&k.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=A.State.IDLE)}break}this.onTickEnd()},g.onTickEnd=function(){T.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},g.doTickIdle=function(){var l=this.hls,p=this.levelLastLoaded,a=this.levels,E=this.media,k=l.config,P=l.nextLoadLevel;if(!(p===null||!E&&(this.startFragRequested||!k.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!a||!a[P])){var U=a[P],K=this.getMainFwdBufferInfo();if(K!==null){var W=this.getLevelDetails();if(W&&this._streamEnded(K,W)){var G={};this.altAudio&&(G.type="video"),this.hls.trigger(O.Events.BUFFER_EOS,G),this.state=A.State.ENDED;return}this.level=l.nextLoadLevel=P;var j=U.details;if(!j||this.state===A.State.WAITING_LEVEL||j.live&&this.levelLastLoaded!==P){this.level=P,this.state=A.State.WAITING_LEVEL;return}var H=K.len,V=this.getMaxBufferLength(U.maxBitrate);if(!(H>=V)){this.backtrackFragment&&this.backtrackFragment.start>K.end&&(this.backtrackFragment=null);var z=this.backtrackFragment?this.backtrackFragment.start:K.end,$=this.getNextFragment(z,j);if(this.couldBacktrack&&!this.fragPrevious&&$&&$.sn!=="initSegment"&&this.fragmentTracker.getState($)!==F.FragmentState.OK){var Y,X=((Y=this.backtrackFragment)!=null?Y:$).sn,Z=X-j.startSN,Q=j.fragments[Z-1];Q&&$.cc===Q.cc&&($=Q,this.fragmentTracker.removeFragment(Q))}else this.backtrackFragment&&K.len&&(this.backtrackFragment=null);if($&&this.fragmentTracker.getState($)===F.FragmentState.OK&&this.nextLoadPosition>z){var J=this.audioOnly&&!this.altAudio?b.ElementaryStreamTypes.AUDIO:b.ElementaryStreamTypes.VIDEO,re=(J===b.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;re&&this.afterBufferFlushed(re,J,R.PlaylistLevelType.MAIN),$=this.getNextFragment(this.nextLoadPosition,j)}$&&($.initSegment&&!$.initSegment.data&&!this.bitrateTest&&($=$.initSegment),this.loadFragment($,j,z))}}}},g.loadFragment=function(l,p,a){var E,k=this.fragmentTracker.getState(l);this.fragCurrent=l,k===F.FragmentState.NOT_LOADED?l.sn==="initSegment"?this._loadInitSegment(l,p):this.bitrateTest?(this.log("Fragment "+l.sn+" of level "+l.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(l,p)):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,l,p,a)):k===F.FragmentState.APPENDING?this.reduceMaxBufferLength(l.duration)&&this.fragmentTracker.removeFragment(l):((E=this.media)===null||E===void 0?void 0:E.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},g.getAppendedFrag=function(l){var p=this.fragmentTracker.getAppendedFrag(l,R.PlaylistLevelType.MAIN);return p&&"fragment"in p?p.fragment:p},g.getBufferedFrag=function(l){return this.fragmentTracker.getBufferedFrag(l,R.PlaylistLevelType.MAIN)},g.followingBufferedFrag=function(l){return l?this.getBufferedFrag(l.end+.5):null},g.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},g.nextLevelSwitch=function(){var l=this.levels,p=this.media;if(p!=null&&p.readyState){var a,E=this.getAppendedFrag(p.currentTime);if(E&&E.start>1&&this.flushMainBuffer(0,E.start-1),!p.paused&&l){var k=this.hls.nextLoadLevel,P=l[k],U=this.fragLastKbps;U&&this.fragCurrent?a=this.fragCurrent.duration*P.maxBitrate/(1e3*U)+1:a=0}else a=0;var K=this.getBufferedFrag(p.currentTime+a);if(K){var W=this.followingBufferedFrag(K);if(W){this.abortCurrentFrag();var G=W.maxStartPTS?W.maxStartPTS:W.start,j=W.duration,H=Math.max(K.end,G+Math.min(Math.max(j-this.config.maxFragLookUpTolerance,j*.5),j*.75));this.flushMainBuffer(H,Number.POSITIVE_INFINITY)}}}},g.abortCurrentFrag=function(){var l=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,l&&l.abortRequests(),this.state){case A.State.KEY_LOADING:case A.State.FRAG_LOADING:case A.State.FRAG_LOADING_WAITING_RETRY:case A.State.PARSING:case A.State.PARSED:this.state=A.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},g.flushMainBuffer=function(l,p){T.prototype.flushMainBuffer.call(this,l,p,this.altAudio?"video":null)},g.onMediaAttached=function(l,p){T.prototype.onMediaAttached.call(this,l,p);var a=p.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),a.addEventListener("playing",this.onvplaying),a.addEventListener("seeked",this.onvseeked),this.gapController=new s.default(this.config,a,this.fragmentTracker,this.hls)},g.onMediaDetaching=function(){var l=this.media;l&&this.onvplaying&&this.onvseeked&&(l.removeEventListener("playing",this.onvplaying),l.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),T.prototype.onMediaDetaching.call(this)},g.onMediaPlaying=function(){this.tick()},g.onMediaSeeked=function(){var l=this.media,p=l?l.currentTime:null;(0,w.isFiniteNumber)(p)&&this.log("Media seeked to "+p.toFixed(3)),this.tick()},g.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(O.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},g.onManifestParsed=function(l,p){var a=!1,E=!1,k;p.levels.forEach(function(P){k=P.audioCodec,k&&(k.indexOf("mp4a.40.2")!==-1&&(a=!0),k.indexOf("mp4a.40.5")!==-1&&(E=!0))}),this.audioCodecSwitch=a&&E&&!(0,N.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=p.levels,this.startFragRequested=!1},g.onLevelLoading=function(l,p){var a=this.levels;if(!(!a||this.state!==A.State.IDLE)){var E=a[p.level];(!E.details||E.details.live&&this.levelLastLoaded!==p.level||this.waitForCdnTuneIn(E.details))&&(this.state=A.State.WAITING_LEVEL)}},g.onLevelLoaded=function(l,p){var a,E=this.levels,k=p.level,P=p.details,U=P.totalduration;if(!E){this.warn("Levels were reset while loading level "+k);return}this.log("Level "+k+" loaded ["+P.startSN+","+P.endSN+"], cc ["+P.startCC+", "+P.endCC+"] duration:"+U);var K=this.fragCurrent;K&&(this.state===A.State.FRAG_LOADING||this.state===A.State.FRAG_LOADING_WAITING_RETRY)&&K.level!==p.level&&K.loader&&(this.state=A.State.IDLE,this.backtrackFragment=null,K.abortRequests());var W=E[k],G=0;if(P.live||(a=W.details)!==null&&a!==void 0&&a.live){if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed)return;G=this.alignPlaylists(P,W.details)}if(W.details=P,this.levelLastLoaded=k,this.hls.trigger(O.Events.LEVEL_UPDATED,{details:P,level:k}),this.state===A.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(P))return;this.state=A.State.IDLE}this.startFragRequested?P.live&&this.synchronizeToLiveEdge(P):this.setStartPosition(P,G),this.tick()},g._handleFragmentLoadProgress=function(l){var p,a=l.frag,E=l.part,k=l.payload,P=this.levels;if(!P){this.warn("Levels were reset while fragment load was in progress. Fragment "+a.sn+" of level "+a.level+" will not be buffered");return}var U=P[a.level],K=U.details;if(!K){this.warn("Dropping fragment "+a.sn+" of level "+a.level+" after level details were reset");return}var W=U.videoCodec,G=K.PTSKnown||!K.live,j=(p=a.initSegment)===null||p===void 0?void 0:p.data,H=this._getAudioCodec(U),V=this.transmuxer=this.transmuxer||new S.default(this.hls,R.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),z=E?E.index:-1,$=z!==-1,Y=new y.ChunkMetadata(a.level,a.sn,a.stats.chunkCount,k.byteLength,z,$),X=this.initPTS[a.cc];V.push(k,j,H,W,a,E,K.totalduration,G,Y,X)},g.onAudioTrackSwitching=function(l,p){var a=this.altAudio,E=!!p.url,k=p.id;if(!E){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var P=this.fragCurrent;P&&(this.log("Switching to main audio track, cancel main fragment load"),P.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var U=this.hls;a&&U.trigger(O.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),U.trigger(O.Events.AUDIO_TRACK_SWITCHED,{id:k})}},g.onAudioTrackSwitched=function(l,p){var a=p.id,E=!!this.hls.audioTracks[a].url;if(E){var k=this.videoBuffer;k&&this.mediaBuffer!==k&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=k)}this.altAudio=E,this.tick()},g.onBufferCreated=function(l,p){var a=p.tracks,E,k,P=!1;for(var U in a){var K=a[U];if(K.id==="main"){if(k=U,E=K,U==="video"){var W=a[U];W&&(this.videoBuffer=W.buffer)}}else P=!0}P&&E?(this.log("Alternate track found, use "+k+".buffered to schedule main fragment loading"),this.mediaBuffer=E.buffer):this.mediaBuffer=this.media},g.onFragBuffered=function(l,p){var a=p.frag,E=p.part;if(!(a&&a.type!==R.PlaylistLevelType.MAIN)){if(this.fragContextChanged(a)){this.warn("Fragment "+a.sn+(E?" p: "+E.index:"")+" of level "+a.level+" finished buffering, but was aborted. state: "+this.state),this.state===A.State.PARSED&&(this.state=A.State.IDLE);return}var k=E?E.stats:a.stats;this.fragLastKbps=Math.round(8*k.total/(k.buffering.end-k.loading.first)),a.sn!=="initSegment"&&(this.fragPrevious=a),this.fragBufferedComplete(a,E)}},g.onError=function(l,p){if(p.type===D.ErrorTypes.KEY_SYSTEM_ERROR){this.onFragmentOrKeyLoadError(R.PlaylistLevelType.MAIN,p);return}switch(p.details){case D.ErrorDetails.FRAG_LOAD_ERROR:case D.ErrorDetails.FRAG_LOAD_TIMEOUT:case D.ErrorDetails.FRAG_PARSING_ERROR:case D.ErrorDetails.KEY_LOAD_ERROR:case D.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(R.PlaylistLevelType.MAIN,p);break;case D.ErrorDetails.LEVEL_LOAD_ERROR:case D.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==A.State.ERROR&&(p.fatal?(this.warn(""+p.details),this.state=A.State.ERROR):!p.levelRetry&&this.state===A.State.WAITING_LEVEL&&(this.state=A.State.IDLE));break;case D.ErrorDetails.BUFFER_FULL_ERROR:if(p.parent==="main"&&(this.state===A.State.PARSING||this.state===A.State.PARSED)){var a=!0,E=this.getFwdBufferInfo(this.media,R.PlaylistLevelType.MAIN);E&&E.len>.5&&(a=!this.reduceMaxBufferLength(E.len)),a&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},g.checkBuffer=function(){var l=this.media,p=this.gapController;if(!(!l||!p||!l.readyState)){if(this.loadedmetadata||!B.BufferHelper.getBuffered(l).length){var a=this.state!==A.State.IDLE?this.fragCurrent:null;p.poll(this.lastCurrentTime,a)}this.lastCurrentTime=l.currentTime}},g.onFragLoadEmergencyAborted=function(){this.state=A.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},g.onBufferFlushed=function(l,p){var a=p.type;if(a!==b.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var E=(a===b.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(E,a,R.PlaylistLevelType.MAIN)}},g.onLevelsUpdated=function(l,p){this.levels=p.levels},g.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},g.seekToStartPos=function(){var l=this.media;if(l){var p=l.currentTime,a=this.startPosition;if(a>=0&&p<a){if(l.seeking){this.log("could not seek to "+a+", already seeking at "+p);return}var E=B.BufferHelper.getBuffered(l),k=E.length?E.start(0):0,P=k-a;P>0&&(P<this.config.maxBufferHole||P<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+P+" to match buffer start"),a+=P,this.startPosition=a),this.log("seek to target start position "+a+" from current time "+p),l.currentTime=a}}},g._getAudioCodec=function(l){var p=this.config.defaultAudioCodec||l.audioCodec;return this.audioCodecSwap&&p&&(this.log("Swapping audio codec"),p.indexOf("mp4a.40.5")!==-1?p="mp4a.40.2":p="mp4a.40.5"),p},g._loadBitrateTestFrag=function(l,p){var a=this;l.bitrateTest=!0,this._doFragLoad(l,p).then(function(E){var k=a.hls;if(!(!E||a.fragContextChanged(l))){a.fragLoadError=0,a.state=A.State.IDLE,a.startFragRequested=!1,a.bitrateTest=!1;var P=l.stats;P.parsing.start=P.parsing.end=P.buffering.start=P.buffering.end=self.performance.now(),k.trigger(O.Events.FRAG_LOADED,E),l.bitrateTest=!1}})},g._handleTransmuxComplete=function(l){var p,a="main",E=this.hls,k=l.remuxResult,P=l.chunkMeta,U=this.getCurrentContext(P);if(!U){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(P.level);return}var K=U.frag,W=U.part,G=U.level,j=k.video,H=k.text,V=k.id3,z=k.initSegment,$=G.details,Y=this.altAudio?void 0:k.audio;if(!this.fragContextChanged(K)){if(this.state=A.State.PARSING,z){z.tracks&&(this._bufferInitSegment(G,z.tracks,K,P),E.trigger(O.Events.FRAG_PARSING_INIT_SEGMENT,{frag:K,id:a,tracks:z.tracks}));var X=z.initPTS,Z=z.timescale;(0,w.isFiniteNumber)(X)&&(this.initPTS[K.cc]=X,E.trigger(O.Events.INIT_PTS_FOUND,{frag:K,id:a,initPTS:X,timescale:Z}))}if(j&&k.independent!==!1){if($){var Q=j.startPTS,J=j.endPTS,re=j.startDTS,se=j.endDTS;if(W)W.elementaryStreams[j.type]={startPTS:Q,endPTS:J,startDTS:re,endDTS:se};else if(j.firstKeyFrame&&j.independent&&P.id===1&&(this.couldBacktrack=!0),j.dropped&&j.independent){var ie=this.getMainFwdBufferInfo(),q=(ie?ie.end:this.getLoadPosition())+this.config.maxBufferHole,oe=j.firstKeyFramePTS?j.firstKeyFramePTS:Q;if(q<oe-this.config.maxBufferHole){this.backtrack(K);return}K.setElementaryStreamInfo(j.type,K.start,J,K.start,se,!0)}K.setElementaryStreamInfo(j.type,Q,J,re,se),this.backtrackFragment&&(this.backtrackFragment=K),this.bufferFragmentData(j,K,W,P)}}else if(k.independent===!1){this.backtrack(K);return}if(Y){var le=Y.startPTS,fe=Y.endPTS,Ie=Y.startDTS,pe=Y.endDTS;W&&(W.elementaryStreams[b.ElementaryStreamTypes.AUDIO]={startPTS:le,endPTS:fe,startDTS:Ie,endDTS:pe}),K.setElementaryStreamInfo(b.ElementaryStreamTypes.AUDIO,le,fe,Ie,pe),this.bufferFragmentData(Y,K,W,P)}if($&&V!==null&&V!==void 0&&(p=V.samples)!==null&&p!==void 0&&p.length){var xe={id:a,frag:K,details:$,samples:V.samples};E.trigger(O.Events.FRAG_PARSING_METADATA,xe)}if($&&H){var de={id:a,frag:K,details:$,samples:H.samples};E.trigger(O.Events.FRAG_PARSING_USERDATA,de)}}},g._bufferInitSegment=function(l,p,a,E){var k=this;if(this.state===A.State.PARSING){this.audioOnly=!!p.audio&&!p.video,this.altAudio&&!this.audioOnly&&delete p.audio;var P=p.audio,U=p.video,K=p.audiovideo;if(P){var W=l.audioCodec,G=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(W&&(W.indexOf("mp4a.40.5")!==-1?W="mp4a.40.2":W="mp4a.40.5"),P.metadata.channelCount!==1&&G.indexOf("firefox")===-1&&(W="mp4a.40.5")),G.indexOf("android")!==-1&&P.container!=="audio/mpeg"&&(W="mp4a.40.2",this.log("Android: force audio codec to "+W)),l.audioCodec&&l.audioCodec!==W&&this.log('Swapping manifest audio codec "'+l.audioCodec+'" for "'+W+'"'),P.levelCodec=W,P.id="main",this.log("Init audio buffer, container:"+P.container+", codecs[selected/level/parsed]=["+(W||"")+"/"+(l.audioCodec||"")+"/"+P.codec+"]")}U&&(U.levelCodec=l.videoCodec,U.id="main",this.log("Init video buffer, container:"+U.container+", codecs[level/parsed]=["+(l.videoCodec||"")+"/"+U.codec+"]")),K&&this.log("Init audiovideo buffer, container:"+K.container+", codecs[level/parsed]=["+(l.attrs.CODECS||"")+"/"+K.codec+"]"),this.hls.trigger(O.Events.BUFFER_CODECS,p),Object.keys(p).forEach(function(j){var H=p[j],V=H.initSegment;V!=null&&V.byteLength&&k.hls.trigger(O.Events.BUFFER_APPENDING,{type:j,data:V,frag:a,part:null,chunkMeta:E,parent:a.type})}),this.tick()}},g.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,R.PlaylistLevelType.MAIN)},g.backtrack=function(l){this.couldBacktrack=!0,this.backtrackFragment=l,this.resetTransmuxer(),this.flushBufferGap(l),this.fragmentTracker.removeFragment(l),this.fragPrevious=null,this.nextLoadPosition=l.start,this.state=A.State.IDLE},g.checkFragmentChanged=function(){var l=this.media,p=null;if(l&&l.readyState>1&&l.seeking===!1){var a=l.currentTime;if(B.BufferHelper.isBuffered(l,a)?p=this.getAppendedFrag(a):B.BufferHelper.isBuffered(l,a+.1)&&(p=this.getAppendedFrag(a+.1)),p){this.backtrackFragment=null;var E=this.fragPlaying,k=p.level;(!E||p.sn!==E.sn||E.level!==k||p.urlId!==E.urlId)&&(this.fragPlaying=p,this.hls.trigger(O.Events.FRAG_CHANGED,{frag:p}),(!E||E.level!==k)&&this.hls.trigger(O.Events.LEVEL_SWITCHED,{level:k}))}}},f(M,[{key:"nextLevel",get:function(){var l=this.nextBufferedFrag;return l?l.level:-1}},{key:"currentFrag",get:function(){var l=this.media;return l?this.fragPlaying||this.getAppendedFrag(l.currentTime):null}},{key:"currentProgramDateTime",get:function(){var l=this.media;if(l){var p=l.currentTime,a=this.currentFrag;if(a&&(0,w.isFiniteNumber)(p)&&(0,w.isFiniteNumber)(a.programDateTime)){var E=a.programDateTime+(p-a.start)*1e3;return new Date(E)}}return null}},{key:"currentLevel",get:function(){var l=this.currentFrag;return l?l.level:-1}},{key:"nextBufferedFrag",get:function(){var l=this.currentFrag;return l?this.followingBufferedFrag(l):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),M}(A.default)},"./src/controller/subtitle-stream-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{SubtitleStreamController:()=>h});var w=o("./src/events.ts"),A=o("./src/utils/buffer-helper.ts"),N=o("./src/controller/fragment-finders.ts"),O=o("./src/utils/discontinuities.ts"),B=o("./src/controller/level-helper.ts"),F=o("./src/controller/fragment-tracker.ts"),R=o("./src/controller/base-stream-controller.ts"),b=o("./src/types/loader.ts"),S=o("./src/types/level.ts");function y(L,v){for(var T=0;T<v.length;T++){var M=v[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(L,D(M.key),M)}}function s(L,v,T){return v&&y(L.prototype,v),T&&y(L,T),Object.defineProperty(L,"prototype",{writable:!1}),L}function D(L){var v=x(L,"string");return typeof v=="symbol"?v:String(v)}function x(L,v){if(typeof L!="object"||L===null)return L;var T=L[Symbol.toPrimitive];if(T!==void 0){var M=T.call(L,v||"default");if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(L)}function f(L,v){L.prototype=Object.create(v.prototype),L.prototype.constructor=L,d(L,v)}function d(L,v){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,g){return M.__proto__=g,M},d(L,v)}var c=500,h=function(L){f(v,L);function v(M,g,m){var l;return l=L.call(this,M,g,m,"[subtitle-stream-controller]")||this,l.levels=[],l.currentTrackId=-1,l.tracksBuffered=[],l.mainDetails=null,l._registerListeners(),l}var T=v.prototype;return T.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},T._registerListeners=function(){var g=this.hls;g.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.on(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.on(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.on(w.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.on(w.Events.ERROR,this.onError,this),g.on(w.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),g.on(w.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),g.on(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),g.on(w.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),g.on(w.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),g.on(w.Events.FRAG_BUFFERED,this.onFragBuffered,this)},T._unregisterListeners=function(){var g=this.hls;g.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.off(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.off(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.off(w.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.off(w.Events.ERROR,this.onError,this),g.off(w.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),g.off(w.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),g.off(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),g.off(w.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),g.off(w.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),g.off(w.Events.FRAG_BUFFERED,this.onFragBuffered,this)},T.startLoad=function(g){this.stopLoad(),this.state=R.State.IDLE,this.setInterval(c),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=g,this.tick()},T.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},T.onLevelLoaded=function(g,m){this.mainDetails=m.details},T.onSubtitleFragProcessed=function(g,m){var l=m.frag,p=m.success;if(this.fragPrevious=l,this.state=R.State.IDLE,!!p){var a=this.tracksBuffered[this.currentTrackId];if(a){for(var E,k=l.start,P=0;P<a.length;P++)if(k>=a[P].start&&k<=a[P].end){E=a[P];break}var U=l.start+l.duration;E?E.end=U:(E={start:k,end:U},a.push(E)),this.fragmentTracker.fragBuffered(l)}}},T.onBufferFlushing=function(g,m){var l=m.startOffset,p=m.endOffset;if(l===0&&p!==Number.POSITIVE_INFINITY){var a=this.currentTrackId,E=this.levels;if(!E.length||!E[a]||!E[a].details)return;var k=E[a].details,P=k.targetduration,U=p-P;if(U<=0)return;m.endOffsetSubtitles=Math.max(0,U),this.tracksBuffered.forEach(function(K){for(var W=0;W<K.length;){if(K[W].end<=U){K.shift();continue}else if(K[W].start<U)K[W].start=U;else break;W++}}),this.fragmentTracker.removeFragmentsInRange(l,U,b.PlaylistLevelType.SUBTITLE)}},T.onFragBuffered=function(g,m){if(!this.loadedmetadata&&m.frag.type===b.PlaylistLevelType.MAIN){var l;(l=this.media)!==null&&l!==void 0&&l.buffered.length&&(this.loadedmetadata=!0)}},T.onError=function(g,m){var l=m.frag;!l||l.type!==b.PlaylistLevelType.SUBTITLE||(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=R.State.IDLE)},T.onSubtitleTracksUpdated=function(g,m){var l=this,p=m.subtitleTracks;this.tracksBuffered=[],this.levels=p.map(function(a){return new S.Level(a)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(a){l.tracksBuffered[a.id]=[]}),this.mediaBuffer=null},T.onSubtitleTrackSwitch=function(g,m){if(this.currentTrackId=m.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var l=this.levels[this.currentTrackId];l!=null&&l.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,l&&this.setInterval(c)},T.onSubtitleTrackLoaded=function(g,m){var l,p=m.details,a=m.id,E=this.currentTrackId,k=this.levels;if(k.length){var P=k[E];if(!(a>=k.length||a!==E||!P)){this.mediaBuffer=this.mediaBufferTimeRanges;var U=0;if(p.live||(l=P.details)!==null&&l!==void 0&&l.live){var K=this.mainDetails;if(p.deltaUpdateFailed||!K)return;var W=K.fragments[0];P.details?(U=this.alignPlaylists(p,P.details),U===0&&W&&(U=W.start,(0,B.addSliding)(p,U))):p.hasProgramDateTime&&K.hasProgramDateTime?((0,O.alignMediaPlaylistByPDT)(p,K),U=p.fragments[0].start):W&&(U=W.start,(0,B.addSliding)(p,U))}if(P.details=p,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!p.live)&&this.setStartPosition(P.details,U),this.tick(),p.live&&!this.fragCurrent&&this.media&&this.state===R.State.IDLE){var G=(0,N.findFragmentByPTS)(null,p.fragments,this.media.currentTime,0);G||(this.warn("Subtitle playlist not aligned with playback"),P.details=void 0)}}}},T._handleFragmentLoadComplete=function(g){var m=this,l=g.frag,p=g.payload,a=l.decryptdata,E=this.hls;if(!this.fragContextChanged(l)&&p&&p.byteLength>0&&a&&a.key&&a.iv&&a.method==="AES-128"){var k=performance.now();this.decrypter.decrypt(new Uint8Array(p),a.key.buffer,a.iv.buffer).then(function(P){var U=performance.now();E.trigger(w.Events.FRAG_DECRYPTED,{frag:l,payload:P,stats:{tstart:k,tdecrypt:U}})}).catch(function(P){m.warn(P.name+": "+P.message),m.state=R.State.IDLE})}},T.doTick=function(){if(!this.media){this.state=R.State.IDLE;return}if(this.state===R.State.IDLE){var g=this.currentTrackId,m=this.levels;if(!m.length||!m[g]||!m[g].details)return;var l=m[g].details,p=l.targetduration,a=this.config,E=this.getLoadPosition(),k=A.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],E-p,a.maxBufferHole),P=k.end,U=k.len,K=this.getFwdBufferInfo(this.media,b.PlaylistLevelType.MAIN),W=this.getMaxBufferLength(K==null?void 0:K.len)+p;if(U>W)return;console.assert(l,"Subtitle track details are defined on idle subtitle stream controller tick");var G=l.fragments,j=G.length,H=l.edge,V=null,z=this.fragPrevious;if(P<H){var $=a.maxFragLookUpTolerance;V=(0,N.findFragmentByPTS)(z,G,Math.max(G[0].start,P),$),!V&&z&&z.start<G[0].start&&(V=G[0])}else V=G[j-1];if(!V)return;V=this.mapToInitFragWhenRequired(V),this.fragmentTracker.getState(V)===F.FragmentState.NOT_LOADED&&this.loadFragment(V,l,P)}},T.getMaxBufferLength=function(g){var m=L.prototype.getMaxBufferLength.call(this);return g?Math.max(m,g):m},T.loadFragment=function(g,m,l){this.fragCurrent=g,g.sn==="initSegment"?this._loadInitSegment(g,m):(this.startFragRequested=!0,L.prototype.loadFragment.call(this,g,m,l))},s(v,[{key:"mediaBufferTimeRanges",get:function(){return new _(this.tracksBuffered[this.currentTrackId]||[])}}]),v}(R.default),_=function(v){this.buffered=void 0;var T=function(g,m,l){if(m=m>>>0,m>l-1)throw new DOMException("Failed to execute '"+g+"' on 'TimeRanges': The index provided ("+m+") is greater than the maximum bound ("+l+")");return v[m][g]};this.buffered={get length(){return v.length},end:function(g){return T("end",g,v.length)},start:function(g){return T("start",g,v.length)}}}},"./src/controller/subtitle-track-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>x});var w=o("./src/events.ts"),A=o("./src/utils/texttrack-utils.ts"),N=o("./src/controller/base-playlist-controller.ts"),O=o("./src/types/loader.ts");function B(f,d){for(var c=0;c<d.length;c++){var h=d[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(f,R(h.key),h)}}function F(f,d,c){return d&&B(f.prototype,d),c&&B(f,c),Object.defineProperty(f,"prototype",{writable:!1}),f}function R(f){var d=b(f,"string");return typeof d=="symbol"?d:String(d)}function b(f,d){if(typeof f!="object"||f===null)return f;var c=f[Symbol.toPrimitive];if(c!==void 0){var h=c.call(f,d||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(f)}function S(f,d){f.prototype=Object.create(d.prototype),f.prototype.constructor=f,y(f,d)}function y(f,d){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,_){return h.__proto__=_,h},y(f,d)}var s=function(f){S(d,f);function d(h){var _;return _=f.call(this,h,"[subtitle-track-controller]")||this,_.media=null,_.tracks=[],_.groupId=null,_.tracksInGroup=[],_.trackId=-1,_.selectDefaultTrack=!0,_.queuedDefaultTrack=-1,_.trackChangeListener=function(){return _.onTextTracksChanged()},_.asyncPollTrackChange=function(){return _.pollTrackChange(0)},_.useTextTrackPolling=!1,_.subtitlePollingInterval=-1,_._subtitleDisplay=!0,_.registerListeners(),_}var c=d.prototype;return c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,f.prototype.destroy.call(this)},c.registerListeners=function(){var _=this.hls;_.on(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),_.on(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),_.on(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),_.on(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),_.on(w.Events.LEVEL_LOADING,this.onLevelLoading,this),_.on(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_.on(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),_.on(w.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var _=this.hls;_.off(w.Events.MEDIA_ATTACHED,this.onMediaAttached,this),_.off(w.Events.MEDIA_DETACHING,this.onMediaDetaching,this),_.off(w.Events.MANIFEST_LOADING,this.onManifestLoading,this),_.off(w.Events.MANIFEST_PARSED,this.onManifestParsed,this),_.off(w.Events.LEVEL_LOADING,this.onLevelLoading,this),_.off(w.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),_.off(w.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),_.off(w.Events.ERROR,this.onError,this)},c.onMediaAttached=function(_,L){this.media=L.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},c.pollTrackChange=function(_){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,_)},c.onMediaDetaching=function(){if(this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var _=D(this.media.textTracks);_.forEach(function(L){(0,A.clearCurrentCues)(L)}),this.subtitleTrack=-1,this.media=null}},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},c.onManifestParsed=function(_,L){this.tracks=L.subtitleTracks},c.onSubtitleTrackLoaded=function(_,L){var v=L.id,T=L.details,M=this.trackId,g=this.tracksInGroup[M];if(!g){this.warn("Invalid subtitle track id "+v);return}var m=g.details;g.details=L.details,this.log("subtitle track "+v+" loaded ["+T.startSN+"-"+T.endSN+"]"),v===this.trackId&&(this.retryCount=0,this.playlistLoaded(v,L,m))},c.onLevelLoading=function(_,L){this.switchLevel(L.level)},c.onLevelSwitching=function(_,L){this.switchLevel(L.level)},c.switchLevel=function(_){var L=this.hls.levels[_];if(L!=null&&L.textGroupIds){var v=L.textGroupIds[L.urlId];if(this.groupId!==v){var T=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,M=this.tracks.filter(function(l){return!v||l.groupId===v});this.tracksInGroup=M;var g=this.findTrackId(T==null?void 0:T.name)||this.findTrackId();this.groupId=v;var m={subtitleTracks:M};this.log("Updating subtitle tracks, "+M.length+' track(s) found in "'+v+'" group-id'),this.hls.trigger(w.Events.SUBTITLE_TRACKS_UPDATED,m),g!==-1&&this.setSubtitleTrack(g,T)}}},c.findTrackId=function(_){for(var L=this.tracksInGroup,v=0;v<L.length;v++){var T=L[v];if((!this.selectDefaultTrack||T.default)&&(!_||_===T.name))return T.id}return-1},c.onError=function(_,L){f.prototype.onError.call(this,_,L),!(L.fatal||!L.context)&&L.context.type===O.PlaylistContextType.SUBTITLE_TRACK&&L.context.id===this.trackId&&L.context.groupId===this.groupId&&this.retryLoadingOrFail(L)},c.loadPlaylist=function(_){f.prototype.loadPlaylist.call(this);var L=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(L)){var v=L.id,T=L.groupId,M=L.url;if(_)try{M=_.addDirectives(M)}catch(g){this.warn("Could not construct new URL with HLS Delivery Directives: "+g)}this.log("Loading subtitle playlist for id "+v),this.hls.trigger(w.Events.SUBTITLE_TRACK_LOADING,{url:M,id:v,groupId:T,deliveryDirectives:_||null})}},c.toggleTrackModes=function(_){var L=this,v=this.media,T=this.trackId;if(v){var M=D(v.textTracks),g=M.filter(function(p){return p.groupId===L.groupId});if(_===-1)[].slice.call(M).forEach(function(p){p.mode="disabled"});else{var m=g[T];m&&(m.mode="disabled")}var l=g[_];l&&(l.mode=this.subtitleDisplay?"showing":"hidden")}},c.setSubtitleTrack=function(_,L){var v,T=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=_;return}if(this.trackId!==_&&this.toggleTrackModes(_),!(this.trackId===_&&(_===-1||(v=T[_])!==null&&v!==void 0&&v.details)||_<-1||_>=T.length)){this.clearTimer();var M=T[_];if(this.log("Switching to subtitle track "+_),this.trackId=_,M){var g=M.id,m=M.groupId,l=m===void 0?"":m,p=M.name,a=M.type,E=M.url;this.hls.trigger(w.Events.SUBTITLE_TRACK_SWITCH,{id:g,groupId:l,name:p,type:a,url:E});var k=this.switchParams(M.url,L==null?void 0:L.details);this.loadPlaylist(k)}else this.hls.trigger(w.Events.SUBTITLE_TRACK_SWITCH,{id:_})}},c.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var _=-1,L=D(this.media.textTracks),v=0;v<L.length;v++)if(L[v].mode==="hidden")_=v;else if(L[v].mode==="showing"){_=v;break}this.subtitleTrack!==_&&(this.subtitleTrack=_)}},F(d,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(_){this._subtitleDisplay=_,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(_){this.selectDefaultTrack=!1;var L=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(_,L)}}]),d}(N.default);function D(f){for(var d=[],c=0;c<f.length;c++){var h=f[c];h.kind==="subtitles"&&h.label&&d.push(f[c])}return d}const x=s},"./src/controller/timeline-controller.ts":(C,I,o)=>{o.r(I),o.d(I,{TimelineController:()=>s});var w=o("./src/polyfills/number.ts"),A=o("./src/events.ts"),N=o("./src/utils/cea-608-parser.ts"),O=o("./src/utils/output-filter.ts"),B=o("./src/utils/webvtt-parser.ts"),F=o("./src/utils/texttrack-utils.ts"),R=o("./src/utils/imsc1-ttml-parser.ts"),b=o("./src/utils/mp4-tools.ts"),S=o("./src/types/loader.ts"),y=o("./src/utils/logger.ts"),s=function(){function d(h){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=f(),this.captionsProperties=void 0,this.hls=h,this.config=h.config,this.Cues=h.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var _=new O.default(this,"textTrack1"),L=new O.default(this,"textTrack2"),v=new O.default(this,"textTrack3"),T=new O.default(this,"textTrack4");this.cea608Parser1=new N.default(1,_,L),this.cea608Parser2=new N.default(3,v,T)}h.on(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),h.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),h.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),h.on(A.Events.MANIFEST_LOADED,this.onManifestLoaded,this),h.on(A.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),h.on(A.Events.FRAG_LOADING,this.onFragLoading,this),h.on(A.Events.FRAG_LOADED,this.onFragLoaded,this),h.on(A.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),h.on(A.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),h.on(A.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),h.on(A.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),h.on(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var c=d.prototype;return c.destroy=function(){var _=this.hls;_.off(A.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),_.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),_.off(A.Events.MANIFEST_LOADED,this.onManifestLoaded,this),_.off(A.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),_.off(A.Events.FRAG_LOADING,this.onFragLoading,this),_.off(A.Events.FRAG_LOADED,this.onFragLoaded,this),_.off(A.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),_.off(A.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),_.off(A.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),_.off(A.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),_.off(A.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},c.addCues=function(_,L,v,T,M){for(var g=!1,m=M.length;m--;){var l=M[m],p=x(l[0],l[1],L,v);if(p>=0&&(l[0]=Math.min(l[0],L),l[1]=Math.max(l[1],v),g=!0,p/(v-L)>.5))return}if(g||M.push([L,v]),this.config.renderTextTracksNatively){var a=this.captionsTracks[_];this.Cues.newCue(a,L,v,T)}else{var E=this.Cues.newCue(null,L,v,T);this.hls.trigger(A.Events.CUES_PARSED,{type:"captions",cues:E,track:_})}},c.onInitPtsFound=function(_,L){var v=this,T=L.frag,M=L.id,g=L.initPTS,m=L.timescale,l=this.unparsedVttFrags;M==="main"&&(this.initPTS[T.cc]=g,this.timescale[T.cc]=m),l.length&&(this.unparsedVttFrags=[],l.forEach(function(p){v.onFragLoaded(A.Events.FRAG_LOADED,p)}))},c.getExistingTrack=function(_){var L=this.media;if(L)for(var v=0;v<L.textTracks.length;v++){var T=L.textTracks[v];if(T[_])return T}return null},c.createCaptionsTrack=function(_){this.config.renderTextTracksNatively?this.createNativeTrack(_):this.createNonNativeTrack(_)},c.createNativeTrack=function(_){if(!this.captionsTracks[_]){var L=this.captionsProperties,v=this.captionsTracks,T=this.media,M=L[_],g=M.label,m=M.languageCode,l=this.getExistingTrack(_);if(l)v[_]=l,(0,F.clearCurrentCues)(v[_]),(0,F.sendAddTrackEvent)(v[_],T);else{var p=this.createTextTrack("captions",g,m);p&&(p[_]=!0,v[_]=p)}}},c.createNonNativeTrack=function(_){if(!this.nonNativeCaptionsTracks[_]){var L=this.captionsProperties[_];if(L){var v=L.label,T={_id:_,label:v,kind:"captions",default:L.media?!!L.media.default:!1,closedCaptions:L.media};this.nonNativeCaptionsTracks[_]=T,this.hls.trigger(A.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[T]})}}},c.createTextTrack=function(_,L,v){var T=this.media;if(T)return T.addTextTrack(_,L,v)},c.onMediaAttaching=function(_,L){this.media=L.media,this._cleanTracks()},c.onMediaDetaching=function(){var _=this.captionsTracks;Object.keys(_).forEach(function(L){(0,F.clearCurrentCues)(_[L]),delete _[L]}),this.nonNativeCaptionsTracks={}},c.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=f(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},c._cleanTracks=function(){var _=this.media;if(_){var L=_.textTracks;if(L)for(var v=0;v<L.length;v++)(0,F.clearCurrentCues)(L[v])}},c.onSubtitleTracksUpdated=function(_,L){var v=this;this.textTracks=[];var T=L.subtitleTracks||[],M=T.some(function(p){return p.textCodec===R.IMSC1_CODEC});if(this.config.enableWebVTT||M&&this.config.enableIMSC1){var g=this.tracks&&T&&this.tracks.length===T.length;if(this.tracks=T||[],this.config.renderTextTracksNatively){var m=this.media?this.media.textTracks:[];this.tracks.forEach(function(p,a){var E;if(a<m.length){for(var k=null,P=0;P<m.length;P++)if(D(m[P],p)){k=m[P];break}k&&(E=k)}if(E)(0,F.clearCurrentCues)(E);else{var U=v._captionsOrSubtitlesFromCharacteristics(p);E=v.createTextTrack(U,p.name,p.lang),E&&(E.mode="disabled")}E&&(E.groupId=p.groupId,v.textTracks.push(E))})}else if(!g&&this.tracks&&this.tracks.length){var l=this.tracks.map(function(p){return{label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}});this.hls.trigger(A.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}},c._captionsOrSubtitlesFromCharacteristics=function(_){var L;if((L=_.attrs)!==null&&L!==void 0&&L.CHARACTERISTICS){var v=/transcribes-spoken-dialog/gi.test(_.attrs.CHARACTERISTICS),T=/describes-music-and-sound/gi.test(_.attrs.CHARACTERISTICS);if(v&&T)return"captions"}return"subtitles"},c.onManifestLoaded=function(_,L){var v=this;this.config.enableCEA708Captions&&L.captions&&L.captions.forEach(function(T){var M=/(?:CC|SERVICE)([1-4])/.exec(T.instreamId);if(M){var g="textTrack"+M[1],m=v.captionsProperties[g];m&&(m.label=T.name,T.lang&&(m.languageCode=T.lang),m.media=T)}})},c.closedCaptionsForLevel=function(_){var L=this.hls.levels[_.level];return L==null?void 0:L.attrs["CLOSED-CAPTIONS"]},c.onFragLoading=function(_,L){var v=this.cea608Parser1,T=this.cea608Parser2,M=this.lastSn,g=this.lastPartIndex;if(!(!this.enabled||!(v&&T))&&L.frag.type===S.PlaylistLevelType.MAIN){var m,l,p=L.frag.sn,a=(m=L==null||(l=L.part)===null||l===void 0?void 0:l.index)!=null?m:-1;p===M+1||p===M&&a===g+1||(v.reset(),T.reset()),this.lastSn=p,this.lastPartIndex=a}},c.onFragLoaded=function(_,L){var v=L.frag,T=L.payload,M=this.initPTS,g=this.unparsedVttFrags;if(v.type===S.PlaylistLevelType.SUBTITLE)if(T.byteLength){if(!(0,w.isFiniteNumber)(M[v.cc])){g.push(L),M.length&&this.hls.trigger(A.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:v,error:new Error("Missing initial subtitle PTS")});return}var m=v.decryptdata,l="stats"in L;if(m==null||!m.encrypted||l){var p=this.tracks[v.level],a=this.vttCCs;a[v.cc]||(a[v.cc]={start:v.start,prevCC:this.prevCC,new:!0},this.prevCC=v.cc),p&&p.textCodec===R.IMSC1_CODEC?this._parseIMSC1(v,T):this._parseVTTs(v,T,a)}}else this.hls.trigger(A.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:v,error:new Error("Empty subtitle payload")})},c._parseIMSC1=function(_,L){var v=this,T=this.hls;(0,R.parseIMSC1)(L,this.initPTS[_.cc],this.timescale[_.cc],function(M){v._appendCues(M,_.level),T.trigger(A.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:_})},function(M){y.logger.log("Failed to parse IMSC1: "+M),T.trigger(A.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:_,error:M})})},c._parseVTTs=function(_,L,v){var T,M=this,g=this.hls,m=(T=_.initSegment)!==null&&T!==void 0&&T.data?(0,b.appendUint8Array)(_.initSegment.data,new Uint8Array(L)):L;(0,B.parseWebVTT)(m,this.initPTS[_.cc],this.timescale[_.cc],v,_.cc,_.start,function(l){M._appendCues(l,_.level),g.trigger(A.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:_})},function(l){M._fallbackToIMSC1(_,L),y.logger.log("Failed to parse VTT cue: "+l),g.trigger(A.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:_,error:l})})},c._fallbackToIMSC1=function(_,L){var v=this,T=this.tracks[_.level];T.textCodec||(0,R.parseIMSC1)(L,this.initPTS[_.cc],this.timescale[_.cc],function(){T.textCodec=R.IMSC1_CODEC,v._parseIMSC1(_,L)},function(){T.textCodec="wvtt"})},c._appendCues=function(_,L){var v=this.hls;if(this.config.renderTextTracksNatively){var T=this.textTracks[L];if(!T||T.mode==="disabled")return;_.forEach(function(m){return(0,F.addCueToTrack)(T,m)})}else{var M=this.tracks[L];if(!M)return;var g=M.default?"default":"subtitles"+L;v.trigger(A.Events.CUES_PARSED,{type:"subtitles",cues:_,track:g})}},c.onFragDecrypted=function(_,L){var v=L.frag;if(v.type===S.PlaylistLevelType.SUBTITLE){if(!(0,w.isFiniteNumber)(this.initPTS[v.cc])){this.unparsedVttFrags.push(L);return}this.onFragLoaded(A.Events.FRAG_LOADED,L)}},c.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},c.onFragParsingUserdata=function(_,L){var v=this.cea608Parser1,T=this.cea608Parser2;if(!(!this.enabled||!(v&&T))){var M=L.frag,g=L.samples;if(!(M.type===S.PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(M)==="NONE"))for(var m=0;m<g.length;m++){var l=g[m].bytes;if(l){var p=this.extractCea608Data(l);v.addData(g[m].pts,p[0]),T.addData(g[m].pts,p[1])}}}},c.onBufferFlushing=function(_,L){var v=L.startOffset,T=L.endOffset,M=L.endOffsetSubtitles,g=L.type,m=this.media;if(!(!m||m.currentTime<T)){if(!g||g==="video"){var l=this.captionsTracks;Object.keys(l).forEach(function(a){return(0,F.removeCuesInRange)(l[a],v,T)})}if(this.config.renderTextTracksNatively&&v===0&&M!==void 0){var p=this.textTracks;Object.keys(p).forEach(function(a){return(0,F.removeCuesInRange)(p[a],v,M)})}}},c.extractCea608Data=function(_){for(var L=[[],[]],v=_[0]&31,T=2,M=0;M<v;M++){var g=_[T++],m=127&_[T++],l=127&_[T++];if(!(m===0&&l===0)){var p=(4&g)!==0;if(p){var a=3&g;(a===0||a===1)&&(L[a].push(m),L[a].push(l))}}}return L},d}();function D(d,c){return d&&d.label===c.name&&!(d.textTrack1||d.textTrack2)}function x(d,c,h,_){return Math.min(c,_)-Math.max(d,h)}function f(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}},"./src/crypt/aes-crypto.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>w});var w=function(){function A(O,B){this.subtle=void 0,this.aesIV=void 0,this.subtle=O,this.aesIV=B}var N=A.prototype;return N.decrypt=function(B,F){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},F,B)},A}()},"./src/crypt/aes-decryptor.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>N,removePadding:()=>A});var w=o("./src/utils/typed-array.ts");function A(O){var B=O.byteLength,F=B&&new DataView(O.buffer).getUint8(B-1);return F?(0,w.sliceUint8)(O,0,B-F):O}var N=function(){function O(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var B=O.prototype;return B.uint8ArrayToUint32Array_=function(R){for(var b=new DataView(R),S=new Uint32Array(4),y=0;y<4;y++)S[y]=b.getUint32(y*4);return S},B.initTable=function(){var R=this.sBox,b=this.invSBox,S=this.subMix,y=S[0],s=S[1],D=S[2],x=S[3],f=this.invSubMix,d=f[0],c=f[1],h=f[2],_=f[3],L=new Uint32Array(256),v=0,T=0,M=0;for(M=0;M<256;M++)M<128?L[M]=M<<1:L[M]=M<<1^283;for(M=0;M<256;M++){var g=T^T<<1^T<<2^T<<3^T<<4;g=g>>>8^g&255^99,R[v]=g,b[g]=v;var m=L[v],l=L[m],p=L[l],a=L[g]*257^g*16843008;y[v]=a<<24|a>>>8,s[v]=a<<16|a>>>16,D[v]=a<<8|a>>>24,x[v]=a,a=p*16843009^l*65537^m*257^v*16843008,d[g]=a<<24|a>>>8,c[g]=a<<16|a>>>16,h[g]=a<<8|a>>>24,_[g]=a,v?(v=m^L[L[L[p^m]]],T^=L[L[T]]):v=T=1}},B.expandKey=function(R){for(var b=this.uint8ArrayToUint32Array_(R),S=!0,y=0;y<b.length&&S;)S=b[y]===this.key[y],y++;if(!S){this.key=b;var s=this.keySize=b.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);var D=this.ksRows=(s+6+1)*4,x,f,d=this.keySchedule=new Uint32Array(D),c=this.invKeySchedule=new Uint32Array(D),h=this.sBox,_=this.rcon,L=this.invSubMix,v=L[0],T=L[1],M=L[2],g=L[3],m,l;for(x=0;x<D;x++){if(x<s){m=d[x]=b[x];continue}l=m,x%s===0?(l=l<<8|l>>>24,l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[l&255],l^=_[x/s|0]<<24):s>6&&x%s===4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[l&255]),d[x]=m=(d[x-s]^l)>>>0}for(f=0;f<D;f++)x=D-f,f&3?l=d[x]:l=d[x-4],f<4||x<=4?c[f]=l:c[f]=v[h[l>>>24]]^T[h[l>>>16&255]]^M[h[l>>>8&255]]^g[h[l&255]],c[f]=c[f]>>>0}},B.networkToHostOrderSwap=function(R){return R<<24|(R&65280)<<8|(R&16711680)>>8|R>>>24},B.decrypt=function(R,b,S){for(var y=this.keySize+6,s=this.invKeySchedule,D=this.invSBox,x=this.invSubMix,f=x[0],d=x[1],c=x[2],h=x[3],_=this.uint8ArrayToUint32Array_(S),L=_[0],v=_[1],T=_[2],M=_[3],g=new Int32Array(R),m=new Int32Array(g.length),l,p,a,E,k,P,U,K,W,G,j,H,V,z,$=this.networkToHostOrderSwap;b<g.length;){for(W=$(g[b]),G=$(g[b+1]),j=$(g[b+2]),H=$(g[b+3]),k=W^s[0],P=H^s[1],U=j^s[2],K=G^s[3],V=4,z=1;z<y;z++)l=f[k>>>24]^d[P>>16&255]^c[U>>8&255]^h[K&255]^s[V],p=f[P>>>24]^d[U>>16&255]^c[K>>8&255]^h[k&255]^s[V+1],a=f[U>>>24]^d[K>>16&255]^c[k>>8&255]^h[P&255]^s[V+2],E=f[K>>>24]^d[k>>16&255]^c[P>>8&255]^h[U&255]^s[V+3],k=l,P=p,U=a,K=E,V=V+4;l=D[k>>>24]<<24^D[P>>16&255]<<16^D[U>>8&255]<<8^D[K&255]^s[V],p=D[P>>>24]<<24^D[U>>16&255]<<16^D[K>>8&255]<<8^D[k&255]^s[V+1],a=D[U>>>24]<<24^D[K>>16&255]<<16^D[k>>8&255]<<8^D[P&255]^s[V+2],E=D[K>>>24]<<24^D[k>>16&255]<<16^D[P>>8&255]<<8^D[U&255]^s[V+3],m[b]=$(l^L),m[b+1]=$(E^v),m[b+2]=$(a^T),m[b+3]=$(p^M),L=W,v=G,T=j,M=H,b=b+4}return m.buffer},O}()},"./src/crypt/decrypter.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>b});var w=o("./src/crypt/aes-crypto.ts"),A=o("./src/crypt/fast-aes-key.ts"),N=o("./src/crypt/aes-decryptor.ts"),O=o("./src/utils/logger.ts"),B=o("./src/utils/mp4-tools.ts"),F=o("./src/utils/typed-array.ts"),R=16,b=function(){function S(s,D){var x=D===void 0?{}:D,f=x.removePKCS7Padding,d=f===void 0?!0:f;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=s.enableSoftwareAES,this.removePKCS7Padding=d,d)try{var c=self.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}var y=S.prototype;return y.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},y.isSync=function(){return this.useSoftware},y.flush=function(){var D=this.currentResult,x=this.remainderData;if(!D||x)return this.reset(),null;var f=new Uint8Array(D);return this.reset(),this.removePKCS7Padding?(0,N.removePadding)(f):f},y.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},y.decrypt=function(D,x,f){var d=this;return this.useSoftware?new Promise(function(c,h){d.softwareDecrypt(new Uint8Array(D),x,f);var _=d.flush();_?c(_.buffer):h(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(D),x,f)},y.softwareDecrypt=function(D,x,f){var d=this.currentIV,c=this.currentResult,h=this.remainderData;this.logOnce("JS AES decrypt"),h&&(D=(0,B.appendUint8Array)(h,D),this.remainderData=null);var _=this.getValidChunk(D);if(!_.length)return null;d&&(f=d);var L=this.softwareDecrypter;L||(L=this.softwareDecrypter=new N.default),L.expandKey(x);var v=c;return this.currentResult=L.decrypt(_.buffer,0,f),this.currentIV=(0,F.sliceUint8)(_,-16).buffer,v||null},y.webCryptoDecrypt=function(D,x,f){var d=this,c=this.subtle;return(this.key!==x||!this.fastAesKey)&&(this.key=x,this.fastAesKey=new A.default(c,x)),this.fastAesKey.expandKey().then(function(h){if(!c)return Promise.reject(new Error("web crypto not initialized"));d.logOnce("WebCrypto AES decrypt");var _=new w.default(c,new Uint8Array(f));return _.decrypt(D.buffer,h)}).catch(function(h){return O.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+h.name+": "+h.message),d.onWebCryptoError(D,x,f)})},y.onWebCryptoError=function(D,x,f){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(D,x,f);var d=this.flush();if(d)return d.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},y.getValidChunk=function(D){var x=D,f=D.length-D.length%R;return f!==D.length&&(x=(0,F.sliceUint8)(D,0,f),this.remainderData=(0,F.sliceUint8)(D,f)),x},y.logOnce=function(D){this.logEnabled&&(O.logger.log("[decrypter]: "+D),this.logEnabled=!1)},S}()},"./src/crypt/fast-aes-key.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>w});var w=function(){function A(O,B){this.subtle=void 0,this.key=void 0,this.subtle=O,this.key=B}var N=A.prototype;return N.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},A}()},"./src/demux/aacdemuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>b});var w=o("./src/demux/base-audio-demuxer.ts"),A=o("./src/demux/adts.ts"),N=o("./src/utils/logger.ts"),O=o("./src/demux/id3.ts");function B(S,y){S.prototype=Object.create(y.prototype),S.prototype.constructor=S,F(S,y)}function F(S,y){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,x){return D.__proto__=x,D},F(S,y)}var R=function(S){B(y,S);function y(D,x){var f;return f=S.call(this)||this,f.observer=void 0,f.config=void 0,f.observer=D,f.config=x,f}var s=y.prototype;return s.resetInitSegment=function(x,f,d,c){S.prototype.resetInitSegment.call(this,x,f,d,c),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:f,duration:c,inputTimeScale:9e4,dropped:0}},y.probe=function(x){if(!x)return!1;for(var f=O.getID3Data(x,0)||[],d=f.length,c=x.length;d<c;d++)if(A.probe(x,d))return N.logger.log("ADTS sync word found !"),!0;return!1},s.canParse=function(x,f){return A.canParse(x,f)},s.appendFrame=function(x,f,d){A.initTrackConfig(x,this.observer,f,d,x.manifestCodec);var c=A.appendFrame(x,f,d,this.basePTS,this.frameIndex);if(c&&c.missing===0)return c},y}(w.default);const b=R},"./src/demux/adts.ts":(C,I,o)=>{o.r(I),o.d(I,{appendFrame:()=>d,canGetFrameLength:()=>b,canParse:()=>y,getAudioConfig:()=>O,getFrameDuration:()=>x,getFullFrameLength:()=>R,getHeaderLength:()=>F,initTrackConfig:()=>D,isHeader:()=>S,isHeaderPattern:()=>B,parseFrameHeader:()=>f,probe:()=>s});var w=o("./src/utils/logger.ts"),A=o("./src/errors.ts"),N=o("./src/events.ts");function O(c,h,_,L){var v,T,M,g,m=navigator.userAgent.toLowerCase(),l=L,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];v=((h[_+2]&192)>>>6)+1;var a=(h[_+2]&60)>>>2;if(a>p.length-1){c.trigger(N.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+a});return}return M=(h[_+2]&1)<<2,M|=(h[_+3]&192)>>>6,w.logger.log("manifest codec:"+L+", ADTS type:"+v+", samplingIndex:"+a),/firefox/i.test(m)?a>=6?(v=5,g=new Array(4),T=a-3):(v=2,g=new Array(2),T=a):m.indexOf("android")!==-1?(v=2,g=new Array(2),T=a):(v=5,g=new Array(4),L&&(L.indexOf("mp4a.40.29")!==-1||L.indexOf("mp4a.40.5")!==-1)||!L&&a>=6?T=a-3:((L&&L.indexOf("mp4a.40.2")!==-1&&(a>=6&&M===1||/vivaldi/i.test(m))||!L&&M===1)&&(v=2,g=new Array(2)),T=a)),g[0]=v<<3,g[0]|=(a&14)>>1,g[1]|=(a&1)<<7,g[1]|=M<<3,v===5&&(g[1]|=(T&14)>>1,g[2]=(T&1)<<7,g[2]|=8,g[3]=0),{config:g,samplerate:p[a],channelCount:M,codec:"mp4a.40."+v,manifestCodec:l}}function B(c,h){return c[h]===255&&(c[h+1]&246)===240}function F(c,h){return c[h+1]&1?7:9}function R(c,h){return(c[h+3]&3)<<11|c[h+4]<<3|(c[h+5]&224)>>>5}function b(c,h){return h+5<c.length}function S(c,h){return h+1<c.length&&B(c,h)}function y(c,h){return b(c,h)&&B(c,h)&&R(c,h)<=c.length-h}function s(c,h){if(S(c,h)){var _=F(c,h);if(h+_>=c.length)return!1;var L=R(c,h);if(L<=_)return!1;var v=h+L;return v===c.length||S(c,v)}return!1}function D(c,h,_,L,v){if(!c.samplerate){var T=O(h,_,L,v);if(!T)return;c.config=T.config,c.samplerate=T.samplerate,c.channelCount=T.channelCount,c.codec=T.codec,c.manifestCodec=T.manifestCodec,w.logger.log("parsed codec:"+c.codec+", rate:"+T.samplerate+", channels:"+T.channelCount)}}function x(c){return 9216e4/c}function f(c,h){var _=F(c,h);if(h+_<=c.length){var L=R(c,h)-_;if(L>0)return{headerLength:_,frameLength:L}}}function d(c,h,_,L,v){var T=x(c.samplerate),M=L+v*T,g=f(h,_),m;if(g){var l=g.frameLength,p=g.headerLength,a=p+l,E=Math.max(0,_+a-h.length);E?(m=new Uint8Array(a-p),m.set(h.subarray(_+p,h.length),0)):m=h.subarray(_+p,_+a);var k={unit:m,pts:M};return E||c.samples.push(k),{sample:k,length:a,missing:E}}var P=h.length-_;m=new Uint8Array(P),m.set(h.subarray(_,h.length),0);var U={unit:m,pts:M};return{sample:U,length:P,missing:-1}}},"./src/demux/base-audio-demuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>S,initPTSFn:()=>b});var w=o("./src/polyfills/number.ts"),A=o("./src/demux/id3.ts"),N=o("./src/types/demuxer.ts"),O=o("./src/demux/dummy-demuxed-track.ts"),B=o("./src/utils/mp4-tools.ts"),F=o("./src/utils/typed-array.ts"),R=function(){function y(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var s=y.prototype;return s.resetInitSegment=function(x,f,d,c){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},s.resetTimeStamp=function(x){this.initPTS=x,this.resetContiguity()},s.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},s.canParse=function(x,f){return!1},s.appendFrame=function(x,f,d){},s.demux=function(x,f){this.cachedData&&(x=(0,B.appendUint8Array)(this.cachedData,x),this.cachedData=null);var d=A.getID3Data(x,0),c=d?d.length:0,h,_=this._audioTrack,L=this._id3Track,v=d?A.getTimeStamp(d):void 0,T=x.length;for((this.basePTS===null||this.frameIndex===0&&(0,w.isFiniteNumber)(v))&&(this.basePTS=b(v,f,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),d&&d.length>0&&L.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:d,type:N.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});c<T;){if(this.canParse(x,c)){var M=this.appendFrame(_,x,c);M?(this.frameIndex++,this.lastPTS=M.sample.pts,c+=M.length,h=c):c=T}else A.canParse(x,c)?(d=A.getID3Data(x,c),L.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:d,type:N.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),c+=d.length,h=c):c++;if(c===T&&h!==T){var g=(0,F.sliceUint8)(x,h);this.cachedData?this.cachedData=(0,B.appendUint8Array)(this.cachedData,g):this.cachedData=g}}return{audioTrack:_,videoTrack:(0,O.dummyTrack)(),id3Track:L,textTrack:(0,O.dummyTrack)()}},s.demuxSampleAes=function(x,f,d){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},s.flush=function(x){var f=this.cachedData;return f&&(this.cachedData=null,this.demux(f,0)),{audioTrack:this._audioTrack,videoTrack:(0,O.dummyTrack)(),id3Track:this._id3Track,textTrack:(0,O.dummyTrack)()}},s.destroy=function(){},y}(),b=function(s,D,x){return(0,w.isFiniteNumber)(s)?s*90:D*9e4+(x||0)};const S=R},"./src/demux/chunk-cache.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>w});var w=function(){function N(){this.chunks=[],this.dataLength=0}var O=N.prototype;return O.push=function(F){this.chunks.push(F),this.dataLength+=F.length},O.flush=function(){var F=this.chunks,R=this.dataLength,b;if(F.length)F.length===1?b=F[0]:b=A(F,R);else return new Uint8Array(0);return this.reset(),b},O.reset=function(){this.chunks.length=0,this.dataLength=0},N}();function A(N,O){for(var B=new Uint8Array(O),F=0,R=0;R<N.length;R++){var b=N[R];B.set(b,F),F+=b.length}return B}},"./src/demux/dummy-demuxed-track.ts":(C,I,o)=>{o.r(I),o.d(I,{dummyTrack:()=>w});function w(A,N){return A===void 0&&(A=""),N===void 0&&(N=9e4),{type:A,id:-1,pid:-1,inputTimeScale:N,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>N});var w=o("./src/utils/logger.ts"),A=function(){function O(F){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=F,this.bytesAvailable=F.byteLength,this.word=0,this.bitsAvailable=0}var B=O.prototype;return B.loadWord=function(){var R=this.data,b=this.bytesAvailable,S=R.byteLength-b,y=new Uint8Array(4),s=Math.min(4,b);if(s===0)throw new Error("no bytes available");y.set(R.subarray(S,S+s)),this.word=new DataView(y.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s},B.skipBits=function(R){var b;R=Math.min(R,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>R?(this.word<<=R,this.bitsAvailable-=R):(R-=this.bitsAvailable,b=R>>3,R-=b<<3,this.bytesAvailable-=b,this.loadWord(),this.word<<=R,this.bitsAvailable-=R)},B.readBits=function(R){var b=Math.min(this.bitsAvailable,R),S=this.word>>>32-b;if(R>32&&w.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=b,this.bitsAvailable>0)this.word<<=b;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return b=R-b,b>0&&this.bitsAvailable?S<<b|this.readBits(b):S},B.skipLZ=function(){var R;for(R=0;R<this.bitsAvailable;++R)if(this.word&2147483648>>>R)return this.word<<=R,this.bitsAvailable-=R,R;return this.loadWord(),R+this.skipLZ()},B.skipUEG=function(){this.skipBits(1+this.skipLZ())},B.skipEG=function(){this.skipBits(1+this.skipLZ())},B.readUEG=function(){var R=this.skipLZ();return this.readBits(R+1)-1},B.readEG=function(){var R=this.readUEG();return 1&R?1+R>>>1:-1*(R>>>1)},B.readBoolean=function(){return this.readBits(1)===1},B.readUByte=function(){return this.readBits(8)},B.readUShort=function(){return this.readBits(16)},B.readUInt=function(){return this.readBits(32)},B.skipScalingList=function(R){for(var b=8,S=8,y,s=0;s<R;s++)S!==0&&(y=this.readEG(),S=(b+y+256)%256),b=S===0?b:S},B.readSPS=function(){var R=0,b=0,S=0,y=0,s,D,x,f=this.readUByte.bind(this),d=this.readBits.bind(this),c=this.readUEG.bind(this),h=this.readBoolean.bind(this),_=this.skipBits.bind(this),L=this.skipEG.bind(this),v=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);f();var M=f();if(d(5),_(3),f(),v(),M===100||M===110||M===122||M===244||M===44||M===83||M===86||M===118||M===128){var g=c();if(g===3&&_(1),v(),v(),_(1),h())for(D=g!==3?8:12,x=0;x<D;x++)h()&&(x<6?T(16):T(64))}v();var m=c();if(m===0)c();else if(m===1)for(_(1),L(),L(),s=c(),x=0;x<s;x++)L();v(),_(1);var l=c(),p=c(),a=d(1);a===0&&_(1),_(1),h()&&(R=c(),b=c(),S=c(),y=c());var E=[1,1];if(h()&&h()){var k=f();switch(k){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:{E=[f()<<8|f(),f()<<8|f()];break}}}return{width:Math.ceil((l+1)*16-R*2-b*2),height:(2-a)*(p+1)*16-(a?2:4)*(S+y),pixelRatio:E}},B.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},O}();const N=A},"./src/demux/id3.ts":(C,I,o)=>{o.r(I),o.d(I,{canParse:()=>B,decodeFrame:()=>y,getID3Data:()=>N,getID3Frames:()=>S,getTimeStamp:()=>F,isFooter:()=>A,isHeader:()=>w,isTimeStampFrame:()=>R,testables:()=>c,utf8ArrayToStr:()=>d});var w=function(v,T){return T+10<=v.length&&v[T]===73&&v[T+1]===68&&v[T+2]===51&&v[T+3]<255&&v[T+4]<255&&v[T+6]<128&&v[T+7]<128&&v[T+8]<128&&v[T+9]<128},A=function(v,T){return T+10<=v.length&&v[T]===51&&v[T+1]===68&&v[T+2]===73&&v[T+3]<255&&v[T+4]<255&&v[T+6]<128&&v[T+7]<128&&v[T+8]<128&&v[T+9]<128},N=function(v,T){for(var M=T,g=0;w(v,T);){g+=10;var m=O(v,T+6);g+=m,A(v,T+10)&&(g+=10),T+=g}if(g>0)return v.subarray(M,M+g)},O=function(v,T){var M=0;return M=(v[T]&127)<<21,M|=(v[T+1]&127)<<14,M|=(v[T+2]&127)<<7,M|=v[T+3]&127,M},B=function(v,T){return w(v,T)&&O(v,T+6)+10<=v.length-T},F=function(v){for(var T=S(v),M=0;M<T.length;M++){var g=T[M];if(R(g))return f(g)}},R=function(v){return v&&v.key==="PRIV"&&v.info==="com.apple.streaming.transportStreamTimestamp"},b=function(v){var T=String.fromCharCode(v[0],v[1],v[2],v[3]),M=O(v,4),g=10;return{type:T,size:M,data:v.subarray(g,g+M)}},S=function(v){for(var T=0,M=[];w(v,T);){var g=O(v,T+6);T+=10;for(var m=T+g;T+8<m;){var l=b(v.subarray(T)),p=y(l);p&&M.push(p),T+=l.size+10}A(v,T)&&(T+=10)}return M},y=function(v){return v.type==="PRIV"?s(v):v.type[0]==="W"?x(v):D(v)},s=function(v){if(!(v.size<2)){var T=d(v.data,!0),M=new Uint8Array(v.data.subarray(T.length+1));return{key:v.type,info:T,data:M.buffer}}},D=function(v){if(!(v.size<2)){if(v.type==="TXXX"){var T=1,M=d(v.data.subarray(T),!0);T+=M.length+1;var g=d(v.data.subarray(T));return{key:v.type,info:M,data:g}}var m=d(v.data.subarray(1));return{key:v.type,data:m}}},x=function(v){if(v.type==="WXXX"){if(v.size<2)return;var T=1,M=d(v.data.subarray(T),!0);T+=M.length+1;var g=d(v.data.subarray(T));return{key:v.type,info:M,data:g}}var m=d(v.data);return{key:v.type,data:m}},f=function(v){if(v.data.byteLength===8){var T=new Uint8Array(v.data),M=T[3]&1,g=(T[4]<<23)+(T[5]<<15)+(T[6]<<7)+T[7];return g/=45,M&&(g+=4772185884e-2),Math.round(g)}},d=function(v,T){T===void 0&&(T=!1);var M=_();if(M){var g=M.decode(v);if(T){var m=g.indexOf("\0");return m!==-1?g.substring(0,m):g}return g.replace(/\0/g,"")}for(var l=v.length,p,a,E,k="",P=0;P<l;){if(p=v[P++],p===0&&T)return k;if(p===0||p===3)continue;switch(p>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:k+=String.fromCharCode(p);break;case 12:case 13:a=v[P++],k+=String.fromCharCode((p&31)<<6|a&63);break;case 14:a=v[P++],E=v[P++],k+=String.fromCharCode((p&15)<<12|(a&63)<<6|(E&63)<<0);break}}return k},c={decodeTextFrame:D},h;function _(){return!h&&typeof self.TextDecoder<"u"&&(h=new self.TextDecoder("utf-8")),h}},"./src/demux/mp3demuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>b});var w=o("./src/demux/base-audio-demuxer.ts"),A=o("./src/demux/id3.ts"),N=o("./src/utils/logger.ts"),O=o("./src/demux/mpegaudio.ts");function B(S,y){S.prototype=Object.create(y.prototype),S.prototype.constructor=S,F(S,y)}function F(S,y){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,x){return D.__proto__=x,D},F(S,y)}var R=function(S){B(y,S);function y(){return S.apply(this,arguments)||this}var s=y.prototype;return s.resetInitSegment=function(x,f,d,c){S.prototype.resetInitSegment.call(this,x,f,d,c),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:f,duration:c,inputTimeScale:9e4,dropped:0}},y.probe=function(x){if(!x)return!1;for(var f=A.getID3Data(x,0)||[],d=f.length,c=x.length;d<c;d++)if(O.probe(x,d))return N.logger.log("MPEG Audio sync word found !"),!0;return!1},s.canParse=function(x,f){return O.canParse(x,f)},s.appendFrame=function(x,f,d){if(this.basePTS!==null)return O.appendFrame(x,f,d,this.basePTS,this.frameIndex)},y}(w.default);const b=R},"./src/demux/mp4demuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>R});var w=o("./src/polyfills/number.ts"),A=o("./src/types/demuxer.ts"),N=o("./src/utils/mp4-tools.ts"),O=o("./src/demux/dummy-demuxed-track.ts"),B=/\/emsg[-/]ID3/i,F=function(){function b(y,s){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=s}var S=b.prototype;return S.resetTimeStamp=function(){},S.resetInitSegment=function(s,D,x,f){var d=this.videoTrack=(0,O.dummyTrack)("video",1),c=this.audioTrack=(0,O.dummyTrack)("audio",1),h=this.txtTrack=(0,O.dummyTrack)("text",1);if(this.id3Track=(0,O.dummyTrack)("id3",1),this.timeOffset=0,!(!s||!s.byteLength)){var _=(0,N.parseInitSegment)(s);if(_.video){var L=_.video,v=L.id,T=L.timescale,M=L.codec;d.id=v,d.timescale=h.timescale=T,d.codec=M}if(_.audio){var g=_.audio,m=g.id,l=g.timescale,p=g.codec;c.id=m,c.timescale=l,c.codec=p}h.id=N.RemuxerTrackIdConfig.text,d.sampleDuration=0,d.duration=c.duration=f}},S.resetContiguity=function(){},b.probe=function(s){return s=s.length>16384?s.subarray(0,16384):s,(0,N.findBox)(s,["moof"]).length>0},S.demux=function(s,D){this.timeOffset=D;var x=s,f=this.videoTrack,d=this.txtTrack;if(this.config.progressive){this.remainderData&&(x=(0,N.appendUint8Array)(this.remainderData,s));var c=(0,N.segmentValidRange)(x);this.remainderData=c.remainder,f.samples=c.valid||new Uint8Array}else f.samples=x;var h=this.extractID3Track(f,D);return d.samples=(0,N.parseSamples)(D,f),{videoTrack:f,audioTrack:this.audioTrack,id3Track:h,textTrack:this.txtTrack}},S.flush=function(){var s=this.timeOffset,D=this.videoTrack,x=this.txtTrack;D.samples=this.remainderData||new Uint8Array,this.remainderData=null;var f=this.extractID3Track(D,this.timeOffset);return x.samples=(0,N.parseSamples)(s,D),{videoTrack:D,audioTrack:(0,O.dummyTrack)(),id3Track:f,textTrack:(0,O.dummyTrack)()}},S.extractID3Track=function(s,D){var x=this.id3Track;if(s.samples.length){var f=(0,N.findBox)(s.samples,["emsg"]);f&&f.forEach(function(d){var c=(0,N.parseEmsg)(d);if(B.test(c.schemeIdUri)){var h=(0,w.isFiniteNumber)(c.presentationTime)?c.presentationTime/c.timeScale:D+c.presentationTimeDelta/c.timeScale,_=c.eventDuration===4294967295?Number.POSITIVE_INFINITY:c.eventDuration/c.timeScale;_<=.001&&(_=Number.POSITIVE_INFINITY);var L=c.payload;x.samples.push({data:L,len:L.byteLength,dts:h,pts:h,type:A.MetadataSchema.emsg,duration:_})}})}return x},S.demuxSampleAes=function(s,D,x){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},S.destroy=function(){},b}();const R=F},"./src/demux/mpegaudio.ts":(C,I,o)=>{o.r(I),o.d(I,{appendFrame:()=>F,canParse:()=>y,isHeader:()=>S,isHeaderPattern:()=>b,parseHeader:()=>R,probe:()=>s});var w=null,A=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],N=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],O=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],B=[0,1,1,4];function F(D,x,f,d,c){if(!(f+24>x.length)){var h=R(x,f);if(h&&f+h.frameLength<=x.length){var _=h.samplesPerFrame*9e4/h.sampleRate,L=d+c*_,v={unit:x.subarray(f,f+h.frameLength),pts:L,dts:L};return D.config=[],D.channelCount=h.channelCount,D.samplerate=h.sampleRate,D.samples.push(v),{sample:v,length:h.frameLength,missing:0}}}}function R(D,x){var f=D[x+1]>>3&3,d=D[x+1]>>1&3,c=D[x+2]>>4&15,h=D[x+2]>>2&3;if(f!==1&&c!==0&&c!==15&&h!==3){var _=D[x+2]>>1&1,L=D[x+3]>>6,v=f===3?3-d:d===3?3:4,T=A[v*14+c-1]*1e3,M=f===3?0:f===2?1:2,g=N[M*3+h],m=L===3?1:2,l=O[f][d],p=B[d],a=l*8*p,E=Math.floor(l*T/g+_)*p;if(w===null){var k=navigator.userAgent||"",P=k.match(/Chrome\/(\d+)/i);w=P?parseInt(P[1]):0}var U=!!w&&w<=87;return U&&d===2&&T>=224e3&&L===0&&(D[x+3]=D[x+3]|128),{sampleRate:g,channelCount:m,frameLength:E,samplesPerFrame:a}}}function b(D,x){return D[x]===255&&(D[x+1]&224)===224&&(D[x+1]&6)!==0}function S(D,x){return x+1<D.length&&b(D,x)}function y(D,x){var f=4;return b(D,x)&&f<=D.length-x}function s(D,x){if(x+1<D.length&&b(D,x)){var f=4,d=R(D,x),c=f;d!=null&&d.frameLength&&(c=d.frameLength);var h=x+c;return h===D.length||S(D,h)}return!1}},"./src/demux/sample-aes.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>O});var w=o("./src/crypt/decrypter.ts"),A=o("./src/utils/mp4-tools.ts"),N=function(){function B(R,b,S){this.keyData=void 0,this.decrypter=void 0,this.keyData=S,this.decrypter=new w.default(b,{removePKCS7Padding:!1})}var F=B.prototype;return F.decryptBuffer=function(b){return this.decrypter.decrypt(b,this.keyData.key.buffer,this.keyData.iv.buffer)},F.decryptAacSample=function(b,S,y){var s=this,D=b[S].unit;if(!(D.length<=16)){var x=D.subarray(16,D.length-D.length%16),f=x.buffer.slice(x.byteOffset,x.byteOffset+x.length);this.decryptBuffer(f).then(function(d){var c=new Uint8Array(d);D.set(c,16),s.decrypter.isSync()||s.decryptAacSamples(b,S+1,y)})}},F.decryptAacSamples=function(b,S,y){for(;;S++){if(S>=b.length){y();return}if(!(b[S].unit.length<32)&&(this.decryptAacSample(b,S,y),!this.decrypter.isSync()))return}},F.getAvcEncryptedData=function(b){for(var S=Math.floor((b.length-48)/160)*16+16,y=new Int8Array(S),s=0,D=32;D<b.length-16;D+=160,s+=16)y.set(b.subarray(D,D+16),s);return y},F.getAvcDecryptedUnit=function(b,S){for(var y=new Uint8Array(S),s=0,D=32;D<b.length-16;D+=160,s+=16)b.set(y.subarray(s,s+16),D);return b},F.decryptAvcSample=function(b,S,y,s,D){var x=this,f=(0,A.discardEPB)(D.data),d=this.getAvcEncryptedData(f);this.decryptBuffer(d.buffer).then(function(c){D.data=x.getAvcDecryptedUnit(f,c),x.decrypter.isSync()||x.decryptAvcSamples(b,S,y+1,s)})},F.decryptAvcSamples=function(b,S,y,s){if(b instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;S++,y=0){if(S>=b.length){s();return}for(var D=b[S].units;!(y>=D.length);y++){var x=D[y];if(!(x.data.length<=48||x.type!==1&&x.type!==5)&&(this.decryptAvcSample(b,S,y,s,x),!this.decrypter.isSync()))return}}},B}();const O=N},"./src/demux/transmuxer-interface.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>S});var w=o("./src/demux/webworkify-webpack.js"),A=o("./src/events.ts"),N=o("./src/demux/transmuxer.ts"),O=o("./src/utils/logger.ts"),B=o("./src/errors.ts"),F=o("./src/utils/mediasource-helper.ts"),R=o("./node_modules/eventemitter3/index.js"),b=(0,F.getMediaSource)()||{isTypeSupported:function(){return!1}},S=function(){function y(D,x,f,d){var c=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var h=D.config;this.hls=D,this.id=x,this.useWorker=!!h.enableWorker,this.onTransmuxComplete=f,this.onFlush=d;var _=function(g,m){m=m||{},m.frag=c.frag,m.id=c.id,c.hls.trigger(g,m)};this.observer=new R.EventEmitter,this.observer.on(A.Events.FRAG_DECRYPTED,_),this.observer.on(A.Events.ERROR,_);var L={mp4:b.isTypeSupported("video/mp4"),mpeg:b.isTypeSupported("audio/mpeg"),mp3:b.isTypeSupported('audio/mp4; codecs="mp3"')},v=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){O.logger.log("demuxing in webworker");var T;try{T=this.worker=(0,w.default)("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),T.addEventListener("message",this.onwmsg),T.onerror=function(M){c.useWorker=!1,O.logger.warn("Exception in webworker, fallback to inline"),c.hls.trigger(A.Events.ERROR,{type:B.ErrorTypes.OTHER_ERROR,details:B.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(M.message+"  ("+M.filename+":"+M.lineno+")")})},T.postMessage({cmd:"init",typeSupported:L,vendor:v,id:x,config:JSON.stringify(h)})}catch(M){O.logger.warn("Error in worker:",M),O.logger.error("Error while initializing DemuxerWorker, fallback to inline"),T&&self.URL.revokeObjectURL(T.objectURL),this.transmuxer=new N.default(this.observer,L,h,v,x),this.worker=null}}else this.transmuxer=new N.default(this.observer,L,h,v,x)}var s=y.prototype;return s.destroy=function(){var x=this.worker;if(x)x.removeEventListener("message",this.onwmsg),x.terminate(),this.worker=null,this.onwmsg=void 0;else{var f=this.transmuxer;f&&(f.destroy(),this.transmuxer=null)}var d=this.observer;d&&d.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},s.push=function(x,f,d,c,h,_,L,v,T,M){var g,m,l=this;T.transmuxing.start=self.performance.now();var p=this.transmuxer,a=this.worker,E=_?_.start:h.start,k=h.decryptdata,P=this.frag,U=!(P&&h.cc===P.cc),K=!(P&&T.level===P.level),W=P?T.sn-P.sn:-1,G=this.part?T.part-this.part.index:-1,j=W===0&&T.id>1&&T.id===(P==null?void 0:P.stats.chunkCount),H=!K&&(W===1||W===0&&(G===1||j&&G<=0)),V=self.performance.now();(K||W||h.stats.parsing.start===0)&&(h.stats.parsing.start=V),_&&(G||!H)&&(_.stats.parsing.start=V);var z=!(P&&((g=h.initSegment)===null||g===void 0?void 0:g.url)===((m=P.initSegment)===null||m===void 0?void 0:m.url)),$=new N.TransmuxState(U,H,v,K,E,z);if(!H||U||z){O.logger.log("[transmuxer-interface, "+h.type+"]: Starting new transmux session for sn: "+T.sn+" p: "+T.part+" level: "+T.level+" id: "+T.id+`
        discontinuity: `+U+`
        trackSwitch: `+K+`
        contiguous: `+H+`
        accurateTimeOffset: `+v+`
        timeOffset: `+E+`
        initSegmentChange: `+z);var Y=new N.TransmuxConfig(d,c,f,L,M);this.configureTransmuxer(Y)}if(this.frag=h,this.part=_,a)a.postMessage({cmd:"demux",data:x,decryptdata:k,chunkMeta:T,state:$},x instanceof ArrayBuffer?[x]:[]);else if(p){var X=p.push(x,k,T,$);(0,N.isPromise)(X)?(p.async=!0,X.then(function(Z){l.handleTransmuxComplete(Z)}).catch(function(Z){l.transmuxerError(Z,T,"transmuxer-interface push error")})):(p.async=!1,this.handleTransmuxComplete(X))}},s.flush=function(x){var f=this;x.transmuxing.start=self.performance.now();var d=this.transmuxer,c=this.worker;if(c)c.postMessage({cmd:"flush",chunkMeta:x});else if(d){var h=d.flush(x),_=(0,N.isPromise)(h);_||d.async?((0,N.isPromise)(h)||(h=Promise.resolve(h)),h.then(function(L){f.handleFlushResult(L,x)}).catch(function(L){f.transmuxerError(L,x,"transmuxer-interface flush error")})):this.handleFlushResult(h,x)}},s.transmuxerError=function(x,f,d){this.hls&&this.hls.trigger(A.Events.ERROR,{type:B.ErrorTypes.MEDIA_ERROR,details:B.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:f,fatal:!1,error:x,err:x,reason:d})},s.handleFlushResult=function(x,f){var d=this;x.forEach(function(c){d.handleTransmuxComplete(c)}),this.onFlush(f)},s.onWorkerMessage=function(x){var f=x.data,d=this.hls;switch(f.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(f.data);break}case"flush":{this.onFlush(f.data);break}case"workerLog":O.logger[f.data.logType]&&O.logger[f.data.logType](f.data.message);break;default:{f.data=f.data||{},f.data.frag=this.frag,f.data.id=this.id,d.trigger(f.event,f.data);break}}},s.configureTransmuxer=function(x){var f=this.worker,d=this.transmuxer;f?f.postMessage({cmd:"configure",config:x}):d&&d.configure(x)},s.handleTransmuxComplete=function(x){x.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(x)},y}()},"./src/demux/transmuxer-worker.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>F});var w=o("./src/demux/transmuxer.ts"),A=o("./src/events.ts"),N=o("./src/utils/logger.ts"),O=o("./node_modules/eventemitter3/index.js"),B=o("./src/errors.ts");function F(s){var D=new O.EventEmitter,x=function(c,h){s.postMessage({event:c,data:h})};D.on(A.Events.FRAG_DECRYPTED,x),D.on(A.Events.ERROR,x);var f=function(){var c=function(L){var v=function(M){x("workerLog",{logType:L,message:M})};N.logger[L]=v};for(var h in N.logger)c(h)};s.addEventListener("message",function(d){var c=d.data;switch(c.cmd){case"init":{var h=JSON.parse(c.config);s.transmuxer=new w.default(D,c.typeSupported,h,c.vendor,c.id),(0,N.enableLogs)(h.debug,c.id),f(),x("init",null);break}case"configure":{s.transmuxer.configure(c.config);break}case"demux":{var _=s.transmuxer.push(c.data,c.decryptdata,c.chunkMeta,c.state);(0,w.isPromise)(_)?(s.transmuxer.async=!0,_.then(function(M){R(s,M)}).catch(function(M){x(A.Events.ERROR,{type:B.ErrorTypes.MEDIA_ERROR,details:B.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:c.chunkMeta,fatal:!1,error:M,err:M,reason:"transmuxer-worker push error"})})):(s.transmuxer.async=!1,R(s,_));break}case"flush":{var L=c.chunkMeta,v=s.transmuxer.flush(L),T=(0,w.isPromise)(v);T||s.transmuxer.async?((0,w.isPromise)(v)||(v=Promise.resolve(v)),v.then(function(M){S(s,M,L)}).catch(function(M){x(A.Events.ERROR,{type:B.ErrorTypes.MEDIA_ERROR,details:B.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:c.chunkMeta,fatal:!1,error:M,err:M,reason:"transmuxer-worker flush error"})})):S(s,v,L);break}}})}function R(s,D){if(y(D.remuxResult))return!1;var x=[],f=D.remuxResult,d=f.audio,c=f.video;return d&&b(x,d),c&&b(x,c),s.postMessage({event:"transmuxComplete",data:D},x),!0}function b(s,D){D.data1&&s.push(D.data1.buffer),D.data2&&s.push(D.data2.buffer)}function S(s,D,x){var f=D.reduce(function(d,c){return R(s,c)||d},!1);f||s.postMessage({event:"transmuxComplete",data:D[0]}),s.postMessage({event:"flush",data:x})}function y(s){return!s.audio&&!s.video&&!s.text&&!s.id3&&!s.initSegment}},"./src/demux/transmuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{TransmuxConfig:()=>h,TransmuxState:()=>_,default:()=>x,isPromise:()=>c});var w=o("./src/events.ts"),A=o("./src/errors.ts"),N=o("./src/crypt/decrypter.ts"),O=o("./src/demux/aacdemuxer.ts"),B=o("./src/demux/mp4demuxer.ts"),F=o("./src/demux/tsdemuxer.ts"),R=o("./src/demux/mp3demuxer.ts"),b=o("./src/remux/mp4-remuxer.ts"),S=o("./src/remux/passthrough-remuxer.ts"),y=o("./src/utils/logger.ts"),s;try{s=self.performance.now.bind(self.performance)}catch{y.logger.debug("Unable to use Performance API on this environment"),s=self.Date.now}var D=[{demux:B.default,remux:S.default},{demux:F.default,remux:b.default},{demux:O.default,remux:b.default},{demux:R.default,remux:b.default}],x=function(){function L(T,M,g,m,l){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=T,this.typeSupported=M,this.config=g,this.vendor=m,this.id=l}var v=L.prototype;return v.configure=function(M){this.transmuxConfig=M,this.decrypter&&this.decrypter.reset()},v.push=function(M,g,m,l){var p=this,a=m.transmuxing;a.executeStart=s();var E=new Uint8Array(M),k=this.currentTransmuxState,P=this.transmuxConfig;l&&(this.currentTransmuxState=l);var U=l||k,K=U.contiguous,W=U.discontinuity,G=U.trackSwitch,j=U.accurateTimeOffset,H=U.timeOffset,V=U.initSegmentChange,z=P.audioCodec,$=P.videoCodec,Y=P.defaultInitPts,X=P.duration,Z=P.initSegmentData,Q=f(E,g);if(Q&&Q.method==="AES-128"){var J=this.getDecrypter();if(J.isSync()){var re=J.softwareDecrypt(E,Q.key.buffer,Q.iv.buffer),se=m.part>-1;if(se&&(re=J.flush()),!re)return a.executeEnd=s(),d(m);E=new Uint8Array(re)}else return this.decryptionPromise=J.webCryptoDecrypt(E,Q.key.buffer,Q.iv.buffer).then(function(le){var fe=p.push(le,null,m);return p.decryptionPromise=null,fe}),this.decryptionPromise}var ie=this.needsProbing(W,G);ie&&this.configureTransmuxer(E),(W||G||V||ie)&&this.resetInitSegment(Z,z,$,X,g),(W||V||ie)&&this.resetInitialTimestamp(Y),K||this.resetContiguity();var q=this.transmux(E,Q,H,j,m),oe=this.currentTransmuxState;return oe.contiguous=!0,oe.discontinuity=!1,oe.trackSwitch=!1,a.executeEnd=s(),q},v.flush=function(M){var g=this,m=M.transmuxing;m.executeStart=s();var l=this.decrypter,p=this.currentTransmuxState,a=this.decryptionPromise;if(a)return a.then(function(){return g.flush(M)});var E=[],k=p.timeOffset;if(l){var P=l.flush();P&&E.push(this.push(P,null,M))}var U=this.demuxer,K=this.remuxer;if(!U||!K)return this.observer.emit(w.Events.ERROR,w.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),m.executeEnd=s(),[d(M)];var W=U.flush(k);return c(W)?W.then(function(G){return g.flushRemux(E,G,M),E}):(this.flushRemux(E,W,M),E)},v.flushRemux=function(M,g,m){var l=g.audioTrack,p=g.videoTrack,a=g.id3Track,E=g.textTrack,k=this.currentTransmuxState,P=k.accurateTimeOffset,U=k.timeOffset;y.logger.log("[transmuxer.ts]: Flushed fragment "+m.sn+(m.part>-1?" p: "+m.part:"")+" of level "+m.level);var K=this.remuxer.remux(l,p,a,E,U,P,!0,this.id);M.push({remuxResult:K,chunkMeta:m}),m.transmuxing.executeEnd=s()},v.resetInitialTimestamp=function(M){var g=this.demuxer,m=this.remuxer;!g||!m||(g.resetTimeStamp(M),m.resetTimeStamp(M))},v.resetContiguity=function(){var M=this.demuxer,g=this.remuxer;!M||!g||(M.resetContiguity(),g.resetNextTimestamp())},v.resetInitSegment=function(M,g,m,l,p){var a=this.demuxer,E=this.remuxer;!a||!E||(a.resetInitSegment(M,g,m,l),E.resetInitSegment(M,g,m,p))},v.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},v.transmux=function(M,g,m,l,p){var a;return g&&g.method==="SAMPLE-AES"?a=this.transmuxSampleAes(M,g,m,l,p):a=this.transmuxUnencrypted(M,m,l,p),a},v.transmuxUnencrypted=function(M,g,m,l){var p=this.demuxer.demux(M,g,!1,!this.config.progressive),a=p.audioTrack,E=p.videoTrack,k=p.id3Track,P=p.textTrack,U=this.remuxer.remux(a,E,k,P,g,m,!1,this.id);return{remuxResult:U,chunkMeta:l}},v.transmuxSampleAes=function(M,g,m,l,p){var a=this;return this.demuxer.demuxSampleAes(M,g,m).then(function(E){var k=a.remuxer.remux(E.audioTrack,E.videoTrack,E.id3Track,E.textTrack,m,l,!1,a.id);return{remuxResult:k,chunkMeta:p}})},v.configureTransmuxer=function(M){for(var g=this.config,m=this.observer,l=this.typeSupported,p=this.vendor,a,E=0,k=D.length;E<k;E++)if(D[E].demux.probe(M)){a=D[E];break}a||(y.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),a={demux:B.default,remux:S.default});var P=this.demuxer,U=this.remuxer,K=a.remux,W=a.demux;(!U||!(U instanceof K))&&(this.remuxer=new K(m,g,l,p)),(!P||!(P instanceof W))&&(this.demuxer=new W(m,g,l),this.probe=W.probe)},v.needsProbing=function(M,g){return!this.demuxer||!this.remuxer||M||g},v.getDecrypter=function(){var M=this.decrypter;return M||(M=this.decrypter=new N.default(this.config)),M},L}();function f(L,v){var T=null;return L.byteLength>0&&v!=null&&v.key!=null&&v.iv!==null&&v.method!=null&&(T=v),T}var d=function(v){return{remuxResult:{},chunkMeta:v}};function c(L){return"then"in L&&L.then instanceof Function}var h=function(v,T,M,g,m){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=v,this.videoCodec=T,this.initSegmentData=M,this.duration=g,this.defaultInitPts=m},_=function(v,T,M,g,m,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=v,this.contiguous=T,this.accurateTimeOffset=M,this.trackSwitch=g,this.timeOffset=m,this.initSegmentChange=l}},"./src/demux/tsdemuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>L});var w=o("./src/demux/adts.ts"),A=o("./src/demux/mpegaudio.ts"),N=o("./src/demux/exp-golomb.ts"),O=o("./src/demux/sample-aes.ts"),B=o("./src/events.ts"),F=o("./src/utils/mp4-tools.ts"),R=o("./src/utils/logger.ts"),b=o("./src/errors.ts"),S=o("./src/types/demuxer.ts");function y(){return y=Object.assign?Object.assign.bind():function(v){for(var T=1;T<arguments.length;T++){var M=arguments[T];for(var g in M)Object.prototype.hasOwnProperty.call(M,g)&&(v[g]=M[g])}return v},y.apply(this,arguments)}var s=188,D=function(){function v(M,g,m){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=M,this.config=g,this.typeSupported=m}v.probe=function(g){var m=v.syncOffset(g);return m>0&&R.logger.warn("MPEG2-TS detected but first sync word found @ offset "+m),m!==-1},v.syncOffset=function(g){for(var m=g.length,l=Math.min(s*5,g.length-s)+1,p=0;p<l;){for(var a=!1,E=p;E<m&&g[E]===71;E+=s)if(!a&&f(g,E)===0&&(a=!0),a&&E+s>l)return p;p++}return-1},v.createTrack=function(g,m){return{container:g==="video"||g==="audio"?"video/mp2t":void 0,type:g,id:F.RemuxerTrackIdConfig[g],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:g==="audio"?m:void 0}};var T=v.prototype;return T.resetInitSegment=function(g,m,l,p){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=v.createTrack("video"),this._audioTrack=v.createTrack("audio",p),this._id3Track=v.createTrack("id3"),this._txtTrack=v.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=m,this.videoCodec=l,this._duration=p},T.resetTimeStamp=function(){},T.resetContiguity=function(){var g=this._audioTrack,m=this._avcTrack,l=this._id3Track;g&&(g.pesData=null),m&&(m.pesData=null),l&&(l.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},T.demux=function(g,m,l,p){l===void 0&&(l=!1),p===void 0&&(p=!1),l||(this.sampleAes=null);var a,E=this._avcTrack,k=this._audioTrack,P=this._id3Track,U=this._txtTrack,K=E.pid,W=E.pesData,G=k.pid,j=P.pid,H=k.pesData,V=P.pesData,z=null,$=this.pmtParsed,Y=this._pmtId,X=g.length;if(this.remainderData&&(g=(0,F.appendUint8Array)(this.remainderData,g),X=g.length,this.remainderData=null),X<s&&!p)return this.remainderData=g,{audioTrack:k,videoTrack:E,id3Track:P,textTrack:U};var Z=Math.max(0,v.syncOffset(g));X-=(X-Z)%s,X<g.byteLength&&!p&&(this.remainderData=new Uint8Array(g.buffer,X,g.buffer.byteLength-X));for(var Q=0,J=Z;J<X;J+=s)if(g[J]===71){var re=!!(g[J+1]&64),se=f(g,J),ie=(g[J+3]&48)>>4,q=void 0;if(ie>1){if(q=J+5+g[J+4],q===J+s)continue}else q=J+4;switch(se){case K:re&&(W&&(a=h(W))&&this.parseAVCPES(E,U,a,!1),W={data:[],size:0}),W&&(W.data.push(g.subarray(q,J+s)),W.size+=J+s-q);break;case G:if(re){if(H&&(a=h(H)))switch(k.segmentCodec){case"aac":this.parseAACPES(k,a);break;case"mp3":this.parseMPEGPES(k,a);break}H={data:[],size:0}}H&&(H.data.push(g.subarray(q,J+s)),H.size+=J+s-q);break;case j:re&&(V&&(a=h(V))&&this.parseID3PES(P,a),V={data:[],size:0}),V&&(V.data.push(g.subarray(q,J+s)),V.size+=J+s-q);break;case 0:re&&(q+=g[q]+1),Y=this._pmtId=d(g,q);break;case Y:{re&&(q+=g[q]+1);var oe=c(g,q,this.typeSupported,l);K=oe.avc,K>0&&(E.pid=K),G=oe.audio,G>0&&(k.pid=G,k.segmentCodec=oe.segmentCodec),j=oe.id3,j>0&&(P.pid=j),z!==null&&!$&&(R.logger.warn("MPEG-TS PMT found at "+J+" after unknown PID '"+z+"'. Backtracking to sync byte @"+Z+" to parse all TS packets."),z=null,J=Z-188),$=this.pmtParsed=!0;break}case 17:case 8191:break;default:z=se;break}}else Q++;Q>0&&this.observer.emit(B.Events.ERROR,B.Events.ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+Q+" TS packet/s that do not start with 0x47"}),E.pesData=W,k.pesData=H,P.pesData=V;var le={audioTrack:k,videoTrack:E,id3Track:P,textTrack:U};return p&&this.extractRemainingSamples(le),le},T.flush=function(){var g=this.remainderData;this.remainderData=null;var m;return g?m=this.demux(g,-1,!1,!0):m={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(m),this.sampleAes?this.decrypt(m,this.sampleAes):m},T.extractRemainingSamples=function(g){var m=g.audioTrack,l=g.videoTrack,p=g.id3Track,a=g.textTrack,E=l.pesData,k=m.pesData,P=p.pesData,U;if(E&&(U=h(E))?(this.parseAVCPES(l,a,U,!0),l.pesData=null):l.pesData=E,k&&(U=h(k))){switch(m.segmentCodec){case"aac":this.parseAACPES(m,U);break;case"mp3":this.parseMPEGPES(m,U);break}m.pesData=null}else k!=null&&k.size&&R.logger.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=k;P&&(U=h(P))?(this.parseID3PES(p,U),p.pesData=null):p.pesData=P},T.demuxSampleAes=function(g,m,l){var p=this.demux(g,l,!0,!this.config.progressive),a=this.sampleAes=new O.default(this.observer,this.config,m);return this.decrypt(p,a)},T.decrypt=function(g,m){return new Promise(function(l){var p=g.audioTrack,a=g.videoTrack;p.samples&&p.segmentCodec==="aac"?m.decryptAacSamples(p.samples,0,function(){a.samples?m.decryptAvcSamples(a.samples,0,0,function(){l(g)}):l(g)}):a.samples&&m.decryptAvcSamples(a.samples,0,0,function(){l(g)})})},T.destroy=function(){this._duration=0},T.parseAVCPES=function(g,m,l,p){var a=this,E=this.parseAVCNALu(g,l.data),k=this.avcSample,P,U=!1;l.data=null,k&&E.length&&!g.audFound&&(_(k,g),k=this.avcSample=x(!1,l.pts,l.dts,"")),E.forEach(function(K){switch(K.type){case 1:{P=!0,k||(k=a.avcSample=x(!0,l.pts,l.dts,"")),k.frame=!0;var W=K.data;if(U&&W.length>4){var G=new N.default(W).readSliceType();(G===2||G===4||G===7||G===9)&&(k.key=!0)}break}case 5:P=!0,k||(k=a.avcSample=x(!0,l.pts,l.dts,"")),k.key=!0,k.frame=!0;break;case 6:{P=!0,(0,F.parseSEIMessageFromNALu)(K.data,1,l.pts,m.samples);break}case 7:if(P=!0,U=!0,!g.sps){var j=new N.default(K.data),H=j.readSPS();g.width=H.width,g.height=H.height,g.pixelRatio=H.pixelRatio,g.sps=[K.data],g.duration=a._duration;for(var V=K.data.subarray(1,4),z="avc1.",$=0;$<3;$++){var Y=V[$].toString(16);Y.length<2&&(Y="0"+Y),z+=Y}g.codec=z}break;case 8:P=!0,g.pps||(g.pps=[K.data]);break;case 9:P=!1,g.audFound=!0,k&&_(k,g),k=a.avcSample=x(!1,l.pts,l.dts,"");break;case 12:P=!0;break;default:P=!1,k&&(k.debug+="unknown NAL "+K.type+" ");break}if(k&&P){var X=k.units;X.push(K)}}),p&&k&&(_(k,g),this.avcSample=null)},T.getLastNalUnit=function(g){var m,l=this.avcSample,p;if((!l||l.units.length===0)&&(l=g[g.length-1]),(m=l)!==null&&m!==void 0&&m.units){var a=l.units;p=a[a.length-1]}return p},T.parseAVCNALu=function(g,m){var l=m.byteLength,p=g.naluState||0,a=p,E=[],k=0,P,U,K,W=-1,G=0;for(p===-1&&(W=0,G=m[0]&31,p=0,k=1);k<l;){if(P=m[k++],!p){p=P?0:1;continue}if(p===1){p=P?0:2;continue}if(!P)p=3;else if(P===1){if(W>=0){var j={data:m.subarray(W,k-p-1),type:G};E.push(j)}else{var H=this.getLastNalUnit(g.samples);if(H&&(a&&k<=4-a&&H.state&&(H.data=H.data.subarray(0,H.data.byteLength-a)),U=k-p-1,U>0)){var V=new Uint8Array(H.data.byteLength+U);V.set(H.data,0),V.set(m.subarray(0,U),H.data.byteLength),H.data=V,H.state=0}}k<l?(K=m[k]&31,W=k,G=K,p=0):p=-1}else p=0}if(W>=0&&p>=0){var z={data:m.subarray(W,l),type:G,state:p};E.push(z)}if(E.length===0){var $=this.getLastNalUnit(g.samples);if($){var Y=new Uint8Array($.data.byteLength+m.byteLength);Y.set($.data,0),Y.set(m,$.data.byteLength),$.data=Y}}return g.naluState=p,E},T.parseAACPES=function(g,m){var l=0,p=this.aacOverFlow,a=m.data;if(p){this.aacOverFlow=null;var E=p.missing,k=p.sample.unit.byteLength;if(E===-1){var P=new Uint8Array(k+a.byteLength);P.set(p.sample.unit,0),P.set(a,k),a=P}else{var U=k-E;p.sample.unit.set(a.subarray(0,E),U),g.samples.push(p.sample),l=p.missing}}var K,W;for(K=l,W=a.length;K<W-1&&!w.isHeader(a,K);K++);if(K!==l){var G,j;if(K<W-1?(G="AAC PES did not start with ADTS header,offset:"+K,j=!1):(G="no ADTS header found in AAC PES",j=!0),R.logger.warn("parsing error:"+G),this.observer.emit(B.Events.ERROR,B.Events.ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.FRAG_PARSING_ERROR,fatal:j,reason:G}),j)return}w.initTrackConfig(g,this.observer,a,K,this.audioCodec);var H;if(m.pts!==void 0)H=m.pts;else if(p){var V=w.getFrameDuration(g.samplerate);H=p.sample.pts+V}else{R.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var z=0,$;K<W;)if($=w.appendFrame(g,a,K,H,z),K+=$.length,$.missing){this.aacOverFlow=$;break}else for(z++;K<W-1&&!w.isHeader(a,K);K++);},T.parseMPEGPES=function(g,m){var l=m.data,p=l.length,a=0,E=0,k=m.pts;if(k===void 0){R.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;E<p;)if(A.isHeader(l,E)){var P=A.appendFrame(g,l,E,k,a);if(P)E+=P.length,a++;else break}else E++},T.parseID3PES=function(g,m){if(m.pts===void 0){R.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var l=y({},m,{type:this._avcTrack?S.MetadataSchema.emsg:S.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});g.samples.push(l)},v}();function x(v,T,M,g){return{key:v,frame:!1,pts:T,dts:M,units:[],debug:g,length:0}}function f(v,T){return((v[T+1]&31)<<8)+v[T+2]}function d(v,T){return(v[T+10]&31)<<8|v[T+11]}function c(v,T,M,g){var m={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},l=(v[T+1]&15)<<8|v[T+2],p=T+3+l-4,a=(v[T+10]&15)<<8|v[T+11];for(T+=12+a;T<p;){var E=f(v,T);switch(v[T]){case 207:if(!g){R.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:m.audio===-1&&(m.audio=E);break;case 21:m.id3===-1&&(m.id3=E);break;case 219:if(!g){R.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:m.avc===-1&&(m.avc=E);break;case 3:case 4:M.mpeg!==!0&&M.mp3!==!0?R.logger.log("MPEG audio found, not supported in this browser"):m.audio===-1&&(m.audio=E,m.segmentCodec="mp3");break;case 36:R.logger.warn("Unsupported HEVC stream type found");break}T+=((v[T+3]&15)<<8|v[T+4])+5}return m}function h(v){var T=0,M,g,m,l,p,a=v.data;if(!v||v.size===0)return null;for(;a[0].length<19&&a.length>1;){var E=new Uint8Array(a[0].length+a[1].length);E.set(a[0]),E.set(a[1],a[0].length),a[0]=E,a.splice(1,1)}M=a[0];var k=(M[0]<<16)+(M[1]<<8)+M[2];if(k===1){if(g=(M[4]<<8)+M[5],g&&g>v.size-6)return null;var P=M[7];P&192&&(l=(M[9]&14)*536870912+(M[10]&255)*4194304+(M[11]&254)*16384+(M[12]&255)*128+(M[13]&254)/2,P&64?(p=(M[14]&14)*536870912+(M[15]&255)*4194304+(M[16]&254)*16384+(M[17]&255)*128+(M[18]&254)/2,l-p>54e5&&(R.logger.warn(Math.round((l-p)/9e4)+"s delta between PTS and DTS, align them"),l=p)):p=l),m=M[8];var U=m+9;if(v.size<=U)return null;v.size-=U;for(var K=new Uint8Array(v.size),W=0,G=a.length;W<G;W++){M=a[W];var j=M.byteLength;if(U)if(U>j){U-=j;continue}else M=M.subarray(U),j-=U,U=0;K.set(M,T),T+=j}return g&&(g-=m+3),{data:K,pts:l,dts:p,len:g}}return null}function _(v,T){if(v.units.length&&v.frame){if(v.pts===void 0){var M=T.samples,g=M.length;if(g){var m=M[g-1];v.pts=m.pts,v.dts=m.dts}else{T.dropped++;return}}T.samples.push(v)}v.debug.length&&R.logger.log(v.pts+"/"+v.dts+":"+v.debug)}const L=D},"./src/demux/webworkify-webpack.js":(C,I,o)=>{o.r(I),o.d(I,{default:()=>s});var w=function(){var x=ENTRY_MODULE,f={},d=function h(_){var L=f[_];if(L!==void 0)return L.exports;var v=f[_]={exports:{}};return x[_].call(v.exports,v,v.exports,h),v.exports};d.m=x,function(){d.n=function(h){var _=h&&h.__esModule?function(){return h.default}:function(){return h};return d.d(_,{a:_}),_}}(),function(){d.d=function(h,_){for(var L in _)d.o(_,L)&&!d.o(h,L)&&Object.defineProperty(h,L,{enumerable:!0,get:_[L]})}}(),function(){d.o=function(h,_){return Object.prototype.hasOwnProperty.call(h,_)}}(),function(){d.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}}();var c=d(ENTRY_MODULE);return c.default||c},A=w.toString().split("ENTRY_MODULE"),N="[\\.|\\-|\\+|\\w|/|@]+",O="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+N+").*?\\)";function B(D){return(D+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function F(D){return!isNaN(1*D)}function R(D,x,f){var d={};d[f]=[];var c=x.toString().replace(/^"[^"]+"/,"function"),h=c.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||c.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!h)return d;for(var _=h[1],L=new RegExp("(\\\\n|\\W)"+B(_)+O,"g"),v;v=L.exec(c);)v[3]!=="dll-reference"&&d[f].push(v[3]);for(L=new RegExp("\\("+B(_)+'\\("(dll-reference\\s('+N+'))"\\)\\)'+O,"g");v=L.exec(c);)D[v[2]]||(d[f].push(v[1]),D[v[2]]=o(v[1]).m),d[v[2]]=d[v[2]]||[],d[v[2]].push(v[4]);for(var T=Object.keys(d),M=0;M<T.length;M++)for(var g=0;g<d[T[M]].length;g++)F(d[T[M]][g])&&(d[T[M]][g]=1*d[T[M]][g]);return d}function b(D){var x=Object.keys(D);return x.reduce(function(f,d){return f||D[d].length>0},!1)}function S(D,x){for(var f={main:[x]},d={main:[]},c={main:{}};b(f);)for(var h=Object.keys(f),_=0;_<h.length;_++){var L=h[_],v=f[L],T=v.pop();if(c[L]=c[L]||{},!(c[L][T]||!D[L][T])){c[L][T]=!0,d[L]=d[L]||[],d[L].push(T);for(var M=R(D,D[L][T],L),g=Object.keys(M),m=0;m<g.length;m++)f[g[m]]=f[g[m]]||[],f[g[m]]=f[g[m]].concat(M[g[m]])}}return d}function y(D,x,f,d){var c=D[d].map(function(h){return'"'+h+'": '+x[d][h].toString().replace(/^"[^"]+"/,"function")}).join(",");return A[0]+"{"+c+"}"+A[1]+'"'+f+'"'+A[2]}function s(D,x){x=x||{};var f={main:o.m},d=x.all?{main:Object.keys(f.main)}:S(f,D),c="";Object.keys(d).filter(function(T){return T!=="main"}).forEach(function(T){for(var M=0;d[T][M];)M++;d[T].push(M),f[T][M]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",c=c+("var "+T+" = ("+y(d,f,M,modules)+`)();
`)}),c=c+("new (("+y(d,f,D,"main")+")())(self);");var h=new window.Blob([c],{type:"text/javascript"}),_=window.URL||window.webkitURL||window.mozURL||window.msURL,L=_.createObjectURL(h),v=new window.Worker(L);return v.objectURL=L,v}},"./src/errors.ts":(C,I,o)=>{o.r(I),o.d(I,{ErrorDetails:()=>A,ErrorTypes:()=>w});var w;(function(N){N.NETWORK_ERROR="networkError",N.MEDIA_ERROR="mediaError",N.KEY_SYSTEM_ERROR="keySystemError",N.MUX_ERROR="muxError",N.OTHER_ERROR="otherError"})(w||(w={}));var A;(function(N){N.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",N.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",N.KEY_SYSTEM_NO_SESSION="keySystemNoSession",N.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",N.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",N.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",N.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",N.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",N.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",N.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",N.MANIFEST_LOAD_ERROR="manifestLoadError",N.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",N.MANIFEST_PARSING_ERROR="manifestParsingError",N.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",N.LEVEL_EMPTY_ERROR="levelEmptyError",N.LEVEL_LOAD_ERROR="levelLoadError",N.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",N.LEVEL_SWITCH_ERROR="levelSwitchError",N.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",N.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",N.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",N.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",N.FRAG_LOAD_ERROR="fragLoadError",N.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",N.FRAG_DECRYPT_ERROR="fragDecryptError",N.FRAG_PARSING_ERROR="fragParsingError",N.REMUX_ALLOC_ERROR="remuxAllocError",N.KEY_LOAD_ERROR="keyLoadError",N.KEY_LOAD_TIMEOUT="keyLoadTimeOut",N.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",N.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",N.BUFFER_APPEND_ERROR="bufferAppendError",N.BUFFER_APPENDING_ERROR="bufferAppendingError",N.BUFFER_STALLED_ERROR="bufferStalledError",N.BUFFER_FULL_ERROR="bufferFullError",N.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",N.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",N.INTERNAL_EXCEPTION="internalException",N.INTERNAL_ABORTED="aborted",N.UNKNOWN="unknown"})(A||(A={}))},"./src/events.ts":(C,I,o)=>{o.r(I),o.d(I,{Events:()=>w});var w;(function(A){A.MEDIA_ATTACHING="hlsMediaAttaching",A.MEDIA_ATTACHED="hlsMediaAttached",A.MEDIA_DETACHING="hlsMediaDetaching",A.MEDIA_DETACHED="hlsMediaDetached",A.BUFFER_RESET="hlsBufferReset",A.BUFFER_CODECS="hlsBufferCodecs",A.BUFFER_CREATED="hlsBufferCreated",A.BUFFER_APPENDING="hlsBufferAppending",A.BUFFER_APPENDED="hlsBufferAppended",A.BUFFER_EOS="hlsBufferEos",A.BUFFER_FLUSHING="hlsBufferFlushing",A.BUFFER_FLUSHED="hlsBufferFlushed",A.MANIFEST_LOADING="hlsManifestLoading",A.MANIFEST_LOADED="hlsManifestLoaded",A.MANIFEST_PARSED="hlsManifestParsed",A.LEVEL_SWITCHING="hlsLevelSwitching",A.LEVEL_SWITCHED="hlsLevelSwitched",A.LEVEL_LOADING="hlsLevelLoading",A.LEVEL_LOADED="hlsLevelLoaded",A.LEVEL_UPDATED="hlsLevelUpdated",A.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",A.LEVELS_UPDATED="hlsLevelsUpdated",A.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",A.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",A.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",A.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",A.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",A.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",A.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",A.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",A.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",A.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",A.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",A.CUES_PARSED="hlsCuesParsed",A.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",A.INIT_PTS_FOUND="hlsInitPtsFound",A.FRAG_LOADING="hlsFragLoading",A.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",A.FRAG_LOADED="hlsFragLoaded",A.FRAG_DECRYPTED="hlsFragDecrypted",A.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",A.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",A.FRAG_PARSING_METADATA="hlsFragParsingMetadata",A.FRAG_PARSED="hlsFragParsed",A.FRAG_BUFFERED="hlsFragBuffered",A.FRAG_CHANGED="hlsFragChanged",A.FPS_DROP="hlsFpsDrop",A.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",A.ERROR="hlsError",A.DESTROYING="hlsDestroying",A.KEY_LOADING="hlsKeyLoading",A.KEY_LOADED="hlsKeyLoaded",A.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",A.BACK_BUFFER_REACHED="hlsBackBufferReached"})(w||(w={}))},"./src/hls.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>v});var w=o("./node_modules/url-toolkit/src/url-toolkit.js"),A=o("./src/loader/playlist-loader.ts"),N=o("./src/controller/id3-track-controller.ts"),O=o("./src/controller/latency-controller.ts"),B=o("./src/controller/level-controller.ts"),F=o("./src/controller/fragment-tracker.ts"),R=o("./src/loader/key-loader.ts"),b=o("./src/controller/stream-controller.ts"),S=o("./src/is-supported.ts"),y=o("./src/utils/logger.ts"),s=o("./src/config.ts"),D=o("./node_modules/eventemitter3/index.js"),x=o("./src/events.ts"),f=o("./src/errors.ts"),d=o("./src/types/level.ts");function c(T,M){for(var g=0;g<M.length;g++){var m=M[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(T,_(m.key),m)}}function h(T,M,g){return M&&c(T.prototype,M),g&&c(T,g),Object.defineProperty(T,"prototype",{writable:!1}),T}function _(T){var M=L(T,"string");return typeof M=="symbol"?M:String(M)}function L(T,M){if(typeof T!="object"||T===null)return T;var g=T[Symbol.toPrimitive];if(g!==void 0){var m=g.call(T,M||"default");if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(M==="string"?String:Number)(T)}var v=function(){T.isSupported=function(){return(0,S.isSupported)()};function T(g){g===void 0&&(g={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new D.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var m=this.config=(0,s.mergeConfig)(T.DefaultConfig,g);this.userConfig=g,(0,y.enableLogs)(m.debug,"Hls instance"),this._autoLevelCapping=-1,m.progressive&&(0,s.enableStreamingMode)(m);var l=m.abrController,p=m.bufferController,a=m.capLevelController,E=m.fpsController,k=this.abrController=new l(this),P=this.bufferController=new p(this),U=this.capLevelController=new a(this),K=new E(this),W=new A.default(this),G=new N.default(this),j=this.levelController=new B.default(this),H=new F.FragmentTracker(this),V=new R.default(this.config),z=this.streamController=new b.default(this,H,V);U.setStreamController(z),K.setStreamController(z);var $=[W,j,z];this.networkControllers=$;var Y=[k,P,U,K,G,H];this.audioTrackController=this.createController(m.audioTrackController,$);var X=m.audioStreamController;X&&$.push(new X(this,H,V)),this.subtitleTrackController=this.createController(m.subtitleTrackController,$);var Z=m.subtitleStreamController;Z&&$.push(new Z(this,H,V)),this.createController(m.timelineController,Y),V.emeController=this.emeController=this.createController(m.emeController,Y),this.cmcdController=this.createController(m.cmcdController,Y),this.latencyController=this.createController(O.default,Y),this.coreComponents=Y}var M=T.prototype;return M.createController=function(m,l){if(m){var p=new m(this);return l&&l.push(p),p}return null},M.on=function(m,l,p){p===void 0&&(p=this),this._emitter.on(m,l,p)},M.once=function(m,l,p){p===void 0&&(p=this),this._emitter.once(m,l,p)},M.removeAllListeners=function(m){this._emitter.removeAllListeners(m)},M.off=function(m,l,p,a){p===void 0&&(p=this),this._emitter.off(m,l,p,a)},M.listeners=function(m){return this._emitter.listeners(m)},M.emit=function(m,l,p){return this._emitter.emit(m,l,p)},M.trigger=function(m,l){if(this.config.debug)return this.emit(m,m,l);try{return this.emit(m,m,l)}catch(p){y.logger.error("An internal error happened while handling event "+m+'. Error message: "'+p.message+'". Here is a stacktrace:',p),this.trigger(x.Events.ERROR,{type:f.ErrorTypes.OTHER_ERROR,details:f.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:m,error:p})}return!1},M.listenerCount=function(m){return this._emitter.listenerCount(m)},M.destroy=function(){y.logger.log("destroy"),this.trigger(x.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(m){return m.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(m){return m.destroy()}),this.coreComponents.length=0},M.attachMedia=function(m){y.logger.log("attachMedia"),this._media=m,this.trigger(x.Events.MEDIA_ATTACHING,{media:m})},M.detachMedia=function(){y.logger.log("detachMedia"),this.trigger(x.Events.MEDIA_DETACHING,void 0),this._media=null},M.loadSource=function(m){this.stopLoad();var l=this.media,p=this.url,a=this.url=w.buildAbsoluteURL(self.location.href,m,{alwaysNormalize:!0});y.logger.log("loadSource:"+a),l&&p&&p!==a&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(l)),this.trigger(x.Events.MANIFEST_LOADING,{url:m})},M.startLoad=function(m){m===void 0&&(m=-1),y.logger.log("startLoad("+m+")"),this.networkControllers.forEach(function(l){l.startLoad(m)})},M.stopLoad=function(){y.logger.log("stopLoad"),this.networkControllers.forEach(function(m){m.stopLoad()})},M.swapAudioCodec=function(){y.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},M.recoverMediaError=function(){y.logger.log("recoverMediaError");var m=this._media;this.detachMedia(),m&&this.attachMedia(m)},M.removeLevel=function(m,l){l===void 0&&(l=0),this.levelController.removeLevel(m,l)},h(T,[{key:"levels",get:function(){var m=this.levelController.levels;return m||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(m){y.logger.log("set currentLevel:"+m),this.loadLevel=m,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(m){y.logger.log("set nextLevel:"+m),this.levelController.manualLevel=m,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(m){y.logger.log("set loadLevel:"+m),this.levelController.manualLevel=m}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(m){this.levelController.nextLoadLevel=m}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(m){y.logger.log("set firstLevel:"+m),this.levelController.firstLevel=m}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(m){y.logger.log("set startLevel:"+m),m!==-1&&(m=Math.max(m,this.minAutoLevel)),this.levelController.startLevel=m}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(m){var l=!!m;l!==this.config.capLevelToPlayerSize&&(l?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=l)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(m){this._autoLevelCapping!==m&&(y.logger.log("set autoLevelCapping:"+m),this._autoLevelCapping=m)}},{key:"bandwidthEstimate",get:function(){var m=this.abrController.bwEstimator;return m?m.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(m){d.HdcpLevels.indexOf(m)>-1&&(this._maxHdcpLevel=m)}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var m=this.levels,l=this.config.minAutoBitrate;if(!m)return 0;for(var p=m.length,a=0;a<p;a++)if(m[a].maxBitrate>=l)return a;return 0}},{key:"maxAutoLevel",get:function(){var m=this.levels,l=this.autoLevelCapping,p=this.maxHdcpLevel,a;if(l===-1&&m&&m.length?a=m.length-1:a=l,p)for(var E=a;E--;){var k=m[E].attrs["HDCP-LEVEL"];if(k&&k<=p)return E}return a}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(m){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,m)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var m=this.audioTrackController;return m?m.audioTracks:[]}},{key:"audioTrack",get:function(){var m=this.audioTrackController;return m?m.audioTrack:-1},set:function(m){var l=this.audioTrackController;l&&(l.audioTrack=m)}},{key:"subtitleTracks",get:function(){var m=this.subtitleTrackController;return m?m.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var m=this.subtitleTrackController;return m?m.subtitleTrack:-1},set:function(m){var l=this.subtitleTrackController;l&&(l.subtitleTrack=m)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var m=this.subtitleTrackController;return m?m.subtitleDisplay:!1},set:function(m){var l=this.subtitleTrackController;l&&(l.subtitleDisplay=m)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(m){this.config.lowLatencyMode=m}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.3.4"}},{key:"Events",get:function(){return x.Events}},{key:"ErrorTypes",get:function(){return f.ErrorTypes}},{key:"ErrorDetails",get:function(){return f.ErrorDetails}},{key:"DefaultConfig",get:function(){return T.defaultConfig?T.defaultConfig:s.hlsDefaultConfig},set:function(m){T.defaultConfig=m}}]),T}();v.defaultConfig=void 0},"./src/is-supported.ts":(C,I,o)=>{o.r(I),o.d(I,{changeTypeSupported:()=>O,isSupported:()=>N});var w=o("./src/utils/mediasource-helper.ts");function A(){return self.SourceBuffer||self.WebKitSourceBuffer}function N(){var B=(0,w.getMediaSource)();if(!B)return!1;var F=A(),R=B&&typeof B.isTypeSupported=="function"&&B.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),b=!F||F.prototype&&typeof F.prototype.appendBuffer=="function"&&typeof F.prototype.remove=="function";return!!R&&!!b}function O(){var B,F=A();return typeof(F==null||(B=F.prototype)===null||B===void 0?void 0:B.changeType)=="function"}},"./src/loader/date-range.ts":(C,I,o)=>{o.r(I),o.d(I,{DateRange:()=>y,DateRangeAttribute:()=>S});var w=o("./src/polyfills/number.ts"),A=o("./src/utils/attr-list.ts"),N=o("./src/utils/logger.ts");function O(){return O=Object.assign?Object.assign.bind():function(s){for(var D=1;D<arguments.length;D++){var x=arguments[D];for(var f in x)Object.prototype.hasOwnProperty.call(x,f)&&(s[f]=x[f])}return s},O.apply(this,arguments)}function B(s,D){for(var x=0;x<D.length;x++){var f=D[x];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(s,R(f.key),f)}}function F(s,D,x){return D&&B(s.prototype,D),x&&B(s,x),Object.defineProperty(s,"prototype",{writable:!1}),s}function R(s){var D=b(s,"string");return typeof D=="symbol"?D:String(D)}function b(s,D){if(typeof s!="object"||s===null)return s;var x=s[Symbol.toPrimitive];if(x!==void 0){var f=x.call(s,D||"default");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(D==="string"?String:Number)(s)}var S;(function(s){s.ID="ID",s.CLASS="CLASS",s.START_DATE="START-DATE",s.DURATION="DURATION",s.END_DATE="END-DATE",s.END_ON_NEXT="END-ON-NEXT",s.PLANNED_DURATION="PLANNED-DURATION",s.SCTE35_OUT="SCTE35-OUT",s.SCTE35_IN="SCTE35-IN"})(S||(S={}));var y=function(){function s(D,x){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,x){var f=x.attr;for(var d in f)if(Object.prototype.hasOwnProperty.call(D,d)&&D[d]!==f[d]){N.logger.warn('DATERANGE tag attribute: "'+d+'" does not match for tags with ID: "'+D.ID+'"'),this._badValueForSameId=d;break}D=O(new A.AttrList({}),f,D)}if(this.attr=D,this._startDate=new Date(D[S.START_DATE]),S.END_DATE in this.attr){var c=new Date(this.attr[S.END_DATE]);(0,w.isFiniteNumber)(c.getTime())&&(this._endDate=c)}}return F(s,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var x=this.duration;return x!==null?new Date(this._startDate.getTime()+x*1e3):null}},{key:"duration",get:function(){if(S.DURATION in this.attr){var x=this.attr.decimalFloatingPoint(S.DURATION);if((0,w.isFiniteNumber)(x))return x}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return S.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(S.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(S.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,w.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),s}()},"./src/loader/fragment-loader.ts":(C,I,o)=>{o.r(I),o.d(I,{LoadError:()=>x,default:()=>s});var w=o("./src/polyfills/number.ts"),A=o("./src/errors.ts");function N(f,d){f.prototype=Object.create(d.prototype),f.prototype.constructor=f,b(f,d)}function O(f){var d=typeof Map=="function"?new Map:void 0;return O=function(h){if(h===null||!R(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(typeof d<"u"){if(d.has(h))return d.get(h);d.set(h,_)}function _(){return B(h,arguments,S(this).constructor)}return _.prototype=Object.create(h.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),b(_,h)},O(f)}function B(f,d,c){return F()?B=Reflect.construct.bind():B=function(_,L,v){var T=[null];T.push.apply(T,L);var M=Function.bind.apply(_,T),g=new M;return v&&b(g,v.prototype),g},B.apply(null,arguments)}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R(f){return Function.toString.call(f).indexOf("[native code]")!==-1}function b(f,d){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,_){return h.__proto__=_,h},b(f,d)}function S(f){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(c){return c.__proto__||Object.getPrototypeOf(c)},S(f)}var y=Math.pow(2,17),s=function(){function f(c){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=c}var d=f.prototype;return d.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},d.abort=function(){this.loader&&this.loader.abort()},d.load=function(h,_){var L=this,v=h.url;if(!v)return Promise.reject(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:h,networkDetails:null},"Fragment does not have a "+(v?"part list":"url")));this.abort();var T=this.config,M=T.fLoader,g=T.loader;return new Promise(function(m,l){L.loader&&L.loader.destroy();var p=L.loader=h.loader=M?new M(T):new g(T),a=D(h),E={timeout:T.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:T.fragLoadingMaxRetryTimeout,highWaterMark:h.sn==="initSegment"?1/0:y};h.stats=p.stats,p.load(a,E,{onSuccess:function(P,U,K,W){L.resetLoader(h,p);var G=P.data;K.resetIV&&h.decryptdata&&(h.decryptdata.iv=new Uint8Array(G.slice(0,16)),G=G.slice(16)),m({frag:h,part:null,payload:G,networkDetails:W})},onError:function(P,U,K){L.resetLoader(h,p),l(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:h,response:P,networkDetails:K}))},onAbort:function(P,U,K){L.resetLoader(h,p),l(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:h,networkDetails:K}))},onTimeout:function(P,U,K){L.resetLoader(h,p),l(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:h,networkDetails:K}))},onProgress:function(P,U,K,W){_&&_({frag:h,part:null,payload:K,networkDetails:W})}})})},d.loadPart=function(h,_,L){var v=this;this.abort();var T=this.config,M=T.fLoader,g=T.loader;return new Promise(function(m,l){v.loader&&v.loader.destroy();var p=v.loader=h.loader=M?new M(T):new g(T),a=D(h,_),E={timeout:T.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:T.fragLoadingMaxRetryTimeout,highWaterMark:y};_.stats=p.stats,p.load(a,E,{onSuccess:function(P,U,K,W){v.resetLoader(h,p),v.updateStatsFromPart(h,_);var G={frag:h,part:_,payload:P.data,networkDetails:W};L(G),m(G)},onError:function(P,U,K){v.resetLoader(h,p),l(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:h,part:_,response:P,networkDetails:K}))},onAbort:function(P,U,K){h.stats.aborted=_.stats.aborted,v.resetLoader(h,p),l(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:h,part:_,networkDetails:K}))},onTimeout:function(P,U,K){v.resetLoader(h,p),l(new x({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:h,part:_,networkDetails:K}))}})})},d.updateStatsFromPart=function(h,_){var L=h.stats,v=_.stats,T=v.total;if(L.loaded+=v.loaded,T){var M=Math.round(h.duration/_.duration),g=Math.min(Math.round(L.loaded/T),M),m=M-g,l=m*Math.round(L.loaded/g);L.total=L.loaded+l}else L.total=Math.max(L.loaded,L.total);var p=L.loading,a=v.loading;p.start?p.first+=a.first-a.start:(p.start=a.start,p.first=a.first),p.end=a.end},d.resetLoader=function(h,_){h.loader=null,this.loader===_&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),_.destroy()},f}();function D(f,d){d===void 0&&(d=null);var c=d||f,h={frag:f,part:d,responseType:"arraybuffer",url:c.url,headers:{},rangeStart:0,rangeEnd:0},_=c.byteRangeStartOffset,L=c.byteRangeEndOffset;if((0,w.isFiniteNumber)(_)&&(0,w.isFiniteNumber)(L)){var v,T=_,M=L;if(f.sn==="initSegment"&&((v=f.decryptdata)===null||v===void 0?void 0:v.method)==="AES-128"){var g=L-_;g%16&&(M=L+(16-g%16)),_!==0&&(h.resetIV=!0,T=_-16)}h.rangeStart=T,h.rangeEnd=M}return h}var x=function(f){N(d,f);function d(c){for(var h,_=arguments.length,L=new Array(_>1?_-1:0),v=1;v<_;v++)L[v-1]=arguments[v];return h=f.call.apply(f,[this].concat(L))||this,h.data=void 0,h.data=c,h}return d}(O(Error))},"./src/loader/fragment.ts":(C,I,o)=>{o.r(I),o.d(I,{BaseSegment:()=>s,ElementaryStreamTypes:()=>y,Fragment:()=>D,Part:()=>x});var w=o("./src/polyfills/number.ts"),A=o("./node_modules/url-toolkit/src/url-toolkit.js"),N=o("./src/loader/load-stats.ts");function O(f,d){f.prototype=Object.create(d.prototype),f.prototype.constructor=f,B(f,d)}function B(f,d){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,_){return h.__proto__=_,h},B(f,d)}function F(f,d){for(var c=0;c<d.length;c++){var h=d[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(f,b(h.key),h)}}function R(f,d,c){return d&&F(f.prototype,d),c&&F(f,c),Object.defineProperty(f,"prototype",{writable:!1}),f}function b(f){var d=S(f,"string");return typeof d=="symbol"?d:String(d)}function S(f,d){if(typeof f!="object"||f===null)return f;var c=f[Symbol.toPrimitive];if(c!==void 0){var h=c.call(f,d||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(f)}var y;(function(f){f.AUDIO="audio",f.VIDEO="video",f.AUDIOVIDEO="audiovideo"})(y||(y={}));var s=function(){function f(c){var h;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(h={},h[y.AUDIO]=null,h[y.VIDEO]=null,h[y.AUDIOVIDEO]=null,h),this.baseurl=c}var d=f.prototype;return d.setByteRange=function(h,_){var L=h.split("@",2),v=[];L.length===1?v[0]=_?_.byteRangeEndOffset:0:v[0]=parseInt(L[1]),v[1]=parseInt(L[0])+v[0],this._byteRange=v},R(f,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,A.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(h){this._url=h}}]),f}(),D=function(f){O(d,f);function d(h,_){var L;return L=f.call(this,_)||this,L._decryptdata=null,L.rawProgramDateTime=null,L.programDateTime=null,L.tagList=[],L.duration=0,L.sn=0,L.levelkeys=void 0,L.type=void 0,L.loader=null,L.keyLoader=null,L.level=-1,L.cc=0,L.startPTS=void 0,L.endPTS=void 0,L.appendedPTS=void 0,L.startDTS=void 0,L.endDTS=void 0,L.start=0,L.deltaPTS=void 0,L.maxStartPTS=void 0,L.minEndPTS=void 0,L.stats=new N.LoadStats,L.urlId=0,L.data=void 0,L.bitrateTest=!1,L.title=null,L.initSegment=null,L.endList=void 0,L.type=h,L}var c=d.prototype;return c.setKeyFormat=function(_){if(this.levelkeys){var L=this.levelkeys[_];L&&!this._decryptdata&&(this._decryptdata=L.getDecryptData(this.sn))}},c.abortRequests=function(){var _,L;(_=this.loader)===null||_===void 0||_.abort(),(L=this.keyLoader)===null||L===void 0||L.abort()},c.setElementaryStreamInfo=function(_,L,v,T,M,g){g===void 0&&(g=!1);var m=this.elementaryStreams,l=m[_];if(!l){m[_]={startPTS:L,endPTS:v,startDTS:T,endDTS:M,partial:g};return}l.startPTS=Math.min(l.startPTS,L),l.endPTS=Math.max(l.endPTS,v),l.startDTS=Math.min(l.startDTS,T),l.endDTS=Math.max(l.endDTS,M)},c.clearElementaryStreamInfo=function(){var _=this.elementaryStreams;_[y.AUDIO]=null,_[y.VIDEO]=null,_[y.AUDIOVIDEO]=null},R(d,[{key:"decryptdata",get:function(){var _=this.levelkeys;if(!_&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var L=this.levelkeys.identity;if(L)this._decryptdata=L.getDecryptData(this.sn);else{var v=Object.keys(this.levelkeys);if(v.length===1)return this._decryptdata=this.levelkeys[v[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,w.isFiniteNumber)(this.programDateTime))return null;var _=(0,w.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+_*1e3}},{key:"encrypted",get:function(){var _;if((_=this._decryptdata)!==null&&_!==void 0&&_.encrypted)return!0;if(this.levelkeys){var L=Object.keys(this.levelkeys),v=L.length;if(v>1||v===1&&this.levelkeys[L[0]].encrypted)return!0}return!1}}]),d}(s),x=function(f){O(d,f);function d(c,h,_,L,v){var T;T=f.call(this,_)||this,T.fragOffset=0,T.duration=0,T.gap=!1,T.independent=!1,T.relurl=void 0,T.fragment=void 0,T.index=void 0,T.stats=new N.LoadStats,T.duration=c.decimalFloatingPoint("DURATION"),T.gap=c.bool("GAP"),T.independent=c.bool("INDEPENDENT"),T.relurl=c.enumeratedString("URI"),T.fragment=h,T.index=L;var M=c.enumeratedString("BYTERANGE");return M&&T.setByteRange(M,v),v&&(T.fragOffset=v.fragOffset+v.duration),T}return R(d,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var h=this.elementaryStreams;return!!(h.audio||h.video||h.audiovideo)}}]),d}(s)},"./src/loader/key-loader.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>N});var w=o("./src/errors.ts"),A=o("./src/loader/fragment-loader.ts"),N=function(){function O(F){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=F}var B=O.prototype;return B.abort=function(){for(var R in this.keyUriToKeyInfo){var b=this.keyUriToKeyInfo[R].loader;b&&b.abort()}},B.detach=function(){for(var R in this.keyUriToKeyInfo){var b=this.keyUriToKeyInfo[R];(b.mediaKeySessionContext||b.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[R]}},B.destroy=function(){this.detach();for(var R in this.keyUriToKeyInfo){var b=this.keyUriToKeyInfo[R].loader;b&&b.destroy()}this.keyUriToKeyInfo={}},B.createKeyLoadError=function(R,b,S,y){return b===void 0&&(b=w.ErrorDetails.KEY_LOAD_ERROR),new A.LoadError({type:w.ErrorTypes.NETWORK_ERROR,details:b,fatal:!1,frag:R,networkDetails:S})},B.loadClear=function(R,b){var S=this;if(this.emeController&&this.config.emeEnabled)for(var y=R.sn,s=R.cc,D=function(c){var h=b[c];if(s<=h.cc&&(y==="initSegment"||y<h.sn))return S.emeController.selectKeySystemFormat(h).then(function(_){h.setKeyFormat(_)}),"break"},x=0;x<b.length;x++){var f=D(x);if(f==="break")break}},B.load=function(R){var b=this;return!R.decryptdata&&R.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(R).then(function(S){return b.loadInternal(R,S)}):this.loadInternal(R)},B.loadInternal=function(R,b){var S,y;b&&R.setKeyFormat(b);var s=R.decryptdata;if(!s){var D=b?"Expected frag.decryptdata to be defined after setting format "+b:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(R,w.ErrorDetails.KEY_LOAD_ERROR,null,D))}var x=s.uri;if(!x)return Promise.reject(this.createKeyLoadError(R,w.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+x+'"'));var f=this.keyUriToKeyInfo[x];if((S=f)!==null&&S!==void 0&&S.decryptdata.key)return s.key=f.decryptdata.key,Promise.resolve({frag:R,keyInfo:f});if((y=f)!==null&&y!==void 0&&y.keyLoadPromise){var d;switch((d=f.mediaKeySessionContext)===null||d===void 0?void 0:d.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return f.keyLoadPromise.then(function(c){return s.key=c.keyInfo.decryptdata.key,{frag:R,keyInfo:f}})}}switch(f=this.keyUriToKeyInfo[x]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(f,R):this.loadKeyEME(f,R);case"AES-128":return this.loadKeyHTTP(f,R);default:return Promise.reject(this.createKeyLoadError(R,w.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+s.method+'"'))}},B.loadKeyEME=function(R,b){var S={frag:b,keyInfo:R};if(this.emeController&&this.config.emeEnabled){var y=this.emeController.loadKey(S);if(y)return(R.keyLoadPromise=y.then(function(s){return R.mediaKeySessionContext=s,S})).catch(function(s){throw R.keyLoadPromise=null,s})}return Promise.resolve(S)},B.loadKeyHTTP=function(R,b){var S=this,y=this.config,s=y.loader,D=new s(y);return b.keyLoader=R.loader=D,R.keyLoadPromise=new Promise(function(x,f){var d={keyInfo:R,frag:b,responseType:"arraybuffer",url:R.decryptdata.uri},c={timeout:y.fragLoadingTimeOut,maxRetry:0,retryDelay:y.fragLoadingRetryDelay,maxRetryDelay:y.fragLoadingMaxRetryTimeout,highWaterMark:0},h={onSuccess:function(L,v,T,M){var g=T.frag,m=T.keyInfo,l=T.url;if(!g.decryptdata||m!==S.keyUriToKeyInfo[l])return f(S.createKeyLoadError(g,w.ErrorDetails.KEY_LOAD_ERROR,M,"after key load, decryptdata unset or changed"));m.decryptdata.key=g.decryptdata.key=new Uint8Array(L.data),g.keyLoader=null,m.loader=null,x({frag:g,keyInfo:m})},onError:function(L,v,T){S.resetLoader(v),f(S.createKeyLoadError(b,w.ErrorDetails.KEY_LOAD_ERROR,T))},onTimeout:function(L,v,T){S.resetLoader(v),f(S.createKeyLoadError(b,w.ErrorDetails.KEY_LOAD_TIMEOUT,T))},onAbort:function(L,v,T){S.resetLoader(v),f(S.createKeyLoadError(b,w.ErrorDetails.INTERNAL_ABORTED,T))}};D.load(d,c,h)})},B.resetLoader=function(R){var b=R.frag,S=R.keyInfo,y=R.url,s=S.loader;b.keyLoader===s&&(b.keyLoader=null,S.loader=null),delete this.keyUriToKeyInfo[y],s&&s.destroy()},O}()},"./src/loader/level-details.ts":(C,I,o)=>{o.r(I),o.d(I,{LevelDetails:()=>R});var w=o("./src/polyfills/number.ts");function A(b,S){for(var y=0;y<S.length;y++){var s=S[y];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(b,O(s.key),s)}}function N(b,S,y){return S&&A(b.prototype,S),y&&A(b,y),Object.defineProperty(b,"prototype",{writable:!1}),b}function O(b){var S=B(b,"string");return typeof S=="symbol"?S:String(S)}function B(b,S){if(typeof b!="object"||b===null)return b;var y=b[Symbol.toPrimitive];if(y!==void 0){var s=y.call(b,S||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(b)}var F=10,R=function(){function b(y){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=y}var S=b.prototype;return S.reloaded=function(s){if(!s){this.advanced=!0,this.updated=!0;return}var D=this.lastPartSn-s.lastPartSn,x=this.lastPartIndex-s.lastPartIndex;this.updated=this.endSN!==s.endSN||!!x||!!D,this.advanced=this.endSN>s.endSN||D>0||D===0&&x>0,this.updated||this.advanced?this.misses=Math.floor(s.misses*.6):this.misses=s.misses+1,this.availabilityDelay=s.availabilityDelay},N(b,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?(0,w.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||F}},{key:"drift",get:function(){var s=this.driftEndTime-this.driftStartTime;if(s>0){var D=this.driftEnd-this.driftStart;return D*1e3/s}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var s;return(s=this.fragments)!==null&&s!==void 0&&s.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var s;return(s=this.partList)!==null&&s!==void 0&&s.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),b}()},"./src/loader/level-key.ts":(C,I,o)=>{o.r(I),o.d(I,{LevelKey:()=>R});var w=o("./src/utils/keysystem-util.ts"),A=o("./src/utils/mediakeys-helper.ts"),N=o("./src/utils/mp4-tools.ts"),O=o("./src/utils/logger.ts"),B=o("./src/utils/numeric-encoding-utils.ts"),F={},R=function(){S.clearKeyUriToKeyIdMap=function(){F={}};function S(s,D,x,f,d){f===void 0&&(f=[1]),d===void 0&&(d=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=s,this.uri=D,this.keyFormat=x,this.keyFormatVersions=f,this.iv=d,this.encrypted=s?s!=="NONE":!1,this.isCommonEncryption=this.encrypted&&s!=="AES-128"}var y=S.prototype;return y.isSupported=function(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;switch(this.keyFormat){case"identity":return this.method==="SAMPLE-AES";case A.KeySystemFormats.FAIRPLAY:case A.KeySystemFormats.WIDEVINE:case A.KeySystemFormats.PLAYREADY:case A.KeySystemFormats.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1},y.getDecryptData=function(D){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof D!="number"&&(this.method==="AES-128"&&!this.iv&&O.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),D=0);var x=b(D),f=new S(this.method,this.uri,"identity",this.keyFormatVersions,x);return f}var d=(0,w.convertDataUriToArrayBytes)(this.uri);if(d)switch(this.keyFormat){case A.KeySystemFormats.WIDEVINE:this.pssh=d,d.length>=22&&(this.keyId=d.subarray(d.length-22,d.length-6));break;case A.KeySystemFormats.PLAYREADY:{var c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,N.mp4pssh)(c,null,d);var h=new Uint16Array(d.buffer,d.byteOffset,d.byteLength/2),_=String.fromCharCode.apply(null,Array.from(h)),L=_.substring(_.indexOf("<"),_.length),v=new DOMParser,T=v.parseFromString(L,"text/xml"),M=T.getElementsByTagName("KID")[0];if(M){var g=M.childNodes[0]?M.childNodes[0].nodeValue:M.getAttribute("VALUE");if(g){var m=(0,B.base64Decode)(g).subarray(0,16);(0,w.changeEndianness)(m),this.keyId=m}}break}default:{var l=d.subarray(0,16);if(l.length!==16){var p=new Uint8Array(16);p.set(l,16-l.length),l=p}this.keyId=l;break}}if(!this.keyId||this.keyId.byteLength!==16){var a=F[this.uri];if(!a){var E=Object.keys(F).length%Number.MAX_SAFE_INTEGER;a=new Uint8Array(16);var k=new DataView(a.buffer,12,4);k.setUint32(0,E),F[this.uri]=a}this.keyId=a}return this},S}();function b(S){for(var y=new Uint8Array(16),s=12;s<16;s++)y[s]=S>>8*(15-s)&255;return y}},"./src/loader/load-stats.ts":(C,I,o)=>{o.r(I),o.d(I,{LoadStats:()=>w});var w=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>d});var w=o("./src/polyfills/number.ts"),A=o("./node_modules/url-toolkit/src/url-toolkit.js"),N=o("./src/loader/date-range.ts"),O=o("./src/loader/fragment.ts"),B=o("./src/loader/level-details.ts"),F=o("./src/loader/level-key.ts"),R=o("./src/utils/attr-list.ts"),b=o("./src/utils/logger.ts"),S=o("./src/utils/codecs.ts");function y(){return y=Object.assign?Object.assign.bind():function(g){for(var m=1;m<arguments.length;m++){var l=arguments[m];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(g[p]=l[p])}return g},y.apply(this,arguments)}var s=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,D=/#EXT-X-MEDIA:(.*)/g,x=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),f=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),d=function(){function g(){}return g.findGroup=function(l,p){for(var a=0;a<l.length;a++){var E=l[a];if(E.id===p)return E}},g.convertAVC1ToAVCOTI=function(l){var p=l.split(".");if(p.length>2){var a=p.shift()+".";return a+=parseInt(p.shift()).toString(16),a+=("000"+parseInt(p.shift()).toString(16)).slice(-4),a}return l},g.resolve=function(l,p){return(0,A.buildAbsoluteURL)(p,l,{alwaysNormalize:!0})},g.parseMasterPlaylist=function(l,p){var a=[],E=[],k={},P=[],U=!1;s.lastIndex=0;for(var K;(K=s.exec(l))!=null;)if(K[1]){var W,G=new R.AttrList(K[1]),j={attrs:G,bitrate:G.decimalInteger("AVERAGE-BANDWIDTH")||G.decimalInteger("BANDWIDTH"),name:G.NAME,url:g.resolve(K[2],p)},H=G.decimalResolution("RESOLUTION");H&&(j.width=H.width,j.height=H.height),h((G.CODECS||"").split(/[ ,]+/).filter(function(X){return X}),j),j.videoCodec&&j.videoCodec.indexOf("avc1")!==-1&&(j.videoCodec=g.convertAVC1ToAVCOTI(j.videoCodec)),(W=j.unknownCodecs)!==null&&W!==void 0&&W.length||E.push(j),a.push(j)}else if(K[3]){var V=new R.AttrList(K[3]);V["DATA-ID"]&&(U=!0,k[V["DATA-ID"]]=V)}else if(K[4]){var z=K[4],$=c(z,p);$.encrypted&&$.isSupported()?P.push($):b.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+z+'"')}var Y=E.length>0&&E.length<a.length;return{levels:Y?E:a,sessionData:U?k:null,sessionKeys:P.length?P:null}},g.parseMasterPlaylistMedia=function(l,p,a,E){E===void 0&&(E=[]);var k,P=[],U=0;for(D.lastIndex=0;(k=D.exec(l))!==null;){var K=new R.AttrList(k[1]);if(K.TYPE===a){var W={attrs:K,bitrate:0,id:U++,groupId:K["GROUP-ID"],instreamId:K["INSTREAM-ID"],name:K.NAME||K.LANGUAGE||"",type:a,default:K.bool("DEFAULT"),autoselect:K.bool("AUTOSELECT"),forced:K.bool("FORCED"),lang:K.LANGUAGE,url:K.URI?g.resolve(K.URI,p):""};if(E.length){var G=g.findGroup(E,W.groupId)||E[0];_(W,G,"audioCodec"),_(W,G,"textCodec")}P.push(W)}}return P},g.parseLevelPlaylist=function(l,p,a,E,k){var P=new B.LevelDetails(p),U=P.fragments,K=null,W=0,G=0,j=0,H=0,V=null,z=new O.Fragment(E,p),$,Y,X,Z=-1,Q=!1;for(x.lastIndex=0,P.m3u8=l;($=x.exec(l))!==null;){Q&&(Q=!1,z=new O.Fragment(E,p),z.start=j,z.sn=W,z.cc=H,z.level=a,K&&(z.initSegment=K,z.rawProgramDateTime=K.rawProgramDateTime,K.rawProgramDateTime=null));var J=$[1];if(J){z.duration=parseFloat(J);var re=(" "+$[2]).slice(1);z.title=re||null,z.tagList.push(re?["INF",J,re]:["INF",J])}else if($[3])(0,w.isFiniteNumber)(z.duration)&&(z.start=j,X&&M(z,X,P),z.sn=W,z.level=a,z.cc=H,z.urlId=k,U.push(z),z.relurl=(" "+$[3]).slice(1),v(z,V),V=z,j+=z.duration,W++,G=0,Q=!0);else if($[4]){var se=(" "+$[4]).slice(1);V?z.setByteRange(se,V):z.setByteRange(se)}else if($[5])z.rawProgramDateTime=(" "+$[5]).slice(1),z.tagList.push(["PROGRAM-DATE-TIME",z.rawProgramDateTime]),Z===-1&&(Z=U.length);else{if($=$[0].match(f),!$){b.logger.warn("No matches on slow regex match for level playlist!");continue}for(Y=1;Y<$.length&&!(typeof $[Y]<"u");Y++);var ie=(" "+$[Y]).slice(1),q=(" "+$[Y+1]).slice(1),oe=$[Y+2]?(" "+$[Y+2]).slice(1):"";switch(ie){case"PLAYLIST-TYPE":P.type=q.toUpperCase();break;case"MEDIA-SEQUENCE":W=P.startSN=parseInt(q);break;case"SKIP":{var le=new R.AttrList(q),fe=le.decimalInteger("SKIPPED-SEGMENTS");if((0,w.isFiniteNumber)(fe)){P.skippedSegments=fe;for(var Ie=fe;Ie--;)U.unshift(null);W+=fe}var pe=le.enumeratedString("RECENTLY-REMOVED-DATERANGES");pe&&(P.recentlyRemovedDateranges=pe.split("	"));break}case"TARGETDURATION":P.targetduration=parseFloat(q);break;case"VERSION":P.version=parseInt(q);break;case"EXTM3U":break;case"ENDLIST":P.live=!1;break;case"#":(q||oe)&&z.tagList.push(oe?[q,oe]:[q]);break;case"DISCONTINUITY":H++,z.tagList.push(["DIS"]);break;case"GAP":z.tagList.push([ie]);break;case"BITRATE":z.tagList.push([ie,q]);break;case"DATERANGE":{var xe=new R.AttrList(q),de=new N.DateRange(xe,P.dateRanges[xe.ID]);de.isValid||P.skippedSegments?P.dateRanges[de.id]=de:b.logger.warn('Ignoring invalid DATERANGE tag: "'+q+'"'),z.tagList.push(["EXT-X-DATERANGE",q]);break}case"DISCONTINUITY-SEQUENCE":H=parseInt(q);break;case"KEY":{var me=c(q,p);if(me.isSupported()){if(me.method==="NONE"){X=void 0;break}X||(X={}),X[me.keyFormat]&&(X=y({},X)),X[me.keyFormat]=me}else b.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+q+'"');break}case"START":{var ye=new R.AttrList(q),Oe=ye.decimalFloatingPoint("TIME-OFFSET");(0,w.isFiniteNumber)(Oe)&&(P.startTimeOffset=Oe);break}case"MAP":{var Ge=new R.AttrList(q);if(z.duration){var we=new O.Fragment(E,p);T(we,Ge,a,X),K=we,z.initSegment=K,K.rawProgramDateTime&&!z.rawProgramDateTime&&(z.rawProgramDateTime=K.rawProgramDateTime)}else T(z,Ge,a,X),K=z,Q=!0;break}case"SERVER-CONTROL":{var je=new R.AttrList(q);P.canBlockReload=je.bool("CAN-BLOCK-RELOAD"),P.canSkipUntil=je.optionalFloat("CAN-SKIP-UNTIL",0),P.canSkipDateRanges=P.canSkipUntil>0&&je.bool("CAN-SKIP-DATERANGES"),P.partHoldBack=je.optionalFloat("PART-HOLD-BACK",0),P.holdBack=je.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Gt=new R.AttrList(q);P.partTarget=Gt.decimalFloatingPoint("PART-TARGET");break}case"PART":{var et=P.partList;et||(et=P.partList=[]);var Qt=G>0?et[et.length-1]:void 0,Ct=G++,Et=new O.Part(new R.AttrList(q),z,p,Ct,Qt);et.push(Et),z.duration+=Et.duration;break}case"PRELOAD-HINT":{var Tt=new R.AttrList(q);P.preloadHint=Tt;break}case"RENDITION-REPORT":{var Ye=new R.AttrList(q);P.renditionReports=P.renditionReports||[],P.renditionReports.push(Ye);break}default:b.logger.warn("line parsed but not handled: "+$);break}}}V&&!V.relurl?(U.pop(),j-=V.duration,P.partList&&(P.fragmentHint=V)):P.partList&&(v(z,V),z.cc=H,P.fragmentHint=z,X&&M(z,X,P));var He=U.length,St=U[0],It=U[He-1];if(j+=P.skippedSegments*P.targetduration,j>0&&He&&It){P.averagetargetduration=j/He;var ke=It.sn;P.endSN=ke!=="initSegment"?ke:0,P.live||(It.endList=!0),St&&(P.startCC=St.cc)}else P.endSN=0,P.startCC=0;return P.fragmentHint&&(j+=P.fragmentHint.duration),P.totalduration=j,P.endCC=H,Z>0&&L(U,Z),P},g}();function c(g,m){var l,p,a=new R.AttrList(g),E=(l=a.enumeratedString("METHOD"))!=null?l:"",k=a.URI,P=a.hexadecimalInteger("IV"),U=a.enumeratedString("KEYFORMATVERSIONS"),K=(p=a.enumeratedString("KEYFORMAT"))!=null?p:"identity";k&&a.IV&&!P&&b.logger.error("Invalid IV: "+a.IV);var W=k?d.resolve(k,m):"",G=(U||"1").split("/").map(Number).filter(Number.isFinite);return new F.LevelKey(E,W,K,G,P)}function h(g,m){["video","audio","text"].forEach(function(l){var p=g.filter(function(E){return(0,S.isCodecType)(E,l)});if(p.length){var a=p.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});m[l+"Codec"]=a.length>0?a[0]:p[0],g=g.filter(function(E){return p.indexOf(E)===-1})}}),m.unknownCodecs=g}function _(g,m,l){var p=m[l];p&&(g[l]=p)}function L(g,m){for(var l=g[m],p=m;p--;){var a=g[p];if(!a)return;a.programDateTime=l.programDateTime-a.duration*1e3,l=a}}function v(g,m){g.rawProgramDateTime?g.programDateTime=Date.parse(g.rawProgramDateTime):m!=null&&m.programDateTime&&(g.programDateTime=m.endProgramDateTime),(0,w.isFiniteNumber)(g.programDateTime)||(g.programDateTime=null,g.rawProgramDateTime=null)}function T(g,m,l,p){g.relurl=m.URI,m.BYTERANGE&&g.setByteRange(m.BYTERANGE),g.level=l,g.sn="initSegment",p&&(g.levelkeys=p),g.initSegment=null}function M(g,m,l){g.levelkeys=m;var p=l.encryptedFragments;(!p.length||p[p.length-1].levelkeys!==m)&&Object.keys(m).some(function(a){return m[a].isCommonEncryption})&&p.push(g)}},"./src/loader/playlist-loader.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>s});var w=o("./src/polyfills/number.ts"),A=o("./src/events.ts"),N=o("./src/errors.ts"),O=o("./src/utils/logger.ts"),B=o("./src/loader/m3u8-parser.ts"),F=o("./src/types/loader.ts"),R=o("./src/utils/attr-list.ts");function b(D){var x=D.type;switch(x){case F.PlaylistContextType.AUDIO_TRACK:return F.PlaylistLevelType.AUDIO;case F.PlaylistContextType.SUBTITLE_TRACK:return F.PlaylistLevelType.SUBTITLE;default:return F.PlaylistLevelType.MAIN}}function S(D,x){var f=D.url;return(f===void 0||f.indexOf("data:")===0)&&(f=x.url),f}var y=function(){function D(f){this.hls=void 0,this.loaders=Object.create(null),this.hls=f,this.registerListeners()}var x=D.prototype;return x.startLoad=function(d){},x.stopLoad=function(){this.destroyInternalLoaders()},x.registerListeners=function(){var d=this.hls;d.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.on(A.Events.LEVEL_LOADING,this.onLevelLoading,this),d.on(A.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),d.on(A.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},x.unregisterListeners=function(){var d=this.hls;d.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(A.Events.LEVEL_LOADING,this.onLevelLoading,this),d.off(A.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),d.off(A.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},x.createInternalLoader=function(d){var c=this.hls.config,h=c.pLoader,_=c.loader,L=h||_,v=new L(c);return d.loader=v,this.loaders[d.type]=v,v},x.getInternalLoader=function(d){return this.loaders[d.type]},x.resetInternalLoader=function(d){this.loaders[d]&&delete this.loaders[d]},x.destroyInternalLoaders=function(){for(var d in this.loaders){var c=this.loaders[d];c&&c.destroy(),this.resetInternalLoader(d)}},x.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},x.onManifestLoading=function(d,c){var h=c.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:F.PlaylistContextType.MANIFEST,url:h,deliveryDirectives:null})},x.onLevelLoading=function(d,c){var h=c.id,_=c.level,L=c.url,v=c.deliveryDirectives;this.load({id:h,groupId:null,level:_,responseType:"text",type:F.PlaylistContextType.LEVEL,url:L,deliveryDirectives:v})},x.onAudioTrackLoading=function(d,c){var h=c.id,_=c.groupId,L=c.url,v=c.deliveryDirectives;this.load({id:h,groupId:_,level:null,responseType:"text",type:F.PlaylistContextType.AUDIO_TRACK,url:L,deliveryDirectives:v})},x.onSubtitleTrackLoading=function(d,c){var h=c.id,_=c.groupId,L=c.url,v=c.deliveryDirectives;this.load({id:h,groupId:_,level:null,responseType:"text",type:F.PlaylistContextType.SUBTITLE_TRACK,url:L,deliveryDirectives:v})},x.load=function(d){var c,h=this.hls.config,_=this.getInternalLoader(d);if(_){var L=_.context;if(L&&L.url===d.url){O.logger.trace("[playlist-loader]: playlist request ongoing");return}O.logger.log("[playlist-loader]: aborting previous loader for type: "+d.type),_.abort()}var v,T,M,g;switch(d.type){case F.PlaylistContextType.MANIFEST:v=h.manifestLoadingMaxRetry,T=h.manifestLoadingTimeOut,M=h.manifestLoadingRetryDelay,g=h.manifestLoadingMaxRetryTimeout;break;case F.PlaylistContextType.LEVEL:case F.PlaylistContextType.AUDIO_TRACK:case F.PlaylistContextType.SUBTITLE_TRACK:v=0,T=h.levelLoadingTimeOut;break;default:v=h.levelLoadingMaxRetry,T=h.levelLoadingTimeOut,M=h.levelLoadingRetryDelay,g=h.levelLoadingMaxRetryTimeout;break}if(_=this.createInternalLoader(d),(c=d.deliveryDirectives)!==null&&c!==void 0&&c.part){var m;if(d.type===F.PlaylistContextType.LEVEL&&d.level!==null?m=this.hls.levels[d.level].details:d.type===F.PlaylistContextType.AUDIO_TRACK&&d.id!==null?m=this.hls.audioTracks[d.id].details:d.type===F.PlaylistContextType.SUBTITLE_TRACK&&d.id!==null&&(m=this.hls.subtitleTracks[d.id].details),m){var l=m.partTarget,p=m.targetduration;l&&p&&(T=Math.min(Math.max(l*3,p*.8)*1e3,T))}}var a={timeout:T,maxRetry:v,retryDelay:M,maxRetryDelay:g,highWaterMark:0},E={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};_.load(d,a,E)},x.loadsuccess=function(d,c,h,_){_===void 0&&(_=null),this.resetInternalLoader(h.type);var L=d.data;if(L.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(d,h,"no EXTM3U delimiter",_);return}c.parsing.start=performance.now(),L.indexOf("#EXTINF:")>0||L.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(d,c,h,_):this.handleMasterPlaylist(d,c,h,_)},x.loaderror=function(d,c,h){h===void 0&&(h=null),this.handleNetworkError(c,h,!1,d)},x.loadtimeout=function(d,c,h){h===void 0&&(h=null),this.handleNetworkError(c,h,!0)},x.handleMasterPlaylist=function(d,c,h,_){var L=this.hls,v=d.data,T=S(d,h),M=B.default.parseMasterPlaylist(v,T),g=M.levels,m=M.sessionData,l=M.sessionKeys;if(!g.length){this.handleManifestParsingError(d,h,"no level found in manifest",_);return}var p=g.map(function(K){return{id:K.attrs.AUDIO,audioCodec:K.audioCodec}}),a=g.map(function(K){return{id:K.attrs.SUBTITLES,textCodec:K.textCodec}}),E=B.default.parseMasterPlaylistMedia(v,T,"AUDIO",p),k=B.default.parseMasterPlaylistMedia(v,T,"SUBTITLES",a),P=B.default.parseMasterPlaylistMedia(v,T,"CLOSED-CAPTIONS");if(E.length){var U=E.some(function(K){return!K.url});!U&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(O.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new R.AttrList({}),bitrate:0,url:""}))}L.trigger(A.Events.MANIFEST_LOADED,{levels:g,audioTracks:E,subtitles:k,captions:P,url:T,stats:c,networkDetails:_,sessionData:m,sessionKeys:l})},x.handleTrackOrLevelPlaylist=function(d,c,h,_){var L=this.hls,v=h.id,T=h.level,M=h.type,g=S(d,h),m=(0,w.isFiniteNumber)(v)?v:0,l=(0,w.isFiniteNumber)(T)?T:m,p=b(h),a=B.default.parseLevelPlaylist(d.data,g,l,p,m);if(!a.fragments.length){L.trigger(A.Events.ERROR,{type:N.ErrorTypes.NETWORK_ERROR,details:N.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:g,reason:"no fragments found in level",level:typeof h.level=="number"?h.level:void 0});return}if(M===F.PlaylistContextType.MANIFEST){var E={attrs:new R.AttrList({}),bitrate:0,details:a,name:"",url:g};L.trigger(A.Events.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:g,stats:c,networkDetails:_,sessionData:null,sessionKeys:null})}c.parsing.end=performance.now(),h.levelDetails=a,this.handlePlaylistLoaded(d,c,h,_)},x.handleManifestParsingError=function(d,c,h,_){this.hls.trigger(A.Events.ERROR,{type:N.ErrorTypes.NETWORK_ERROR,details:N.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:c.type===F.PlaylistContextType.MANIFEST,url:d.url,reason:h,response:d,context:c,networkDetails:_})},x.handleNetworkError=function(d,c,h,_){h===void 0&&(h=!1),O.logger.warn("[playlist-loader]: A network "+(h?"timeout":"error")+" occurred while loading "+d.type+" level: "+d.level+" id: "+d.id+' group-id: "'+d.groupId+'"');var L=N.ErrorDetails.UNKNOWN,v=!1,T=this.getInternalLoader(d);switch(d.type){case F.PlaylistContextType.MANIFEST:L=h?N.ErrorDetails.MANIFEST_LOAD_TIMEOUT:N.ErrorDetails.MANIFEST_LOAD_ERROR,v=!0;break;case F.PlaylistContextType.LEVEL:L=h?N.ErrorDetails.LEVEL_LOAD_TIMEOUT:N.ErrorDetails.LEVEL_LOAD_ERROR,v=!1;break;case F.PlaylistContextType.AUDIO_TRACK:L=h?N.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:N.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,v=!1;break;case F.PlaylistContextType.SUBTITLE_TRACK:L=h?N.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:N.ErrorDetails.SUBTITLE_LOAD_ERROR,v=!1;break}T&&this.resetInternalLoader(d.type);var M={type:N.ErrorTypes.NETWORK_ERROR,details:L,fatal:v,url:d.url,loader:T,context:d,networkDetails:c};_&&(M.response=_),this.hls.trigger(A.Events.ERROR,M)},x.handlePlaylistLoaded=function(d,c,h,_){var L=h.type,v=h.level,T=h.id,M=h.groupId,g=h.loader,m=h.levelDetails,l=h.deliveryDirectives;if(!(m!=null&&m.targetduration)){this.handleManifestParsingError(d,h,"invalid target duration",_);return}if(g)switch(m.live&&(g.getCacheAge&&(m.ageHeader=g.getCacheAge()||0),(!g.getCacheAge||isNaN(m.ageHeader))&&(m.ageHeader=0)),L){case F.PlaylistContextType.MANIFEST:case F.PlaylistContextType.LEVEL:this.hls.trigger(A.Events.LEVEL_LOADED,{details:m,level:v||0,id:T||0,stats:c,networkDetails:_,deliveryDirectives:l});break;case F.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(A.Events.AUDIO_TRACK_LOADED,{details:m,id:T||0,groupId:M||"",stats:c,networkDetails:_,deliveryDirectives:l});break;case F.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(A.Events.SUBTITLE_TRACK_LOADED,{details:m,id:T||0,groupId:M||"",stats:c,networkDetails:_,deliveryDirectives:l});break}},D}();const s=y},"./src/polyfills/number.ts":(C,I,o)=>{o.r(I),o.d(I,{MAX_SAFE_INTEGER:()=>A,isFiniteNumber:()=>w});var w=Number.isFinite||function(N){return typeof N=="number"&&isFinite(N)},A=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>A});var w=function(){function N(){}return N.getSilentFrame=function(B,F){switch(B){case"mp4a.40.2":if(F===1)return new Uint8Array([0,200,0,128,35,128]);if(F===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(F===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(F===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(F===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(F===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(F===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(F===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(F===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},N}();const A=w},"./src/remux/mp4-generator.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>N});var w=Math.pow(2,32)-1,A=function(){function O(){}return O.init=function(){O.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var F;for(F in O.types)O.types.hasOwnProperty(F)&&(O.types[F]=[F.charCodeAt(0),F.charCodeAt(1),F.charCodeAt(2),F.charCodeAt(3)]);var R=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),b=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);O.HDLR_TYPES={video:R,audio:b};var S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),y=new Uint8Array([0,0,0,0,0,0,0,0]);O.STTS=O.STSC=O.STCO=y,O.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),O.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),O.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),O.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),D=new Uint8Array([97,118,99,49]),x=new Uint8Array([0,0,0,1]);O.FTYP=O.box(O.types.ftyp,s,x,s,D),O.DINF=O.box(O.types.dinf,O.box(O.types.dref,S))},O.box=function(F){for(var R=8,b=arguments.length,S=new Array(b>1?b-1:0),y=1;y<b;y++)S[y-1]=arguments[y];for(var s=S.length,D=s;s--;)R+=S[s].byteLength;var x=new Uint8Array(R);for(x[0]=R>>24&255,x[1]=R>>16&255,x[2]=R>>8&255,x[3]=R&255,x.set(F,4),s=0,R=8;s<D;s++)x.set(S[s],R),R+=S[s].byteLength;return x},O.hdlr=function(F){return O.box(O.types.hdlr,O.HDLR_TYPES[F])},O.mdat=function(F){return O.box(O.types.mdat,F)},O.mdhd=function(F,R){R*=F;var b=Math.floor(R/(w+1)),S=Math.floor(R%(w+1));return O.box(O.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,F>>24&255,F>>16&255,F>>8&255,F&255,b>>24,b>>16&255,b>>8&255,b&255,S>>24,S>>16&255,S>>8&255,S&255,85,196,0,0]))},O.mdia=function(F){return O.box(O.types.mdia,O.mdhd(F.timescale,F.duration),O.hdlr(F.type),O.minf(F))},O.mfhd=function(F){return O.box(O.types.mfhd,new Uint8Array([0,0,0,0,F>>24,F>>16&255,F>>8&255,F&255]))},O.minf=function(F){return F.type==="audio"?O.box(O.types.minf,O.box(O.types.smhd,O.SMHD),O.DINF,O.stbl(F)):O.box(O.types.minf,O.box(O.types.vmhd,O.VMHD),O.DINF,O.stbl(F))},O.moof=function(F,R,b){return O.box(O.types.moof,O.mfhd(F),O.traf(b,R))},O.moov=function(F){for(var R=F.length,b=[];R--;)b[R]=O.trak(F[R]);return O.box.apply(null,[O.types.moov,O.mvhd(F[0].timescale,F[0].duration)].concat(b).concat(O.mvex(F)))},O.mvex=function(F){for(var R=F.length,b=[];R--;)b[R]=O.trex(F[R]);return O.box.apply(null,[O.types.mvex].concat(b))},O.mvhd=function(F,R){R*=F;var b=Math.floor(R/(w+1)),S=Math.floor(R%(w+1)),y=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,F>>24&255,F>>16&255,F>>8&255,F&255,b>>24,b>>16&255,b>>8&255,b&255,S>>24,S>>16&255,S>>8&255,S&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return O.box(O.types.mvhd,y)},O.sdtp=function(F){var R=F.samples||[],b=new Uint8Array(4+R.length),S,y;for(S=0;S<R.length;S++)y=R[S].flags,b[S+4]=y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy;return O.box(O.types.sdtp,b)},O.stbl=function(F){return O.box(O.types.stbl,O.stsd(F),O.box(O.types.stts,O.STTS),O.box(O.types.stsc,O.STSC),O.box(O.types.stsz,O.STSZ),O.box(O.types.stco,O.STCO))},O.avc1=function(F){var R=[],b=[],S,y,s;for(S=0;S<F.sps.length;S++)y=F.sps[S],s=y.byteLength,R.push(s>>>8&255),R.push(s&255),R=R.concat(Array.prototype.slice.call(y));for(S=0;S<F.pps.length;S++)y=F.pps[S],s=y.byteLength,b.push(s>>>8&255),b.push(s&255),b=b.concat(Array.prototype.slice.call(y));var D=O.box(O.types.avcC,new Uint8Array([1,R[3],R[4],R[5],255,224|F.sps.length].concat(R).concat([F.pps.length]).concat(b))),x=F.width,f=F.height,d=F.pixelRatio[0],c=F.pixelRatio[1];return O.box(O.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,x>>8&255,x&255,f>>8&255,f&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),D,O.box(O.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),O.box(O.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,c>>24,c>>16&255,c>>8&255,c&255])))},O.esds=function(F){var R=F.config.length;return new Uint8Array([0,0,0,0,3,23+R,0,1,0,4,15+R,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([R]).concat(F.config).concat([6,1,2]))},O.mp4a=function(F){var R=F.samplerate;return O.box(O.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,F.channelCount,0,16,0,0,0,0,R>>8&255,R&255,0,0]),O.box(O.types.esds,O.esds(F)))},O.mp3=function(F){var R=F.samplerate;return O.box(O.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,F.channelCount,0,16,0,0,0,0,R>>8&255,R&255,0,0]))},O.stsd=function(F){return F.type==="audio"?F.segmentCodec==="mp3"&&F.codec==="mp3"?O.box(O.types.stsd,O.STSD,O.mp3(F)):O.box(O.types.stsd,O.STSD,O.mp4a(F)):O.box(O.types.stsd,O.STSD,O.avc1(F))},O.tkhd=function(F){var R=F.id,b=F.duration*F.timescale,S=F.width,y=F.height,s=Math.floor(b/(w+1)),D=Math.floor(b%(w+1));return O.box(O.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,R>>24&255,R>>16&255,R>>8&255,R&255,0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,D>>24,D>>16&255,D>>8&255,D&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,S>>8&255,S&255,0,0,y>>8&255,y&255,0,0]))},O.traf=function(F,R){var b=O.sdtp(F),S=F.id,y=Math.floor(R/(w+1)),s=Math.floor(R%(w+1));return O.box(O.types.traf,O.box(O.types.tfhd,new Uint8Array([0,0,0,0,S>>24,S>>16&255,S>>8&255,S&255])),O.box(O.types.tfdt,new Uint8Array([1,0,0,0,y>>24,y>>16&255,y>>8&255,y&255,s>>24,s>>16&255,s>>8&255,s&255])),O.trun(F,b.length+16+20+8+16+8+8),b)},O.trak=function(F){return F.duration=F.duration||4294967295,O.box(O.types.trak,O.tkhd(F),O.mdia(F))},O.trex=function(F){var R=F.id;return O.box(O.types.trex,new Uint8Array([0,0,0,0,R>>24,R>>16&255,R>>8&255,R&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},O.trun=function(F,R){var b=F.samples||[],S=b.length,y=12+16*S,s=new Uint8Array(y),D,x,f,d,c,h;for(R+=8+y,s.set([F.type==="video"?1:0,0,15,1,S>>>24&255,S>>>16&255,S>>>8&255,S&255,R>>>24&255,R>>>16&255,R>>>8&255,R&255],0),D=0;D<S;D++)x=b[D],f=x.duration,d=x.size,c=x.flags,h=x.cts,s.set([f>>>24&255,f>>>16&255,f>>>8&255,f&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,c.degradPrio&240<<8,c.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*D);return O.box(O.types.trun,s)},O.initSegment=function(F){O.types||O.init();var R=O.moov(F),b=new Uint8Array(O.FTYP.byteLength+R.byteLength);return b.set(O.FTYP),b.set(R,O.FTYP.byteLength),b},O}();A.types=void 0,A.HDLR_TYPES=void 0,A.STTS=void 0,A.STSC=void 0,A.STCO=void 0,A.STSZ=void 0,A.VMHD=void 0,A.SMHD=void 0,A.STSD=void 0,A.FTYP=void 0,A.DINF=void 0;const N=A},"./src/remux/mp4-remuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>d,flushTextTrackMetadataCueSamples:()=>_,flushTextTrackUserdataCueSamples:()=>L,normalizePts:()=>c});var w=o("./src/polyfills/number.ts"),A=o("./src/remux/aac-helper.ts"),N=o("./src/remux/mp4-generator.ts"),O=o("./src/events.ts"),B=o("./src/errors.ts"),F=o("./src/utils/logger.ts"),R=o("./src/types/loader.ts"),b=o("./src/utils/timescale-conversion.ts");function S(){return S=Object.assign?Object.assign.bind():function(M){for(var g=1;g<arguments.length;g++){var m=arguments[g];for(var l in m)Object.prototype.hasOwnProperty.call(m,l)&&(M[l]=m[l])}return M},S.apply(this,arguments)}var y=10*1e3,s=1024,D=1152,x=null,f=null,d=function(){function M(m,l,p,a){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=m,this.config=l,this.typeSupported=p,this.ISGenerated=!1,x===null){var E=navigator.userAgent||"",k=E.match(/Chrome\/(\d+)/i);x=k?parseInt(k[1]):0}if(f===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);f=P?parseInt(P[1]):0}}var g=M.prototype;return g.destroy=function(){},g.resetTimeStamp=function(l){F.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=l},g.resetNextTimestamp=function(){F.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},g.resetInitSegment=function(){F.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},g.getVideoStartPts=function(l){var p=!1,a=l.reduce(function(E,k){var P=k.pts-E;return P<-4294967296?(p=!0,c(E,k.pts)):P>0?E:k.pts},l[0].pts);return p&&F.logger.debug("PTS rollover detected"),a},g.remux=function(l,p,a,E,k,P,U,K){var W,G,j,H,V,z,$=k,Y=k,X=l.pid>-1,Z=p.pid>-1,Q=p.samples.length,J=l.samples.length>0,re=U&&Q>0||Q>1,se=(!X||J)&&(!Z||re)||this.ISGenerated||U;if(se){this.ISGenerated||(j=this.generateIS(l,p,k));var ie=this.isVideoContiguous,q=-1,oe;if(re&&(q=h(p.samples),!ie&&this.config.forceKeyFrameOnDiscontinuity))if(z=!0,q>0){F.logger.warn("[mp4-remuxer]: Dropped "+q+" out of "+Q+" video samples due to a missing keyframe");var le=this.getVideoStartPts(p.samples);p.samples=p.samples.slice(q),p.dropped+=q,Y+=(p.samples[0].pts-le)/p.inputTimeScale,oe=Y}else q===-1&&(F.logger.warn("[mp4-remuxer]: No keyframe found out of "+Q+" video samples"),z=!1);if(this.ISGenerated){if(J&&re){var fe=this.getVideoStartPts(p.samples),Ie=c(l.samples[0].pts,fe)-fe,pe=Ie/p.inputTimeScale;$+=Math.max(0,pe),Y+=Math.max(0,-pe)}if(J){if(l.samplerate||(F.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),j=this.generateIS(l,p,k)),G=this.remuxAudio(l,$,this.isAudioContiguous,P,Z||re||K===R.PlaylistLevelType.AUDIO?Y:void 0),re){var xe=G?G.endPTS-G.startPTS:0;p.inputTimeScale||(F.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),j=this.generateIS(l,p,k)),W=this.remuxVideo(p,Y,ie,xe)}}else re&&(W=this.remuxVideo(p,Y,ie,0));W&&(W.firstKeyFrame=q,W.independent=q!==-1,W.firstKeyFramePTS=oe)}}return this.ISGenerated&&(a.samples.length&&(V=_(a,k,this._initPTS,this._initDTS)),E.samples.length&&(H=L(E,k,this._initPTS))),{audio:G,video:W,initSegment:j,independent:z,text:H,id3:V}},g.generateIS=function(l,p,a){var E=l.samples,k=p.samples,P=this.typeSupported,U={},K=!(0,w.isFiniteNumber)(this._initPTS),W="audio/mp4",G,j,H;if(K&&(G=j=1/0),l.config&&E.length){switch(l.timescale=l.samplerate,l.segmentCodec){case"mp3":P.mpeg?(W="audio/mpeg",l.codec=""):P.mp3&&(l.codec="mp3");break}U.audio={id:"audio",container:W,codec:l.codec,initSegment:l.segmentCodec==="mp3"&&P.mpeg?new Uint8Array(0):N.default.initSegment([l]),metadata:{channelCount:l.channelCount}},K&&(H=l.inputTimeScale,G=j=E[0].pts-Math.round(H*a))}if(p.sps&&p.pps&&k.length&&(p.timescale=p.inputTimeScale,U.video={id:"main",container:"video/mp4",codec:p.codec,initSegment:N.default.initSegment([p]),metadata:{width:p.width,height:p.height}},K)){H=p.inputTimeScale;var V=this.getVideoStartPts(k),z=Math.round(H*a);j=Math.min(j,c(k[0].dts,V)-z),G=Math.min(G,V-z)}if(Object.keys(U).length)return this.ISGenerated=!0,K&&(this._initPTS=G,this._initDTS=j),{tracks:U,initPTS:G,timescale:H}},g.remuxVideo=function(l,p,a,E){var k=l.inputTimeScale,P=l.samples,U=[],K=P.length,W=this._initPTS,G=this.nextAvcDts,j=8,H=this.videoSampleDuration,V,z,$=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,X=!1;if(!a||G===null){var Z=p*k,Q=P[0].pts-c(P[0].dts,P[0].pts);G=Z-Q}for(var J=0;J<K;J++){var re=P[J];re.pts=c(re.pts-W,G),re.dts=c(re.dts-W,G),re.dts<P[J>0?J-1:J].dts&&(X=!0)}X&&P.sort(function(Bs,Xu){var Dv=Bs.dts-Xu.dts,Av=Bs.pts-Xu.pts;return Dv||Av}),V=P[0].dts,z=P[P.length-1].dts;var se=z-V,ie=se?Math.round(se/(K-1)):H||l.inputTimeScale/30;if(a){var q=V-G,oe=q>ie,le=q<-1;if((oe||le)&&(oe?F.logger.warn("AVC: "+(0,b.toMsFromMpegTsClock)(q,!0)+" ms ("+q+"dts) hole between fragments detected, filling it"):F.logger.warn("AVC: "+(0,b.toMsFromMpegTsClock)(-q,!0)+" ms ("+q+"dts) overlapping between fragments detected"),!le||G>P[0].pts)){V=G;var fe=P[0].pts-q;P[0].dts=V,P[0].pts=fe,F.logger.log("Video: First PTS/DTS adjusted: "+(0,b.toMsFromMpegTsClock)(fe,!0)+"/"+(0,b.toMsFromMpegTsClock)(V,!0)+", delta: "+(0,b.toMsFromMpegTsClock)(q,!0)+" ms")}}V=Math.max(0,V);for(var Ie=0,pe=0,xe=0;xe<K;xe++){for(var de=P[xe],me=de.units,ye=me.length,Oe=0,Ge=0;Ge<ye;Ge++)Oe+=me[Ge].data.length;pe+=Oe,Ie+=ye,de.length=Oe,de.dts=Math.max(de.dts,V),$=Math.min(de.pts,$),Y=Math.max(de.pts,Y)}z=P[K-1].dts;var we=pe+4*Ie+8,je;try{je=new Uint8Array(we)}catch{this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:B.ErrorTypes.MUX_ERROR,details:B.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:we,reason:"fail allocating video mdat "+we});return}var Gt=new DataView(je.buffer);Gt.setUint32(0,we),je.set(N.default.types.mdat,4);for(var et=!1,Qt=Number.POSITIVE_INFINITY,Ct=Number.POSITIVE_INFINITY,Et=Number.NEGATIVE_INFINITY,Tt=Number.NEGATIVE_INFINITY,Ye=0;Ye<K;Ye++){for(var He=P[Ye],St=He.units,It=0,ke=0,jt=St.length;ke<jt;ke++){var Ot=St[ke],Bi=Ot.data,Fr=Ot.data.byteLength;Gt.setUint32(j,Fr),j+=4,je.set(Bi,j),j+=Fr,It+=4+Fr}var en=void 0;if(Ye<K-1)H=P[Ye+1].dts-He.dts,en=P[Ye+1].pts-He.pts;else{var Vu=this.config,Ki=Ye>0?He.dts-P[Ye-1].dts:ie;if(en=Ye>0?He.pts-P[Ye-1].pts:ie,Vu.stretchShortVideoTrack&&this.nextAudioPts!==null){var Ev=Math.floor(Vu.maxBufferHole*k),Ns=(E?$+E*k:this.nextAudioPts)-He.pts;Ns>Ev?(H=Ns-Ki,H<0?H=Ki:et=!0,F.logger.log("[mp4-remuxer]: It is approximately "+Ns/90+" ms to the next segment; using duration "+H/90+" ms for the last video frame.")):H=Ki}else H=Ki}var Tv=Math.round(He.pts-He.dts);Qt=Math.min(Qt,H),Et=Math.max(Et,H),Ct=Math.min(Ct,en),Tt=Math.max(Tt,en),U.push(new v(He.key,H,It,Tv))}if(U.length){if(x){if(x<70){var zu=U[0].flags;zu.dependsOn=2,zu.isNonSync=0}}else if(f&&Tt-Ct<Et-Qt&&ie/Et<.025&&U[0].cts===0){F.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Us=V,Mt=0,$u=U.length;Mt<$u;Mt++){var Yu=Us+U[Mt].duration,Sv=Us+U[Mt].cts;if(Mt<$u-1){var _v=Yu+U[Mt+1].cts;U[Mt].duration=_v-Sv}else U[Mt].duration=Mt?U[Mt-1].duration:ie;U[Mt].cts=0,Us=Yu}}}console.assert(H!==null,"mp4SampleDuration must be computed"),H=et||!H?ie:H,this.nextAvcDts=G=z+H,this.videoSampleDuration=H,this.isVideoContiguous=!0;var xv=N.default.moof(l.sequenceNumber++,V,S({},l,{samples:U})),Lv="video",Pv={data1:xv,data2:je,startPTS:$/k,endPTS:(Y+H)/k,startDTS:V/k,endDTS:G/k,type:Lv,hasAudio:!1,hasVideo:!0,nb:U.length,dropped:l.dropped};return l.samples=[],l.dropped=0,console.assert(je.length,"MDAT length must not be zero"),Pv},g.remuxAudio=function(l,p,a,E,k){var P=l.inputTimeScale,U=l.samplerate?l.samplerate:P,K=P/U,W=l.segmentCodec==="aac"?s:D,G=W*K,j=this._initPTS,H=l.segmentCodec==="mp3"&&this.typeSupported.mpeg,V=[],z=k!==void 0,$=l.samples,Y=H?0:8,X=this.nextAudioPts||-1,Z=p*P;if(this.isAudioContiguous=a=a||$.length&&X>0&&(E&&Math.abs(Z-X)<9e3||Math.abs(c($[0].pts-j,Z)-X)<20*G),$.forEach(function(Ot){Ot.pts=c(Ot.pts-j,Z)}),!a||X<0){if($=$.filter(function(Ot){return Ot.pts>=0}),!$.length)return;k===0?X=0:E&&!z?X=Math.max(0,Z):X=$[0].pts}if(l.segmentCodec==="aac")for(var Q=this.config.maxAudioFramesDrift,J=0,re=X;J<$.length;J++){var se=$[J],ie=se.pts,q=ie-re,oe=Math.abs(1e3*q/P);if(q<=-Q*G&&z)J===0&&(F.logger.warn("Audio frame @ "+(ie/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*q/P)+" ms."),this.nextAudioPts=X=re=ie);else if(q>=Q*G&&oe<y&&z){var le=Math.round(q/G);re=ie-le*G,re<0&&(le--,re+=G),J===0&&(this.nextAudioPts=X=re),F.logger.warn("[mp4-remuxer]: Injecting "+le+" audio frame @ "+(re/P).toFixed(3)+"s due to "+Math.round(1e3*q/P)+" ms gap.");for(var fe=0;fe<le;fe++){var Ie=Math.max(re,0),pe=A.default.getSilentFrame(l.manifestCodec||l.codec,l.channelCount);pe||(F.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),pe=se.unit.subarray()),$.splice(J,0,{unit:pe,pts:Ie}),re+=G,J++}}se.pts=re,re+=G}for(var xe=null,de=null,me,ye=0,Oe=$.length;Oe--;)ye+=$[Oe].unit.byteLength;for(var Ge=0,we=$.length;Ge<we;Ge++){var je=$[Ge],Gt=je.unit,et=je.pts;if(de!==null){var Qt=V[Ge-1];Qt.duration=Math.round((et-de)/K)}else if(a&&l.segmentCodec==="aac"&&(et=X),xe=et,ye>0){ye+=Y;try{me=new Uint8Array(ye)}catch{this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:B.ErrorTypes.MUX_ERROR,details:B.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ye,reason:"fail allocating audio mdat "+ye});return}if(!H){var Ct=new DataView(me.buffer);Ct.setUint32(0,ye),me.set(N.default.types.mdat,4)}}else return;me.set(Gt,Y);var Et=Gt.byteLength;Y+=Et,V.push(new v(!0,W,Et,0)),de=et}var Tt=V.length;if(Tt){var Ye=V[V.length-1];this.nextAudioPts=X=de+K*Ye.duration;var He=H?new Uint8Array(0):N.default.moof(l.sequenceNumber++,xe/K,S({},l,{samples:V}));l.samples=[];var St=xe/P,It=X/P,ke="audio",jt={data1:He,data2:me,startPTS:St,endPTS:It,startDTS:St,endDTS:It,type:ke,hasAudio:!0,hasVideo:!1,nb:Tt};return this.isAudioContiguous=!0,console.assert(me.length,"MDAT length must not be zero"),jt}},g.remuxEmptyAudio=function(l,p,a,E){var k=l.inputTimeScale,P=l.samplerate?l.samplerate:k,U=k/P,K=this.nextAudioPts,W=(K!==null?K:E.startDTS*k)+this._initDTS,G=E.endDTS*k+this._initDTS,j=U*s,H=Math.ceil((G-W)/j),V=A.default.getSilentFrame(l.manifestCodec||l.codec,l.channelCount);if(F.logger.warn("[mp4-remuxer]: remux empty Audio"),!V){F.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var z=[],$=0;$<H;$++){var Y=W+$*j;z.push({unit:V,pts:Y,dts:Y})}return l.samples=z,this.remuxAudio(l,p,a,!1)},M}();function c(M,g){var m;if(g===null)return M;for(g<M?m=-8589934592:m=8589934592;Math.abs(M-g)>4294967296;)M+=m;return M}function h(M){for(var g=0;g<M.length;g++)if(M[g].key)return g;return-1}function _(M,g,m,l){var p=M.samples.length;if(p){for(var a=M.inputTimeScale,E=0;E<p;E++){var k=M.samples[E];k.pts=c(k.pts-m,g*a)/a,k.dts=c(k.dts-l,g*a)/a}var P=M.samples;return M.samples=[],{samples:P}}}function L(M,g,m){var l=M.samples.length;if(l){for(var p=M.inputTimeScale,a=0;a<l;a++){var E=M.samples[a];E.pts=c(E.pts-m,g*p)/p}M.samples.sort(function(P,U){return P.pts-U.pts});var k=M.samples;return M.samples=[],{samples:k}}}var v=function(g,m,l,p){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=m,this.size=l,this.cts=p,this.flags=new T(g)},T=function(g){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=g?2:1,this.isNonSync=g?0:1}},"./src/remux/passthrough-remuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>b});var w=o("./src/polyfills/number.ts"),A=o("./src/remux/mp4-remuxer.ts"),N=o("./src/utils/mp4-tools.ts"),O=o("./src/loader/fragment.ts"),B=o("./src/utils/logger.ts"),F=function(){function S(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var y=S.prototype;return y.destroy=function(){},y.resetTimeStamp=function(D){this.initPTS=D,this.lastEndTime=null},y.resetNextTimestamp=function(){this.lastEndTime=null},y.resetInitSegment=function(D,x,f,d){this.audioCodec=x,this.videoCodec=f,this.generateInitSegment((0,N.patchEncyptionData)(D,d)),this.emitInitSegment=!0},y.generateInitSegment=function(D){var x=this.audioCodec,f=this.videoCodec;if(!D||!D.byteLength){this.initTracks=void 0,this.initData=void 0;return}var d=this.initData=(0,N.parseInitSegment)(D);x||(x=R(d.audio,O.ElementaryStreamTypes.AUDIO)),f||(f=R(d.video,O.ElementaryStreamTypes.VIDEO));var c={};d.audio&&d.video?c.audiovideo={container:"video/mp4",codec:x+","+f,initSegment:D,id:"main"}:d.audio?c.audio={container:"audio/mp4",codec:x,initSegment:D,id:"audio"}:d.video?c.video={container:"video/mp4",codec:f,initSegment:D,id:"main"}:B.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=c},y.remux=function(D,x,f,d,c){var h,_=this.initPTS,L=this.lastEndTime,v={audio:void 0,video:void 0,text:d,id3:f,initSegment:void 0};(0,w.isFiniteNumber)(L)||(L=this.lastEndTime=c||0);var T=x.samples;if(!T||!T.length)return v;var M={initPTS:void 0,timescale:1},g=this.initData;if((!g||!g.length)&&(this.generateInitSegment(T),g=this.initData),!g||!g.length)return B.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),v;this.emitInitSegment&&(M.tracks=this.initTracks,this.emitInitSegment=!1);var m=(0,N.getStartDTS)(g,T);(0,w.isFiniteNumber)(_)||(this.initPTS=M.initPTS=_=m-c);var l=(0,N.getDuration)(T,g),p=D?m-_:L,a=p+l;(0,N.offsetStartDTS)(g,T,_),l>0?this.lastEndTime=a:(B.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!g.audio,k=!!g.video,P="";E&&(P+="audio"),k&&(P+="video");var U={data1:T,startPTS:p,startDTS:p,endPTS:a,endDTS:a,type:P,hasAudio:E,hasVideo:k,nb:1,dropped:0};v.audio=U.type==="audio"?U:void 0,v.video=U.type!=="audio"?U:void 0,v.initSegment=M;var K=(h=this.initPTS)!=null?h:0;return v.id3=(0,A.flushTextTrackMetadataCueSamples)(f,c,K,K),d.samples.length&&(v.text=(0,A.flushTextTrackUserdataCueSamples)(d,c,K)),v},S}();function R(S,y){var s=S==null?void 0:S.codec;return s&&s.length>4?s:s==="hvc1"||s==="hev1"?"hvc1.1.c.L120.90":s==="av01"?"av01.0.04M.08":s==="avc1"||y===O.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const b=F},"./src/task-loop.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>w});var w=function(){function A(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var N=A.prototype;return N.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},N.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},N.onHandlerDestroyed=function(){},N.hasInterval=function(){return!!this._tickInterval},N.hasNextTick=function(){return!!this._tickTimer},N.setInterval=function(B){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,B),!0)},N.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},N.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},N.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},N.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},N.doTick=function(){},A}()},"./src/types/cmcd.ts":(C,I,o)=>{o.r(I),o.d(I,{CMCDObjectType:()=>A,CMCDStreamType:()=>O,CMCDStreamingFormat:()=>N,CMCDVersion:()=>w});var w=1,A;(function(B){B.MANIFEST="m",B.AUDIO="a",B.VIDEO="v",B.MUXED="av",B.INIT="i",B.CAPTION="c",B.TIMED_TEXT="tt",B.KEY="k",B.OTHER="o"})(A||(A={}));var N;(function(B){B.DASH="d",B.HLS="h",B.SMOOTH="s",B.OTHER="o"})(N||(N={}));var O;(function(B){B.VOD="v",B.LIVE="l"})(O||(O={}))},"./src/types/demuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{MetadataSchema:()=>w});var w;(function(A){A.audioId3="org.id3",A.dateRange="com.apple.quicktime.HLS",A.emsg="https://aomedia.org/emsg/ID3"})(w||(w={}))},"./src/types/level.ts":(C,I,o)=>{o.r(I),o.d(I,{HdcpLevels:()=>B,HlsSkip:()=>F,HlsUrlParameters:()=>b,Level:()=>S,getSkipValue:()=>R});function w(y,s){for(var D=0;D<s.length;D++){var x=s[D];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(y,N(x.key),x)}}function A(y,s,D){return s&&w(y.prototype,s),D&&w(y,D),Object.defineProperty(y,"prototype",{writable:!1}),y}function N(y){var s=O(y,"string");return typeof s=="symbol"?s:String(s)}function O(y,s){if(typeof y!="object"||y===null)return y;var D=y[Symbol.toPrimitive];if(D!==void 0){var x=D.call(y,s||"default");if(typeof x!="object")return x;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(y)}var B=["NONE","TYPE-0","TYPE-1","TYPE-2",null],F;(function(y){y.No="",y.Yes="YES",y.v2="v2"})(F||(F={}));function R(y,s){var D=y.canSkipUntil,x=y.canSkipDateRanges,f=y.endSN,d=s!==void 0?s-f:0;return D&&d<D?x?F.v2:F.Yes:F.No}var b=function(){function y(D,x,f){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=D,this.part=x,this.skip=f}var s=y.prototype;return s.addDirectives=function(x){var f=new self.URL(x);return this.msn!==void 0&&f.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&f.searchParams.set("_HLS_part",this.part.toString()),this.skip&&f.searchParams.set("_HLS_skip",this.skip),f.href},y}(),S=function(){function y(s){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[s.url],this.attrs=s.attrs,this.bitrate=s.bitrate,s.details&&(this.details=s.details),this.id=s.id||0,this.name=s.name,this.width=s.width||0,this.height=s.height||0,this.audioCodec=s.audioCodec,this.videoCodec=s.videoCodec,this.unknownCodecs=s.unknownCodecs,this.codecSet=[s.videoCodec,s.audioCodec].filter(function(D){return D}).join(",").replace(/\.[^.,]+/g,"")}return A(y,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(D){var x=D%this.url.length;this._urlId!==x&&(this.details=void 0,this._urlId=x)}}]),y}()},"./src/types/loader.ts":(C,I,o)=>{o.r(I),o.d(I,{PlaylistContextType:()=>w,PlaylistLevelType:()=>A});var w;(function(N){N.MANIFEST="manifest",N.LEVEL="level",N.AUDIO_TRACK="audioTrack",N.SUBTITLE_TRACK="subtitleTrack"})(w||(w={}));var A;(function(N){N.MAIN="main",N.AUDIO="audio",N.SUBTITLE="subtitle"})(A||(A={}))},"./src/types/transmuxer.ts":(C,I,o)=>{o.r(I),o.d(I,{ChunkMetadata:()=>w});var w=function(O,B,F,R,b,S){R===void 0&&(R=0),b===void 0&&(b=-1),S===void 0&&(S=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=A(),this.buffering={audio:A(),video:A(),audiovideo:A()},this.level=O,this.sn=B,this.id=F,this.size=R,this.part=b,this.partial=S};function A(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":(C,I,o)=>{o.r(I),o.d(I,{AttrList:()=>N});var w=/^(\d+)x(\d+)$/,A=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,N=function(){function O(F){typeof F=="string"&&(F=O.parseAttrList(F));for(var R in F)F.hasOwnProperty(R)&&(this[R]=F[R])}var B=O.prototype;return B.decimalInteger=function(R){var b=parseInt(this[R],10);return b>Number.MAX_SAFE_INTEGER?1/0:b},B.hexadecimalInteger=function(R){if(this[R]){var b=(this[R]||"0x").slice(2);b=(b.length&1?"0":"")+b;for(var S=new Uint8Array(b.length/2),y=0;y<b.length/2;y++)S[y]=parseInt(b.slice(y*2,y*2+2),16);return S}else return null},B.hexadecimalIntegerAsNumber=function(R){var b=parseInt(this[R],16);return b>Number.MAX_SAFE_INTEGER?1/0:b},B.decimalFloatingPoint=function(R){return parseFloat(this[R])},B.optionalFloat=function(R,b){var S=this[R];return S?parseFloat(S):b},B.enumeratedString=function(R){return this[R]},B.bool=function(R){return this[R]==="YES"},B.decimalResolution=function(R){var b=w.exec(this[R]);if(b!==null)return{width:parseInt(b[1],10),height:parseInt(b[2],10)}},O.parseAttrList=function(R){var b,S={},y='"';for(A.lastIndex=0;(b=A.exec(R))!==null;){var s=b[2];s.indexOf(y)===0&&s.lastIndexOf(y)===s.length-1&&(s=s.slice(1,-1)),S[b[1]]=s}return S},O}()},"./src/utils/binary-search.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>A});var w={search:function(O,B){for(var F=0,R=O.length-1,b=null,S=null;F<=R;){b=(F+R)/2|0,S=O[b];var y=B(S);if(y>0)F=b+1;else if(y<0)R=b-1;else return S}return null}};const A=w},"./src/utils/buffer-helper.ts":(C,I,o)=>{o.r(I),o.d(I,{BufferHelper:()=>N});var w=o("./src/utils/logger.ts"),A={length:0,start:function(){return 0},end:function(){return 0}},N=function(){function O(){}return O.isBuffered=function(F,R){try{if(F){for(var b=O.getBuffered(F),S=0;S<b.length;S++)if(R>=b.start(S)&&R<=b.end(S))return!0}}catch{}return!1},O.bufferInfo=function(F,R,b){try{if(F){var S=O.getBuffered(F),y=[],s;for(s=0;s<S.length;s++)y.push({start:S.start(s),end:S.end(s)});return this.bufferedInfo(y,R,b)}}catch{}return{len:0,start:R,end:R,nextStart:void 0}},O.bufferedInfo=function(F,R,b){R=Math.max(0,R),F.sort(function(v,T){var M=v.start-T.start;return M||T.end-v.end});var S=[];if(b)for(var y=0;y<F.length;y++){var s=S.length;if(s){var D=S[s-1].end;F[y].start-D<b?F[y].end>D&&(S[s-1].end=F[y].end):S.push(F[y])}else S.push(F[y])}else S=F;for(var x=0,f,d=R,c=R,h=0;h<S.length;h++){var _=S[h].start,L=S[h].end;if(R+b>=_&&R<L)d=_,c=L,x=c-R;else if(R+b<_){f=_;break}}return{len:x,start:d||0,end:c||0,nextStart:f}},O.getBuffered=function(F){try{return F.buffered}catch(R){return w.logger.log("failed to get media.buffered",R),A}},O}()},"./src/utils/cea-608-parser.ts":(C,I,o)=>{o.r(I),o.d(I,{CaptionScreen:()=>h,Row:()=>c,default:()=>g});var w=o("./src/utils/logger.ts"),A={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},N=function(l){var p=l;return A.hasOwnProperty(l)&&(p=A[l]),String.fromCharCode(p)},O=15,B=100,F={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},R={17:2,18:4,21:6,22:8,23:10,19:13,20:15},b={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},S={25:2,26:4,29:6,30:8,31:10,27:13,28:15},y=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],s;(function(m){m[m.ERROR=0]="ERROR",m[m.TEXT=1]="TEXT",m[m.WARNING=2]="WARNING",m[m.INFO=2]="INFO",m[m.DEBUG=3]="DEBUG",m[m.DATA=3]="DATA"})(s||(s={}));var D=function(){function m(){this.time=null,this.verboseLevel=s.ERROR}var l=m.prototype;return l.log=function(a,E){if(this.verboseLevel>=a){var k=typeof E=="function"?E():E;w.logger.log(this.time+" ["+a+"] "+k)}},m}(),x=function(l){for(var p=[],a=0;a<l.length;a++)p.push(l[a].toString(16));return p},f=function(){function m(p,a,E,k,P){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=p||"white",this.underline=a||!1,this.italics=E||!1,this.background=k||"black",this.flash=P||!1}var l=m.prototype;return l.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},l.setStyles=function(a){for(var E=["foreground","underline","italics","background","flash"],k=0;k<E.length;k++){var P=E[k];a.hasOwnProperty(P)&&(this[P]=a[P])}},l.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},l.equals=function(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash},l.copy=function(a){this.foreground=a.foreground,this.underline=a.underline,this.italics=a.italics,this.background=a.background,this.flash=a.flash},l.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},m}(),d=function(){function m(p,a,E,k,P,U){this.uchar=void 0,this.penState=void 0,this.uchar=p||" ",this.penState=new f(a,E,k,P,U)}var l=m.prototype;return l.reset=function(){this.uchar=" ",this.penState.reset()},l.setChar=function(a,E){this.uchar=a,this.penState.copy(E)},l.setPenState=function(a){this.penState.copy(a)},l.equals=function(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)},l.copy=function(a){this.uchar=a.uchar,this.penState.copy(a.penState)},l.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},m}(),c=function(){function m(p){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var a=0;a<B;a++)this.chars.push(new d);this.logger=p,this.pos=0,this.currPenState=new f}var l=m.prototype;return l.equals=function(a){for(var E=!0,k=0;k<B;k++)if(!this.chars[k].equals(a.chars[k])){E=!1;break}return E},l.copy=function(a){for(var E=0;E<B;E++)this.chars[E].copy(a.chars[E])},l.isEmpty=function(){for(var a=!0,E=0;E<B;E++)if(!this.chars[E].isEmpty()){a=!1;break}return a},l.setCursor=function(a){this.pos!==a&&(this.pos=a),this.pos<0?(this.logger.log(s.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>B&&(this.logger.log(s.DEBUG,"Too large cursor position "+this.pos),this.pos=B)},l.moveCursor=function(a){var E=this.pos+a;if(a>1)for(var k=this.pos+1;k<E+1;k++)this.chars[k].setPenState(this.currPenState);this.setCursor(E)},l.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},l.insertChar=function(a){var E=this;a>=144&&this.backSpace();var k=N(a);if(this.pos>=B){this.logger.log(s.ERROR,function(){return"Cannot insert "+a.toString(16)+" ("+k+") at position "+E.pos+". Skipping it!"});return}this.chars[this.pos].setChar(k,this.currPenState),this.moveCursor(1)},l.clearFromPos=function(a){var E;for(E=a;E<B;E++)this.chars[E].reset()},l.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},l.clearToEndOfRow=function(){this.clearFromPos(this.pos)},l.getTextString=function(){for(var a=[],E=!0,k=0;k<B;k++){var P=this.chars[k].uchar;P!==" "&&(E=!1),a.push(P)}return E?"":a.join("")},l.setPenStyles=function(a){this.currPenState.setStyles(a);var E=this.chars[this.pos];E.setPenState(this.currPenState)},m}(),h=function(){function m(p){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var a=0;a<O;a++)this.rows.push(new c(p));this.logger=p,this.currRow=O-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var l=m.prototype;return l.reset=function(){for(var a=0;a<O;a++)this.rows[a].clear();this.currRow=O-1},l.equals=function(a){for(var E=!0,k=0;k<O;k++)if(!this.rows[k].equals(a.rows[k])){E=!1;break}return E},l.copy=function(a){for(var E=0;E<O;E++)this.rows[E].copy(a.rows[E])},l.isEmpty=function(){for(var a=!0,E=0;E<O;E++)if(!this.rows[E].isEmpty()){a=!1;break}return a},l.backSpace=function(){var a=this.rows[this.currRow];a.backSpace()},l.clearToEndOfRow=function(){var a=this.rows[this.currRow];a.clearToEndOfRow()},l.insertChar=function(a){var E=this.rows[this.currRow];E.insertChar(a)},l.setPen=function(a){var E=this.rows[this.currRow];E.setPenStyles(a)},l.moveCursor=function(a){var E=this.rows[this.currRow];E.moveCursor(a)},l.setCursor=function(a){this.logger.log(s.INFO,"setCursor: "+a);var E=this.rows[this.currRow];E.setCursor(a)},l.setPAC=function(a){this.logger.log(s.INFO,function(){return"pacData = "+JSON.stringify(a)});var E=a.row-1;if(this.nrRollUpRows&&E<this.nrRollUpRows-1&&(E=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==E){for(var k=0;k<O;k++)this.rows[k].clear();var P=this.currRow+1-this.nrRollUpRows,U=this.lastOutputScreen;if(U){var K=U.rows[P].cueStartTime,W=this.logger.time;if(K&&W!==null&&K<W)for(var G=0;G<this.nrRollUpRows;G++)this.rows[E-this.nrRollUpRows+G+1].copy(U.rows[P+G])}}this.currRow=E;var j=this.rows[this.currRow];if(a.indent!==null){var H=a.indent,V=Math.max(H-1,0);j.setCursor(a.indent),a.color=j.chars[V].penState.foreground}var z={foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1};this.setPen(z)},l.setBkgData=function(a){this.logger.log(s.INFO,function(){return"bkgData = "+JSON.stringify(a)}),this.backSpace(),this.setPen(a),this.insertChar(32)},l.setRollUpRows=function(a){this.nrRollUpRows=a},l.rollUp=function(){var a=this;if(this.nrRollUpRows===null){this.logger.log(s.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(s.TEXT,function(){return a.getDisplayText()});var E=this.currRow+1-this.nrRollUpRows,k=this.rows.splice(E,1)[0];k.clear(),this.rows.splice(this.currRow,0,k),this.logger.log(s.INFO,"Rolling up")},l.getDisplayText=function(a){a=a||!1;for(var E=[],k="",P=-1,U=0;U<O;U++){var K=this.rows[U].getTextString();K&&(P=U+1,a?E.push("Row "+P+": '"+K+"'"):E.push(K.trim()))}return E.length>0&&(a?k="["+E.join(" | ")+"]":k=E.join(`
`)),k},l.getTextAndFormat=function(){return this.rows},m}(),_=function(){function m(p,a,E){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=p,this.outputFilter=a,this.mode=null,this.verbose=0,this.displayedMemory=new h(E),this.nonDisplayedMemory=new h(E),this.lastOutputScreen=new h(E),this.currRollUpRow=this.displayedMemory.rows[O-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=E}var l=m.prototype;return l.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[O-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},l.getHandler=function(){return this.outputFilter},l.setHandler=function(a){this.outputFilter=a},l.setPAC=function(a){this.writeScreen.setPAC(a)},l.setBkgData=function(a){this.writeScreen.setBkgData(a)},l.setMode=function(a){a!==this.mode&&(this.mode=a,this.logger.log(s.INFO,function(){return"MODE="+a}),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=a)},l.insertChars=function(a){for(var E=this,k=0;k<a.length;k++)this.writeScreen.insertChar(a[k]);var P=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(s.INFO,function(){return P+": "+E.writeScreen.getDisplayText(!0)}),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(s.TEXT,function(){return"DISPLAYED: "+E.displayedMemory.getDisplayText(!0)}),this.outputDataUpdate())},l.ccRCL=function(){this.logger.log(s.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},l.ccBS=function(){this.logger.log(s.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},l.ccAOF=function(){},l.ccAON=function(){},l.ccDER=function(){this.logger.log(s.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},l.ccRU=function(a){this.logger.log(s.INFO,"RU("+a+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(a)},l.ccFON=function(){this.logger.log(s.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},l.ccRDC=function(){this.logger.log(s.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},l.ccTR=function(){this.logger.log(s.INFO,"TR"),this.setMode("MODE_TEXT")},l.ccRTD=function(){this.logger.log(s.INFO,"RTD"),this.setMode("MODE_TEXT")},l.ccEDM=function(){this.logger.log(s.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},l.ccCR=function(){this.logger.log(s.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},l.ccENM=function(){this.logger.log(s.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},l.ccEOC=function(){var a=this;if(this.logger.log(s.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var E=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=E,this.writeScreen=this.nonDisplayedMemory,this.logger.log(s.TEXT,function(){return"DISP: "+a.displayedMemory.getDisplayText()})}this.outputDataUpdate(!0)},l.ccTO=function(a){this.logger.log(s.INFO,"TO("+a+") - Tab Offset"),this.writeScreen.moveCursor(a)},l.ccMIDROW=function(a){var E={flash:!1};if(E.underline=a%2===1,E.italics=a>=46,E.italics)E.foreground="white";else{var k=Math.floor(a/2)-16,P=["white","green","blue","cyan","red","yellow","magenta"];E.foreground=P[k]}this.logger.log(s.INFO,"MIDROW: "+JSON.stringify(E)),this.writeScreen.setPen(E)},l.outputDataUpdate=function(a){a===void 0&&(a=!1);var E=this.logger.time;E!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=E:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,E,this.lastOutputScreen),a&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:E),this.lastOutputScreen.copy(this.displayedMemory))},l.cueSplitAtTime=function(a){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a))},m}(),L=function(){function m(p,a,E){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var k=new D;this.channels=[null,new _(p,a,k),new _(p+1,E,k)],this.cmdHistory=M(),this.logger=k}var l=m.prototype;return l.getHandler=function(a){return this.channels[a].getHandler()},l.setHandler=function(a,E){this.channels[a].setHandler(E)},l.addData=function(a,E){var k,P,U,K=!1;this.logger.time=a;for(var W=0;W<E.length;W+=2)if(P=E[W]&127,U=E[W+1]&127,!(P===0&&U===0)){if(this.logger.log(s.DATA,"["+x([E[W],E[W+1]])+"] -> ("+x([P,U])+")"),k=this.parseCmd(P,U),k||(k=this.parseMidrow(P,U)),k||(k=this.parsePAC(P,U)),k||(k=this.parseBackgroundAttributes(P,U)),!k&&(K=this.parseChars(P,U),K)){var G=this.currentChannel;if(G&&G>0){var j=this.channels[G];j.insertChars(K)}else this.logger.log(s.WARNING,"No channel found yet. TEXT-MODE?")}!k&&!K&&this.logger.log(s.WARNING,"Couldn't parse cleaned data "+x([P,U])+" orig: "+x([E[W],E[W+1]]))}},l.parseCmd=function(a,E){var k=this.cmdHistory,P=(a===20||a===28||a===21||a===29)&&E>=32&&E<=47,U=(a===23||a===31)&&E>=33&&E<=35;if(!(P||U))return!1;if(T(a,E,k))return v(null,null,k),this.logger.log(s.DEBUG,"Repeated command ("+x([a,E])+") is dropped"),!0;var K=a===20||a===21||a===23?1:2,W=this.channels[K];return a===20||a===21||a===28||a===29?E===32?W.ccRCL():E===33?W.ccBS():E===34?W.ccAOF():E===35?W.ccAON():E===36?W.ccDER():E===37?W.ccRU(2):E===38?W.ccRU(3):E===39?W.ccRU(4):E===40?W.ccFON():E===41?W.ccRDC():E===42?W.ccTR():E===43?W.ccRTD():E===44?W.ccEDM():E===45?W.ccCR():E===46?W.ccENM():E===47&&W.ccEOC():W.ccTO(E-32),v(a,E,k),this.currentChannel=K,!0},l.parseMidrow=function(a,E){var k=0;if((a===17||a===25)&&E>=32&&E<=47){if(a===17?k=1:k=2,k!==this.currentChannel)return this.logger.log(s.ERROR,"Mismatch channel in midrow parsing"),!1;var P=this.channels[k];return P?(P.ccMIDROW(E),this.logger.log(s.DEBUG,"MIDROW ("+x([a,E])+")"),!0):!1}return!1},l.parsePAC=function(a,E){var k,P=this.cmdHistory,U=(a>=17&&a<=23||a>=25&&a<=31)&&E>=64&&E<=127,K=(a===16||a===24)&&E>=64&&E<=95;if(!(U||K))return!1;if(T(a,E,P))return v(null,null,P),!0;var W=a<=23?1:2;E>=64&&E<=95?k=W===1?F[a]:b[a]:k=W===1?R[a]:S[a];var G=this.channels[W];return G?(G.setPAC(this.interpretPAC(k,E)),v(a,E,P),this.currentChannel=W,!0):!1},l.interpretPAC=function(a,E){var k,P={color:null,italics:!1,indent:null,underline:!1,row:a};return E>95?k=E-96:k=E-64,P.underline=(k&1)===1,k<=13?P.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(k/2)]:k<=15?(P.italics=!0,P.color="white"):P.indent=Math.floor((k-16)/2)*4,P},l.parseChars=function(a,E){var k,P=null,U=null;if(a>=25?(k=2,U=a-8):(k=1,U=a),U>=17&&U<=19){var K;U===17?K=E+80:U===18?K=E+112:K=E+144,this.logger.log(s.INFO,"Special char '"+N(K)+"' in channel "+k),P=[K]}else a>=32&&a<=127&&(P=E===0?[a]:[a,E]);if(P){var W=x(P);this.logger.log(s.DEBUG,"Char codes =  "+W.join(",")),v(a,E,this.cmdHistory)}return P},l.parseBackgroundAttributes=function(a,E){var k=(a===16||a===24)&&E>=32&&E<=47,P=(a===23||a===31)&&E>=45&&E<=47;if(!(k||P))return!1;var U,K={};a===16||a===24?(U=Math.floor((E-32)/2),K.background=y[U],E%2===1&&(K.background=K.background+"_semi")):E===45?K.background="transparent":(K.foreground="black",E===47&&(K.underline=!0));var W=a<=23?1:2,G=this.channels[W];return G.setBkgData(K),v(a,E,this.cmdHistory),!0},l.reset=function(){for(var a=0;a<Object.keys(this.channels).length;a++){var E=this.channels[a];E&&E.reset()}this.cmdHistory=M()},l.cueSplitAtTime=function(a){for(var E=0;E<this.channels.length;E++){var k=this.channels[E];k&&k.cueSplitAtTime(a)}},m}();function v(m,l,p){p.a=m,p.b=l}function T(m,l,p){return p.a===m&&p.b===l}function M(){return{a:null,b:null}}const g=L},"./src/utils/codecs.ts":(C,I,o)=>{o.r(I),o.d(I,{isCodecSupportedInMp4:()=>N,isCodecType:()=>A});var w={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function A(O,B){var F=w[B];return!!F&&F[O.slice(0,4)]===!0}function N(O,B){return MediaSource.isTypeSupported((B||"video")+'/mp4;codecs="'+O+'"')}},"./src/utils/cues.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>F});var w=o("./src/utils/vttparser.ts"),A=o("./src/utils/webvtt-parser.ts"),N=o("./src/utils/texttrack-utils.ts"),O=/\s/,B={newCue:function(b,S,y,s){for(var D=[],x,f,d,c,h,_=self.VTTCue||self.TextTrackCue,L=0;L<s.rows.length;L++)if(x=s.rows[L],d=!0,c=0,h="",!x.isEmpty()){for(var v=0;v<x.chars.length;v++)O.test(x.chars[v].uchar)&&d?c++:(h+=x.chars[v].uchar,d=!1);x.cueStartTime=S,S===y&&(y+=1e-4),c>=16?c--:c++;var T=(0,w.fixLineBreaks)(h.trim()),M=(0,A.generateCueId)(S,y,T);(!b||!b.cues||!b.cues.getCueById(M))&&(f=new _(S,y,T),f.id=M,f.line=L+1,f.align="left",f.position=10+Math.min(80,Math.floor(c*8/32)*10),D.push(f))}return b&&D.length&&(D.sort(function(g,m){return g.line==="auto"||m.line==="auto"?0:g.line>8&&m.line>8?m.line-g.line:g.line-m.line}),D.forEach(function(g){return(0,N.addCueToTrack)(b,g)})),D}};const F=B},"./src/utils/discontinuities.ts":(C,I,o)=>{o.r(I),o.d(I,{adjustSlidingStart:()=>b,alignMediaPlaylistByPDT:()=>D,alignPDT:()=>s,alignStream:()=>S,findDiscontinuousReferenceFrag:()=>F,findFirstFragWithCC:()=>O,shouldAlignOnDiscontinuities:()=>B});var w=o("./src/polyfills/number.ts"),A=o("./src/utils/logger.ts"),N=o("./src/controller/level-helper.ts");function O(x,f){for(var d=null,c=0,h=x.length;c<h;c++){var _=x[c];if(_&&_.cc===f){d=_;break}}return d}function B(x,f,d){return!!(f.details&&(d.endCC>d.startCC||x&&x.cc<d.startCC))}function F(x,f,d){var c=x.fragments,h=f.fragments;if(!h.length||!c.length){A.logger.log("No fragments to align");return}var _=O(c,h[0].cc);if(!_||_&&!_.startPTS){A.logger.log("No frag in previous level to align on");return}return _}function R(x,f){if(x){var d=x.start+f;x.start=x.startPTS=d,x.endPTS=d+x.duration}}function b(x,f){for(var d=f.fragments,c=0,h=d.length;c<h;c++)R(d[c],x);f.fragmentHint&&R(f.fragmentHint,x),f.alignedSliding=!0}function S(x,f,d){f&&(y(x,d,f),!d.alignedSliding&&f.details&&s(d,f.details),!d.alignedSliding&&f.details&&!d.skippedSegments&&(0,N.adjustSliding)(f.details,d))}function y(x,f,d){if(B(x,d,f)){var c=F(d.details,f);c&&(0,w.isFiniteNumber)(c.start)&&(A.logger.log("Adjusting PTS using last level due to CC increase within current level "+f.url),b(c.start,f))}}function s(x,f){if(!(!f.fragments.length||!x.hasProgramDateTime||!f.hasProgramDateTime)){var d=f.fragments[0].programDateTime,c=x.fragments[0].programDateTime,h=(c-d)/1e3+f.fragments[0].start;h&&(0,w.isFiniteNumber)(h)&&(A.logger.log("Adjusting PTS using programDateTime delta "+(c-d)+"ms, sliding:"+h.toFixed(3)+" "+x.url+" "),b(h,x))}}function D(x,f){if(!(!x.hasProgramDateTime||!f.hasProgramDateTime)){var d=x.fragments,c=f.fragments;if(!(!d.length||!c.length)){var h=Math.round(c.length/2)-1,_=c[h],L=O(d,_.cc)||d[Math.round(d.length/2)-1],v=_.programDateTime,T=L.programDateTime;if(!(v===null||T===null)){var M=(T-v)/1e3-(L.start-_.start);b(M,x)}}}}},"./src/utils/ewma-bandwidth-estimator.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>N});var w=o("./src/utils/ewma.ts"),A=function(){function O(F,R,b){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=b,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new w.default(F),this.fast_=new w.default(R)}var B=O.prototype;return B.update=function(R,b){var S=this.slow_,y=this.fast_;this.slow_.halfLife!==R&&(this.slow_=new w.default(R,S.getEstimate(),S.getTotalWeight())),this.fast_.halfLife!==b&&(this.fast_=new w.default(b,y.getEstimate(),y.getTotalWeight()))},B.sample=function(R,b){R=Math.max(R,this.minDelayMs_);var S=8*b,y=R/1e3,s=S/y;this.fast_.sample(y,s),this.slow_.sample(y,s)},B.canEstimate=function(){var R=this.fast_;return R&&R.getTotalWeight()>=this.minWeight_},B.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},B.destroy=function(){},O}();const N=A},"./src/utils/ewma.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>A});var w=function(){function N(B,F,R){F===void 0&&(F=0),R===void 0&&(R=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=B,this.alpha_=B?Math.exp(Math.log(.5)/B):0,this.estimate_=F,this.totalWeight_=R}var O=N.prototype;return O.sample=function(F,R){var b=Math.pow(this.alpha_,F);this.estimate_=R*(1-b)+b*this.estimate_,this.totalWeight_+=F},O.getTotalWeight=function(){return this.totalWeight_},O.getEstimate=function(){if(this.alpha_){var F=1-Math.pow(this.alpha_,this.totalWeight_);if(F)return this.estimate_/F}return this.estimate_},N}();const A=w},"./src/utils/fetch-loader.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>h,fetchSupported:()=>D});var w=o("./src/polyfills/number.ts"),A=o("./src/loader/load-stats.ts"),N=o("./src/demux/chunk-cache.ts");function O(_,L){_.prototype=Object.create(L.prototype),_.prototype.constructor=_,S(_,L)}function B(_){var L=typeof Map=="function"?new Map:void 0;return B=function(T){if(T===null||!b(T))return T;if(typeof T!="function")throw new TypeError("Super expression must either be null or a function");if(typeof L<"u"){if(L.has(T))return L.get(T);L.set(T,M)}function M(){return F(T,arguments,y(this).constructor)}return M.prototype=Object.create(T.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),S(M,T)},B(_)}function F(_,L,v){return R()?F=Reflect.construct.bind():F=function(M,g,m){var l=[null];l.push.apply(l,g);var p=Function.bind.apply(M,l),a=new p;return m&&S(a,m.prototype),a},F.apply(null,arguments)}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(_){return Function.toString.call(_).indexOf("[native code]")!==-1}function S(_,L){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,M){return T.__proto__=M,T},S(_,L)}function y(_){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(v){return v.__proto__||Object.getPrototypeOf(v)},y(_)}function s(){return s=Object.assign?Object.assign.bind():function(_){for(var L=1;L<arguments.length;L++){var v=arguments[L];for(var T in v)Object.prototype.hasOwnProperty.call(v,T)&&(_[T]=v[T])}return _},s.apply(this,arguments)}function D(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var x=function(){function _(v){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=v.fetchSetup||d,this.controller=new self.AbortController,this.stats=new A.LoadStats}var L=_.prototype;return L.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},L.abortInternal=function(){var T=this.response;(!T||!T.ok)&&(this.stats.aborted=!0,this.controller.abort())},L.abort=function(){var T;this.abortInternal(),(T=this.callbacks)!==null&&T!==void 0&&T.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},L.load=function(T,M,g){var m=this,l=this.stats;if(l.loading.start)throw new Error("Loader can only be used once.");l.loading.start=self.performance.now();var p=f(T,this.controller.signal),a=g.onProgress,E=T.responseType==="arraybuffer",k=E?"byteLength":"length";this.context=T,this.config=M,this.callbacks=g,this.request=this.fetchSetup(T,p),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){m.abortInternal(),g.onTimeout(l,T,m.response)},M.timeout),self.fetch(this.request).then(function(P){if(m.response=m.loader=P,!P.ok){var U=P.status,K=P.statusText;throw new c(K||"fetch, bad network response",U,P)}return l.loading.first=Math.max(self.performance.now(),l.loading.start),l.total=parseInt(P.headers.get("Content-Length")||"0"),a&&(0,w.isFiniteNumber)(M.highWaterMark)?m.loadProgressively(P,l,T,M.highWaterMark,a):E?P.arrayBuffer():P.text()}).then(function(P){var U=m.response;self.clearTimeout(m.requestTimeout),l.loading.end=Math.max(self.performance.now(),l.loading.first);var K=P[k];K&&(l.loaded=l.total=K);var W={url:U.url,data:P};a&&!(0,w.isFiniteNumber)(M.highWaterMark)&&a(l,T,P,U),g.onSuccess(W,l,T,U)}).catch(function(P){if(self.clearTimeout(m.requestTimeout),!l.aborted){var U=P&&P.code||0,K=P?P.message:null;g.onError({code:U,text:K},T,P?P.details:null)}})},L.getCacheAge=function(){var T=null;if(this.response){var M=this.response.headers.get("age");T=M?parseFloat(M):null}return T},L.loadProgressively=function(T,M,g,m,l){m===void 0&&(m=0);var p=new N.default,a=T.body.getReader(),E=function k(){return a.read().then(function(P){if(P.done)return p.dataLength&&l(M,g,p.flush(),T),Promise.resolve(new ArrayBuffer(0));var U=P.value,K=U.length;return M.loaded+=K,K<m||p.dataLength?(p.push(U),p.dataLength>=m&&l(M,g,p.flush(),T)):l(M,g,U,T),k()}).catch(function(){return Promise.reject()})};return E()},_}();function f(_,L){var v={method:"GET",mode:"cors",credentials:"same-origin",signal:L,headers:new self.Headers(s({},_.headers))};return _.rangeEnd&&v.headers.set("Range","bytes="+_.rangeStart+"-"+String(_.rangeEnd-1)),v}function d(_,L){return new self.Request(_.url,L)}var c=function(_){O(L,_);function L(v,T,M){var g;return g=_.call(this,v)||this,g.code=void 0,g.details=void 0,g.code=T,g.details=M,g}return L}(B(Error));const h=x},"./src/utils/hex.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>A});var w={hexDump:function(O){for(var B="",F=0;F<O.length;F++){var R=O[F].toString(16);R.length<2&&(R="0"+R),B+=R}return B}};const A=w},"./src/utils/imsc1-ttml-parser.ts":(C,I,o)=>{o.r(I),o.d(I,{IMSC1_CODEC:()=>b,parseIMSC1:()=>D});var w=o("./src/utils/mp4-tools.ts"),A=o("./src/utils/vttparser.ts"),N=o("./src/utils/vttcue.ts"),O=o("./src/demux/id3.ts"),B=o("./src/utils/timescale-conversion.ts"),F=o("./src/utils/webvtt-parser.ts");function R(){return R=Object.assign?Object.assign.bind():function(g){for(var m=1;m<arguments.length;m++){var l=arguments[m];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(g[p]=l[p])}return g},R.apply(this,arguments)}var b="stpp.ttml.im1t",S=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,y=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,s={left:"start",center:"center",right:"end",start:"start",end:"end"};function D(g,m,l,p,a){var E=(0,w.findBox)(new Uint8Array(g),["mdat"]);if(E.length===0){a(new Error("Could not parse IMSC1 mdat"));return}var k=E.map(function(U){return(0,O.utf8ArrayToStr)(U)}),P=(0,B.toTimescaleFromScale)(m,1,l);try{k.forEach(function(U){return p(x(U,P))})}catch(U){a(U)}}function x(g,m){var l=new DOMParser,p=l.parseFromString(g,"text/xml"),a=p.getElementsByTagName("tt")[0];if(!a)throw new Error("Invalid ttml");var E={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},k=Object.keys(E).reduce(function(G,j){return G[j]=a.getAttribute("ttp:"+j)||E[j],G},{}),P=a.getAttribute("xml:space")!=="preserve",U=d(f(a,"styling","style")),K=d(f(a,"layout","region")),W=f(a,"body","[begin]");return[].map.call(W,function(G){var j=c(G,P);if(!j||!G.hasAttribute("begin"))return null;var H=v(G.getAttribute("begin"),k),V=v(G.getAttribute("dur"),k),z=v(G.getAttribute("end"),k);if(H===null)throw L(G);if(z===null){if(V===null)throw L(G);z=H+V}var $=new N.default(H-m,z-m,j);$.id=(0,F.generateCueId)($.startTime,$.endTime,$.text);var Y=K[G.getAttribute("region")],X=U[G.getAttribute("style")],Z=h(Y,X,U),Q=Z.textAlign;if(Q){var J=s[Q];J&&($.lineAlign=J),$.align=Q}return R($,Z),$}).filter(function(G){return G!==null})}function f(g,m,l){var p=g.getElementsByTagName(m)[0];return p?[].slice.call(p.querySelectorAll(l)):[]}function d(g){return g.reduce(function(m,l){var p=l.getAttribute("xml:id");return p&&(m[p]=l),m},{})}function c(g,m){return[].slice.call(g.childNodes).reduce(function(l,p,a){var E;return p.nodeName==="br"&&a?l+`
`:(E=p.childNodes)!==null&&E!==void 0&&E.length?c(p,m):m?l+p.textContent.trim().replace(/\s+/g," "):l+p.textContent},"")}function h(g,m,l){var p="http://www.w3.org/ns/ttml#styling",a=null,E=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],k=g!=null&&g.hasAttribute("style")?g.getAttribute("style"):null;return k&&l.hasOwnProperty(k)&&(a=l[k]),E.reduce(function(P,U){var K=_(m,p,U)||_(g,p,U)||_(a,p,U);return K&&(P[U]=K),P},{})}function _(g,m,l){return g&&g.hasAttributeNS(m,l)?g.getAttributeNS(m,l):null}function L(g){return new Error("Could not parse ttml timestamp "+g)}function v(g,m){if(!g)return null;var l=(0,A.parseTimeStamp)(g);return l===null&&(S.test(g)?l=T(g,m):y.test(g)&&(l=M(g,m))),l}function T(g,m){var l=S.exec(g),p=(l[4]|0)+(l[5]|0)/m.subFrameRate;return(l[1]|0)*3600+(l[2]|0)*60+(l[3]|0)+p/m.frameRate}function M(g,m){var l=y.exec(g),p=Number(l[1]),a=l[2];switch(a){case"h":return p*3600;case"m":return p*60;case"ms":return p*1e3;case"f":return p/m.frameRate;case"t":return p/m.tickRate}return p}},"./src/utils/keysystem-util.ts":(C,I,o)=>{o.r(I),o.d(I,{changeEndianness:()=>N,convertDataUriToArrayBytes:()=>O,strToUtf8array:()=>B});var w=o("./src/utils/numeric-encoding-utils.ts");function A(F){var R=B(F).subarray(0,16),b=new Uint8Array(16);return b.set(R,16-R.length),b}function N(F){var R=function(S,y,s){var D=S[y];S[y]=S[s],S[s]=D};R(F,0,3),R(F,1,2),R(F,4,5),R(F,6,7)}function O(F){var R=F.split(":"),b=null;if(R[0]==="data"&&R.length===2){var S=R[1].split(";"),y=S[S.length-1].split(",");if(y.length===2){var s=y[0]==="base64",D=y[1];s?(S.splice(-1,1),b=(0,w.base64Decode)(D)):b=A(D)}}return b}function B(F){return Uint8Array.from(unescape(encodeURIComponent(F)),function(R){return R.charCodeAt(0)})}},"./src/utils/logger.ts":(C,I,o)=>{o.r(I),o.d(I,{enableLogs:()=>F,logger:()=>R});var w=function(){},A={trace:w,debug:w,log:w,warn:w,info:w,error:w},N=A;function O(b){var S=self.console[b];return S?S.bind(self.console,"["+b+"] >"):w}function B(b){for(var S=arguments.length,y=new Array(S>1?S-1:0),s=1;s<S;s++)y[s-1]=arguments[s];y.forEach(function(D){N[D]=b[D]?b[D].bind(b):O(D)})}function F(b,S){if(self.console&&b===!0||typeof b=="object"){B(b,"debug","log","info","warn","error");try{N.log('Debug logs enabled for "'+S+'"')}catch{N=A}}else N=A}var R=N},"./src/utils/mediakeys-helper.ts":(C,I,o)=>{o.r(I),o.d(I,{KeySystemFormats:()=>A,KeySystemIds:()=>O,KeySystems:()=>w,getKeySystemsForConfig:()=>R,getSupportedMediaKeySystemConfigurations:()=>S,keySystemDomainToKeySystemFormat:()=>F,keySystemFormatToKeySystemDomain:()=>N,keySystemIdToKeySystemDomain:()=>B,requestMediaKeySystemAccess:()=>b});var w;(function(s){s.CLEARKEY="org.w3.clearkey",s.FAIRPLAY="com.apple.fps",s.PLAYREADY="com.microsoft.playready",s.WIDEVINE="com.widevine.alpha"})(w||(w={}));var A;(function(s){s.CLEARKEY="org.w3.clearkey",s.FAIRPLAY="com.apple.streamingkeydelivery",s.PLAYREADY="com.microsoft.playready",s.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"})(A||(A={}));function N(s){switch(s){case A.FAIRPLAY:return w.FAIRPLAY;case A.PLAYREADY:return w.PLAYREADY;case A.WIDEVINE:return w.WIDEVINE;case A.CLEARKEY:return w.CLEARKEY}}var O;(function(s){s.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"})(O||(O={}));function B(s){if(s===O.WIDEVINE)return w.WIDEVINE}function F(s){switch(s){case w.FAIRPLAY:return A.FAIRPLAY;case w.PLAYREADY:return A.PLAYREADY;case w.WIDEVINE:return A.WIDEVINE;case w.CLEARKEY:return A.CLEARKEY}}function R(s){var D=s.drmSystems,x=s.widevineLicenseUrl,f=D?[w.FAIRPLAY,w.WIDEVINE,w.PLAYREADY,w.CLEARKEY].filter(function(d){return!!D[d]}):[];return!f[w.WIDEVINE]&&x&&f.push(w.WIDEVINE),f}var b=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function S(s,D,x,f){var d;switch(s){case w.FAIRPLAY:d=["cenc","sinf"];break;case w.WIDEVINE:case w.PLAYREADY:d=["cenc"];break;case w.CLEARKEY:d=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+s)}return y(d,D,x,f)}function y(s,D,x,f){var d={initDataTypes:s,persistentState:f.persistentState||"not-allowed",distinctiveIdentifier:f.distinctiveIdentifier||"not-allowed",sessionTypes:f.sessionTypes||[f.sessionType||"temporary"],audioCapabilities:D.map(function(c){return{contentType:'audio/mp4; codecs="'+c+'"',robustness:f.audioRobustness||"",encryptionScheme:f.audioEncryptionScheme||null}}),videoCapabilities:x.map(function(c){return{contentType:'video/mp4; codecs="'+c+'"',robustness:f.videoRobustness||"",encryptionScheme:f.videoEncryptionScheme||null}})};return[d]}},"./src/utils/mediasource-helper.ts":(C,I,o)=>{o.r(I),o.d(I,{getMediaSource:()=>w});function w(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":(C,I,o)=>{o.r(I),o.d(I,{RemuxerTrackIdConfig:()=>b,appendUint8Array:()=>m,bin2str:()=>S,computeRawDurationFromSamples:()=>T,discardEPB:()=>k,findBox:()=>f,getDuration:()=>v,getStartDTS:()=>L,mp4Box:()=>U,mp4pssh:()=>K,offsetStartDTS:()=>M,parseEmsg:()=>P,parseInitSegment:()=>c,parsePssh:()=>W,parseSEIMessageFromNALu:()=>E,parseSamples:()=>l,parseSegmentIndex:()=>d,parseSinf:()=>_,patchEncyptionData:()=>h,readSint32:()=>D,readUint16:()=>y,readUint32:()=>s,segmentValidRange:()=>g,writeUint32:()=>x});var w=o("./src/loader/fragment.ts"),A=o("./src/utils/typed-array.ts"),N=o("./src/demux/id3.ts"),O=o("./src/utils/logger.ts"),B=o("./src/utils/hex.ts"),F=Math.pow(2,32)-1,R=[].push,b={video:1,audio:2,id3:3,text:4};function S(G){return String.fromCharCode.apply(null,G)}function y(G,j){var H=G[j]<<8|G[j+1];return H<0?65536+H:H}function s(G,j){var H=D(G,j);return H<0?4294967296+H:H}function D(G,j){return G[j]<<24|G[j+1]<<16|G[j+2]<<8|G[j+3]}function x(G,j,H){G[j]=H>>24,G[j+1]=H>>16&255,G[j+2]=H>>8&255,G[j+3]=H&255}function f(G,j){var H=[];if(!j.length)return H;for(var V=G.byteLength,z=0;z<V;){var $=s(G,z),Y=S(G.subarray(z+4,z+8)),X=$>1?z+$:V;if(Y===j[0])if(j.length===1)H.push(G.subarray(z+8,X));else{var Z=f(G.subarray(z+8,X),j.slice(1));Z.length&&R.apply(H,Z)}z=X}return H}function d(G){var j=[],H=G[0],V=8,z=s(G,V);V+=4;var $=0,Y=0;H===0?V+=8:V+=16,V+=2;var X=G.length+Y,Z=y(G,V);V+=2;for(var Q=0;Q<Z;Q++){var J=V,re=s(G,J);J+=4;var se=re&2147483647,ie=(re&2147483648)>>>31;if(ie===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var q=s(G,J);J+=4,j.push({referenceSize:se,subsegmentDuration:q,info:{duration:q/z,start:X,end:X+se-1}}),X+=se,J+=4,V=J}return{earliestPresentationTime:$,timescale:z,version:H,referencesCount:Z,references:j}}function c(G){for(var j=[],H=f(G,["moov","trak"]),V=0;V<H.length;V++){var z=H[V],$=f(z,["tkhd"])[0];if($){var Y=$[0],X=Y===0?12:20,Z=s($,X),Q=f(z,["mdia","mdhd"])[0];if(Q){Y=Q[0],X=Y===0?12:20;var J=s(Q,X),re=f(z,["mdia","hdlr"])[0];if(re){var se=S(re.subarray(8,12)),ie={soun:w.ElementaryStreamTypes.AUDIO,vide:w.ElementaryStreamTypes.VIDEO}[se];if(ie){var q=f(z,["mdia","minf","stbl","stsd"])[0],oe=void 0;q&&(oe=S(q.subarray(12,16))),j[Z]={timescale:J,type:ie},j[ie]={timescale:J,id:Z,codec:oe}}}}}}var le=f(G,["moov","mvex","trex"]);return le.forEach(function(fe){var Ie=s(fe,4),pe=j[Ie];pe&&(pe.default={duration:s(fe,12),flags:s(fe,20)})}),j}function h(G,j){if(!G||!j)return G;var H=j.keyId;if(H&&j.isCommonEncryption){var V=f(G,["moov","trak"]);V.forEach(function(z){var $=f(z,["mdia","minf","stbl","stsd"])[0],Y=$.subarray(8),X=f(Y,["enca"]),Z=X.length>0;Z||(X=f(Y,["encv"])),X.forEach(function(Q){var J=Z?Q.subarray(28):Q.subarray(78),re=f(J,["sinf"]);re.forEach(function(se){var ie=_(se);if(ie){var q=ie.subarray(8,24);q.some(function(oe){return oe!==0})||(O.logger.log("[eme] Patching keyId in 'enc"+(Z?"a":"v")+">sinf>>tenc' box: "+B.default.hexDump(q)+" -> "+B.default.hexDump(H)),ie.set(H,8))}})})})}return G}function _(G){var j=f(G,["schm"])[0];if(j){var H=S(j.subarray(4,8));if(H==="cbcs"||H==="cenc")return f(G,["schi","tenc"])[0]}return O.logger.error("[eme] missing 'schm' box"),null}function L(G,j){return f(j,["moof","traf"]).reduce(function(H,V){var z=f(V,["tfdt"])[0],$=z[0],Y=f(V,["tfhd"]).reduce(function(X,Z){var Q=s(Z,4),J=G[Q];if(J){var re=s(z,4);$===1&&(re*=Math.pow(2,32),re+=s(z,8));var se=J.timescale||9e4,ie=re/se;if(isFinite(ie)&&(X===null||ie<X))return ie}return X},null);return Y!==null&&isFinite(Y)&&(H===null||Y<H)?Y:H},null)||0}function v(G,j){for(var H=0,V=0,z=0,$=f(G,["moof","traf"]),Y=0;Y<$.length;Y++){var X=$[Y],Z=f(X,["tfhd"])[0],Q=s(Z,4),J=j[Q];if(J){var re=J.default,se=s(Z,0)|(re==null?void 0:re.flags),ie=re==null?void 0:re.duration;se&8&&(se&2?ie=s(Z,12):ie=s(Z,8));for(var q=J.timescale||9e4,oe=f(X,["trun"]),le=0;le<oe.length;le++){if(H=T(oe[le]),!H&&ie){var fe=s(oe[le],4);H=ie*fe}J.type===w.ElementaryStreamTypes.VIDEO?V+=H/q:J.type===w.ElementaryStreamTypes.AUDIO&&(z+=H/q)}}}if(V===0&&z===0){for(var Ie=0,pe=f(G,["sidx"]),xe=0;xe<pe.length;xe++){var de=d(pe[xe]);de!=null&&de.references&&(Ie+=de.references.reduce(function(me,ye){return me+ye.info.duration||0},0))}return Ie}return V||z}function T(G){var j=s(G,0),H=8;j&1&&(H+=4),j&4&&(H+=4);for(var V=0,z=s(G,4),$=0;$<z;$++){if(j&256){var Y=s(G,H);V+=Y,H+=4}j&512&&(H+=4),j&1024&&(H+=4),j&2048&&(H+=4)}return V}function M(G,j,H){f(j,["moof","traf"]).forEach(function(V){f(V,["tfhd"]).forEach(function(z){var $=s(z,4),Y=G[$];if(Y){var X=Y.timescale||9e4;f(V,["tfdt"]).forEach(function(Z){var Q=Z[0],J=s(Z,4);if(Q===0)J-=H*X,J=Math.max(J,0),x(Z,4,J);else{J*=Math.pow(2,32),J+=s(Z,8),J-=H*X,J=Math.max(J,0);var re=Math.floor(J/(F+1)),se=Math.floor(J%(F+1));x(Z,4,re),x(Z,8,se)}})}})})}function g(G){var j={valid:null,remainder:null},H=f(G,["moof"]);if(H){if(H.length<2)return j.remainder=G,j}else return j;var V=H[H.length-1];return j.valid=(0,A.sliceUint8)(G,0,V.byteOffset-8),j.remainder=(0,A.sliceUint8)(G,V.byteOffset-8),j}function m(G,j){var H=new Uint8Array(G.length+j.length);return H.set(G),H.set(j,G.length),H}function l(G,j){var H=[],V=j.samples,z=j.timescale,$=j.id,Y=!1,X=f(V,["moof"]);return X.map(function(Z){var Q=Z.byteOffset-8,J=f(Z,["traf"]);J.map(function(re){var se=f(re,["tfdt"]).map(function(ie){var q=ie[0],oe=s(ie,4);return q===1&&(oe*=Math.pow(2,32),oe+=s(ie,8)),oe/z})[0];return se!==void 0&&(G=se),f(re,["tfhd"]).map(function(ie){var q=s(ie,4),oe=s(ie,0)&16777215,le=(oe&1)!==0,fe=(oe&2)!==0,Ie=(oe&8)!==0,pe=0,xe=(oe&16)!==0,de=0,me=(oe&32)!==0,ye=8;q===$&&(le&&(ye+=8),fe&&(ye+=4),Ie&&(pe=s(ie,ye),ye+=4),xe&&(de=s(ie,ye),ye+=4),me&&(ye+=4),j.type==="video"&&(Y=p(j.codec)),f(re,["trun"]).map(function(Oe){var Ge=Oe[0],we=s(Oe,0)&16777215,je=(we&1)!==0,Gt=0,et=(we&4)!==0,Qt=(we&256)!==0,Ct=0,Et=(we&512)!==0,Tt=0,Ye=(we&1024)!==0,He=(we&2048)!==0,St=0,It=s(Oe,4),ke=8;je&&(Gt=s(Oe,ke),ke+=4),et&&(ke+=4);for(var jt=Gt+Q,Ot=0;Ot<It;Ot++){if(Qt?(Ct=s(Oe,ke),ke+=4):Ct=pe,Et?(Tt=s(Oe,ke),ke+=4):Tt=de,Ye&&(ke+=4),He&&(Ge===0?St=s(Oe,ke):St=D(Oe,ke),ke+=4),j.type===w.ElementaryStreamTypes.VIDEO)for(var Bi=0;Bi<Tt;){var Fr=s(V,jt);if(jt+=4,a(Y,V[jt])){var en=V.subarray(jt,jt+Fr);E(en,Y?2:1,G+St/z,H)}jt+=Fr,Bi+=Fr+4}G+=Ct/z}}))})})}),H}function p(G){if(!G)return!1;var j=G.indexOf("."),H=j<0?G:G.substring(0,j);return H==="hvc1"||H==="hev1"||H==="dvh1"||H==="dvhe"}function a(G,j){if(G){var H=j>>1&63;return H===39||H===40}else{var V=j&31;return V===6}}function E(G,j,H,V){var z=k(G),$=0;$+=j;for(var Y=0,X=0,Z=!1,Q=0;$<z.length;){Y=0;do{if($>=z.length)break;Q=z[$++],Y+=Q}while(Q===255);X=0;do{if($>=z.length)break;Q=z[$++],X+=Q}while(Q===255);var J=z.length-$;if(!Z&&Y===4&&$<z.length){Z=!0;var re=z[$++];if(re===181){var se=y(z,$);if($+=2,se===49){var ie=s(z,$);if($+=4,ie===1195456820){var q=z[$++];if(q===3){var oe=z[$++],le=31&oe,fe=64&oe,Ie=fe?2+le*3:0,pe=new Uint8Array(Ie);if(fe){pe[0]=oe;for(var xe=1;xe<Ie;xe++)pe[xe]=z[$++]}V.push({type:q,payloadType:Y,pts:H,bytes:pe})}}}}}else if(Y===5&&X<J){if(Z=!0,X>16){for(var de=[],me=0;me<16;me++){var ye=z[$++].toString(16);de.push(ye.length==1?"0"+ye:ye),(me===3||me===5||me===7||me===9)&&de.push("-")}for(var Oe=X-16,Ge=new Uint8Array(Oe),we=0;we<Oe;we++)Ge[we]=z[$++];V.push({payloadType:Y,pts:H,uuid:de.join(""),userData:(0,N.utf8ArrayToStr)(Ge),userDataBytes:Ge})}}else if(X<J)$+=X;else if(X>J)break}}function k(G){for(var j=G.byteLength,H=[],V=1;V<j-2;)G[V]===0&&G[V+1]===0&&G[V+2]===3?(H.push(V+2),V+=2):V++;if(H.length===0)return G;var z=j-H.length,$=new Uint8Array(z),Y=0;for(V=0;V<z;Y++,V++)Y===H[0]&&(Y++,H.shift()),$[V]=G[Y];return $}function P(G){var j=G[0],H="",V="",z=0,$=0,Y=0,X=0,Z=0,Q=0;if(j===0){for(;S(G.subarray(Q,Q+1))!=="\0";)H+=S(G.subarray(Q,Q+1)),Q+=1;for(H+=S(G.subarray(Q,Q+1)),Q+=1;S(G.subarray(Q,Q+1))!=="\0";)V+=S(G.subarray(Q,Q+1)),Q+=1;V+=S(G.subarray(Q,Q+1)),Q+=1,z=s(G,12),$=s(G,16),X=s(G,20),Z=s(G,24),Q=28}else if(j===1){Q+=4,z=s(G,Q),Q+=4;var J=s(G,Q);Q+=4;var re=s(G,Q);for(Q+=4,Y=Math.pow(2,32)*J+re,Number.isSafeInteger(Y)||(Y=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),X=s(G,Q),Q+=4,Z=s(G,Q),Q+=4;S(G.subarray(Q,Q+1))!=="\0";)H+=S(G.subarray(Q,Q+1)),Q+=1;for(H+=S(G.subarray(Q,Q+1)),Q+=1;S(G.subarray(Q,Q+1))!=="\0";)V+=S(G.subarray(Q,Q+1)),Q+=1;V+=S(G.subarray(Q,Q+1)),Q+=1}var se=G.subarray(Q,G.byteLength);return{schemeIdUri:H,value:V,timeScale:z,presentationTime:Y,presentationTimeDelta:$,eventDuration:X,id:Z,payload:se}}function U(G){for(var j=arguments.length,H=new Array(j>1?j-1:0),V=1;V<j;V++)H[V-1]=arguments[V];for(var z=H.length,$=8,Y=z;Y--;)$+=H[Y].byteLength;var X=new Uint8Array($);for(X[0]=$>>24&255,X[1]=$>>16&255,X[2]=$>>8&255,X[3]=$&255,X.set(G,4),Y=0,$=8;Y<z;Y++)X.set(H[Y],$),$+=H[Y].byteLength;return X}function K(G,j,H){if(G.byteLength!==16)throw new RangeError("Invalid system id");var V,z;if(j){V=1,z=new Uint8Array(j.length*16);for(var $=0;$<j.length;$++){var Y=j[$];if(Y.byteLength!==16)throw new RangeError("Invalid key");z.set(Y,$*16)}}else V=0,z=new Uint8Array;var X;V>0?(X=new Uint8Array(4),j.length>0&&new DataView(X.buffer).setUint32(0,j.length,!1)):X=new Uint8Array;var Z=new Uint8Array(4);return H&&H.byteLength>0&&new DataView(Z.buffer).setUint32(0,H.byteLength,!1),U([112,115,115,104],new Uint8Array([V,0,0,0]),G,X,z,Z,H||new Uint8Array)}function W(G){if(!(G instanceof ArrayBuffer)||G.byteLength<32)return null;var j={version:0,systemId:"",kids:null,data:null},H=new DataView(G),V=H.getUint32(0);if(G.byteLength!==V&&V>44)return null;var z=H.getUint32(4);if(z!==1886614376||(j.version=H.getUint32(8)>>>24,j.version>1))return null;j.systemId=B.default.hexDump(new Uint8Array(G,12,16));var $=H.getUint32(28);if(j.version===0){if(V-32<$)return null;j.data=new Uint8Array(G,32,$)}else if(j.version===1){j.kids=[];for(var Y=0;Y<$;Y++)j.kids.push(new Uint8Array(G,32+Y*16,16))}return j}},"./src/utils/numeric-encoding-utils.ts":(C,I,o)=>{o.r(I),o.d(I,{base64Decode:()=>F,base64DecodeToStr:()=>N,base64Encode:()=>O,base64ToBase64Url:()=>w,base64UrlEncode:()=>B,strToBase64Encode:()=>A});function w(R){return R.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function A(R){return btoa(R)}function N(R){return atob(R)}function O(R){return btoa(String.fromCharCode.apply(String,R))}function B(R){return w(O(R))}function F(R){return Uint8Array.from(atob(R),function(b){return b.charCodeAt(0)})}},"./src/utils/output-filter.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>w});var w=function(){function A(O,B){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=O,this.trackName=B}var N=A.prototype;return N.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},N.newCue=function(B,F,R){(this.startTime===null||this.startTime>B)&&(this.startTime=B),this.endTime=F,this.screen=R,this.timelineController.createCaptionsTrack(this.trackName)},N.reset=function(){this.cueRanges=[],this.startTime=null},A}()},"./src/utils/texttrack-utils.ts":(C,I,o)=>{o.r(I),o.d(I,{addCueToTrack:()=>N,clearCurrentCues:()=>O,getCuesInRange:()=>R,removeCuesInRange:()=>B,sendAddTrackEvent:()=>A});var w=o("./src/utils/logger.ts");function A(b,S){var y;try{y=new Event("addtrack")}catch{y=document.createEvent("Event"),y.initEvent("addtrack",!1,!1)}y.track=b,S.dispatchEvent(y)}function N(b,S){var y=b.mode;if(y==="disabled"&&(b.mode="hidden"),b.cues&&!b.cues.getCueById(S.id))try{if(b.addCue(S),!b.cues.getCueById(S.id))throw new Error("addCue is failed for: "+S)}catch(D){w.logger.debug("[texttrack-utils]: "+D);var s=new self.TextTrackCue(S.startTime,S.endTime,S.text);s.id=S.id,b.addCue(s)}y==="disabled"&&(b.mode=y)}function O(b){var S=b.mode;if(S==="disabled"&&(b.mode="hidden"),b.cues)for(var y=b.cues.length;y--;)b.removeCue(b.cues[y]);S==="disabled"&&(b.mode=S)}function B(b,S,y,s){var D=b.mode;if(D==="disabled"&&(b.mode="hidden"),b.cues&&b.cues.length>0)for(var x=R(b.cues,S,y),f=0;f<x.length;f++)(!s||s(x[f]))&&b.removeCue(x[f]);D==="disabled"&&(b.mode=D)}function F(b,S){if(S<b[0].startTime)return 0;var y=b.length-1;if(S>b[y].endTime)return-1;for(var s=0,D=y;s<=D;){var x=Math.floor((D+s)/2);if(S<b[x].startTime)D=x-1;else if(S>b[x].startTime&&s<y)s=x+1;else return x}return b[s].startTime-S<S-b[D].startTime?s:D}function R(b,S,y){var s=[],D=F(b,S);if(D>-1)for(var x=D,f=b.length;x<f;x++){var d=b[x];if(d.startTime>=S&&d.endTime<=y)s.push(d);else if(d.startTime>y)return s}return s}},"./src/utils/time-ranges.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>A});var w={toString:function(O){for(var B="",F=O.length,R=0;R<F;R++)B+="["+O.start(R).toFixed(3)+"-"+O.end(R).toFixed(3)+"]";return B}};const A=w},"./src/utils/timescale-conversion.ts":(C,I,o)=>{o.r(I),o.d(I,{toMpegTsClockFromTimescale:()=>B,toMsFromMpegTsClock:()=>O,toTimescaleFromBase:()=>A,toTimescaleFromScale:()=>N});var w=9e4;function A(F,R,b,S){b===void 0&&(b=1),S===void 0&&(S=!1);var y=F*R*b;return S?Math.round(y):y}function N(F,R,b,S){return b===void 0&&(b=1),S===void 0&&(S=!1),A(F,R,1/b,S)}function O(F,R){return R===void 0&&(R=!1),A(F,1e3,1/w,R)}function B(F,R){return R===void 0&&(R=1),A(F,w,1/R)}},"./src/utils/typed-array.ts":(C,I,o)=>{o.r(I),o.d(I,{sliceUint8:()=>w});function w(A,N,O){return Uint8Array.prototype.slice?A.slice(N,O):new Uint8Array(Array.prototype.slice.call(A,N,O))}},"./src/utils/vttcue.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>w});const w=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var A=["","lr","rl"],N=["start","middle","end","left","right"];function O(S,y){if(typeof y!="string"||!Array.isArray(S))return!1;var s=y.toLowerCase();return~S.indexOf(s)?s:!1}function B(S){return O(A,S)}function F(S){return O(N,S)}function R(S){for(var y=arguments.length,s=new Array(y>1?y-1:0),D=1;D<y;D++)s[D-1]=arguments[D];for(var x=1;x<arguments.length;x++){var f=arguments[x];for(var d in f)S[d]=f[d]}return S}function b(S,y,s){var D=this,x={enumerable:!0};D.hasBeenReset=!1;var f="",d=!1,c=S,h=y,_=s,L=null,v="",T=!0,M="auto",g="start",m=50,l="middle",p=50,a="middle";Object.defineProperty(D,"id",R({},x,{get:function(){return f},set:function(k){f=""+k}})),Object.defineProperty(D,"pauseOnExit",R({},x,{get:function(){return d},set:function(k){d=!!k}})),Object.defineProperty(D,"startTime",R({},x,{get:function(){return c},set:function(k){if(typeof k!="number")throw new TypeError("Start time must be set to a number.");c=k,this.hasBeenReset=!0}})),Object.defineProperty(D,"endTime",R({},x,{get:function(){return h},set:function(k){if(typeof k!="number")throw new TypeError("End time must be set to a number.");h=k,this.hasBeenReset=!0}})),Object.defineProperty(D,"text",R({},x,{get:function(){return _},set:function(k){_=""+k,this.hasBeenReset=!0}})),Object.defineProperty(D,"region",R({},x,{get:function(){return L},set:function(k){L=k,this.hasBeenReset=!0}})),Object.defineProperty(D,"vertical",R({},x,{get:function(){return v},set:function(k){var P=B(k);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");v=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"snapToLines",R({},x,{get:function(){return T},set:function(k){T=!!k,this.hasBeenReset=!0}})),Object.defineProperty(D,"line",R({},x,{get:function(){return M},set:function(k){if(typeof k!="number"&&k!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");M=k,this.hasBeenReset=!0}})),Object.defineProperty(D,"lineAlign",R({},x,{get:function(){return g},set:function(k){var P=F(k);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");g=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"position",R({},x,{get:function(){return m},set:function(k){if(k<0||k>100)throw new Error("Position must be between 0 and 100.");m=k,this.hasBeenReset=!0}})),Object.defineProperty(D,"positionAlign",R({},x,{get:function(){return l},set:function(k){var P=F(k);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");l=P,this.hasBeenReset=!0}})),Object.defineProperty(D,"size",R({},x,{get:function(){return p},set:function(k){if(k<0||k>100)throw new Error("Size must be between 0 and 100.");p=k,this.hasBeenReset=!0}})),Object.defineProperty(D,"align",R({},x,{get:function(){return a},set:function(k){var P=F(k);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");a=P,this.hasBeenReset=!0}})),D.displayState=void 0}return b.prototype.getCueAsHTML=function(){var S=self.WebVTT;return S.convertCueToDOMTree(self,this.text)},b}()},"./src/utils/vttparser.ts":(C,I,o)=>{o.r(I),o.d(I,{VTTParser:()=>y,fixLineBreaks:()=>S,parseTimeStamp:()=>N});var w=o("./src/utils/vttcue.ts"),A=function(){function s(){}var D=s.prototype;return D.decode=function(f,d){if(!f)return"";if(typeof f!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(f))},s}();function N(s){function D(f,d,c,h){return(f|0)*3600+(d|0)*60+(c|0)+parseFloat(h||0)}var x=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return x?parseFloat(x[2])>59?D(x[2],x[3],0,x[4]):D(x[1],x[2],x[3],x[4]):null}var O=function(){function s(){this.values=Object.create(null)}var D=s.prototype;return D.set=function(f,d){!this.get(f)&&d!==""&&(this.values[f]=d)},D.get=function(f,d,c){return c?this.has(f)?this.values[f]:d[c]:this.has(f)?this.values[f]:d},D.has=function(f){return f in this.values},D.alt=function(f,d,c){for(var h=0;h<c.length;++h)if(d===c[h]){this.set(f,d);break}},D.integer=function(f,d){/^-?\d+$/.test(d)&&this.set(f,parseInt(d,10))},D.percent=function(f,d){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(d)){var c=parseFloat(d);if(c>=0&&c<=100)return this.set(f,c),!0}return!1},s}();function B(s,D,x,f){var d=f?s.split(f):[s];for(var c in d)if(typeof d[c]=="string"){var h=d[c].split(x);if(h.length===2){var _=h[0],L=h[1];D(_,L)}}}var F=new w.default(0,0,""),R=F.align==="middle"?"middle":"center";function b(s,D,x){var f=s;function d(){var _=N(s);if(_===null)throw new Error("Malformed timestamp: "+f);return s=s.replace(/^[^\sa-zA-Z-]+/,""),_}function c(_,L){var v=new O;B(_,function(g,m){var l;switch(g){case"region":for(var p=x.length-1;p>=0;p--)if(x[p].id===m){v.set(g,x[p].region);break}break;case"vertical":v.alt(g,m,["rl","lr"]);break;case"line":l=m.split(","),v.integer(g,l[0]),v.percent(g,l[0])&&v.set("snapToLines",!1),v.alt(g,l[0],["auto"]),l.length===2&&v.alt("lineAlign",l[1],["start",R,"end"]);break;case"position":l=m.split(","),v.percent(g,l[0]),l.length===2&&v.alt("positionAlign",l[1],["start",R,"end","line-left","line-right","auto"]);break;case"size":v.percent(g,m);break;case"align":v.alt(g,m,["start",R,"end","left","right"]);break}},/:/,/\s/),L.region=v.get("region",null),L.vertical=v.get("vertical","");var T=v.get("line","auto");T==="auto"&&F.line===-1&&(T=-1),L.line=T,L.lineAlign=v.get("lineAlign","start"),L.snapToLines=v.get("snapToLines",!0),L.size=v.get("size",100),L.align=v.get("align",R);var M=v.get("position","auto");M==="auto"&&F.position===50&&(M=L.align==="start"||L.align==="left"?0:L.align==="end"||L.align==="right"?100:50),L.position=M}function h(){s=s.replace(/^\s+/,"")}if(h(),D.startTime=d(),h(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+f);s=s.slice(3),h(),D.endTime=d(),h(),c(s,D)}function S(s){return s.replace(/<br(?: \/)?>/gi,`
`)}var y=function(){function s(){this.state="INITIAL",this.buffer="",this.decoder=new A,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var D=s.prototype;return D.parse=function(f){var d=this;f&&(d.buffer+=d.decoder.decode(f,{stream:!0}));function c(){var M=d.buffer,g=0;for(M=S(M);g<M.length&&M[g]!=="\r"&&M[g]!==`
`;)++g;var m=M.slice(0,g);return M[g]==="\r"&&++g,M[g]===`
`&&++g,d.buffer=M.slice(g),m}function h(M){B(M,function(g,m){},/:/)}try{var _="";if(d.state==="INITIAL"){if(!/\r\n|\n/.test(d.buffer))return this;_=c();var L=_.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!L||!L[0])throw new Error("Malformed WebVTT signature.");d.state="HEADER"}for(var v=!1;d.buffer;){if(!/\r\n|\n/.test(d.buffer))return this;switch(v?v=!1:_=c(),d.state){case"HEADER":/:/.test(_)?h(_):_||(d.state="ID");continue;case"NOTE":_||(d.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(_)){d.state="NOTE";break}if(!_)continue;if(d.cue=new w.default(0,0,""),d.state="CUE",_.indexOf("-->")===-1){d.cue.id=_;continue}case"CUE":if(!d.cue){d.state="BADCUE";continue}try{b(_,d.cue,d.regionList)}catch{d.cue=null,d.state="BADCUE";continue}d.state="CUETEXT";continue;case"CUETEXT":{var T=_.indexOf("-->")!==-1;if(!_||T&&(v=!0)){d.oncue&&d.cue&&d.oncue(d.cue),d.cue=null,d.state="ID";continue}if(d.cue===null)continue;d.cue.text&&(d.cue.text+=`
`),d.cue.text+=_}continue;case"BADCUE":_||(d.state="ID")}}}catch{d.state==="CUETEXT"&&d.cue&&d.oncue&&d.oncue(d.cue),d.cue=null,d.state=d.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},D.flush=function(){var f=this;try{if((f.cue||f.state==="HEADER")&&(f.buffer+=`

`,f.parse()),f.state==="INITIAL"||f.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(d){f.onparsingerror&&f.onparsingerror(d)}return f.onflush&&f.onflush(),this},s}()},"./src/utils/webvtt-parser.ts":(C,I,o)=>{o.r(I),o.d(I,{generateCueId:()=>y,parseWebVTT:()=>D});var w=o("./src/polyfills/number.ts"),A=o("./src/utils/vttparser.ts"),N=o("./src/demux/id3.ts"),O=o("./src/utils/timescale-conversion.ts"),B=o("./src/remux/mp4-remuxer.ts"),F=/\r\n|\n\r|\n|\r/g,R=function(f,d,c){return c===void 0&&(c=0),f.slice(c,c+d.length)===d},b=function(f){var d=parseInt(f.slice(-3)),c=parseInt(f.slice(-6,-4)),h=parseInt(f.slice(-9,-7)),_=f.length>9?parseInt(f.substring(0,f.indexOf(":"))):0;if(!(0,w.isFiniteNumber)(d)||!(0,w.isFiniteNumber)(c)||!(0,w.isFiniteNumber)(h)||!(0,w.isFiniteNumber)(_))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+f);return d+=1e3*c,d+=60*1e3*h,d+=60*60*1e3*_,d},S=function(f){for(var d=5381,c=f.length;c;)d=d*33^f.charCodeAt(--c);return(d>>>0).toString()};function y(x,f,d){return S(x.toString())+S(f.toString())+S(d)}var s=function(f,d,c){var h=f[d],_=f[h.prevCC];if(!_||!_.new&&h.new){f.ccOffset=f.presentationOffset=h.start,h.new=!1;return}for(;(L=_)!==null&&L!==void 0&&L.new;){var L;f.ccOffset+=h.start-_.start,h.new=!1,h=_,_=f[h.prevCC]}f.presentationOffset=c};function D(x,f,d,c,h,_,L,v){var T=new A.VTTParser,M=(0,N.utf8ArrayToStr)(new Uint8Array(x)).trim().replace(F,`
`).split(`
`),g=[],m=(0,O.toMpegTsClockFromTimescale)(f,d),l="00:00.000",p=0,a=0,E,k=!0;T.oncue=function(P){var U=c[h],K=c.ccOffset,W=(p-m)/9e4;U!=null&&U.new&&(a!==void 0?K=c.ccOffset=U.start:s(c,h,W)),W&&(K=W-c.presentationOffset);var G=P.endTime-P.startTime,j=(0,B.normalizePts)((P.startTime+K-a)*9e4,_*9e4)/9e4;P.startTime=Math.max(j,0),P.endTime=Math.max(j+G,0);var H=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(H)),P.id||(P.id=y(P.startTime,P.endTime,H)),P.endTime>0&&g.push(P)},T.onparsingerror=function(P){E=P},T.onflush=function(){if(E){v(E);return}L(g)},M.forEach(function(P){if(k)if(R(P,"X-TIMESTAMP-MAP=")){k=!1,P.slice(16).split(",").forEach(function(U){R(U,"LOCAL:")?l=U.slice(6):R(U,"MPEGTS:")&&(p=parseInt(U.slice(7)))});try{a=b(l)/1e3}catch(U){E=U}return}else P===""&&(k=!1);T.parse(P+`
`)}),T.flush()}},"./src/utils/xhr-loader.ts":(C,I,o)=>{o.r(I),o.d(I,{default:()=>B});var w=o("./src/utils/logger.ts"),A=o("./src/loader/load-stats.ts"),N=/^age:\s*[\d.]+\s*$/m,O=function(){function F(b){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=b?b.xhrSetup:null,this.stats=new A.LoadStats,this.retryDelay=0}var R=F.prototype;return R.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},R.abortInternal=function(){var S=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),S&&(S.onreadystatechange=null,S.onprogress=null,S.readyState!==4&&(this.stats.aborted=!0,S.abort()))},R.abort=function(){var S;this.abortInternal(),(S=this.callbacks)!==null&&S!==void 0&&S.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},R.load=function(S,y,s){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=S,this.config=y,this.callbacks=s,this.retryDelay=y.retryDelay,this.loadInternal()},R.loadInternal=function(){var S=this.config,y=this.context;if(S){var s=this.loader=new self.XMLHttpRequest,D=this.stats;D.loading.first=0,D.loaded=0;var x=this.xhrSetup;try{if(x)try{x(s,y.url)}catch{s.open("GET",y.url,!0),x(s,y.url)}s.readyState||s.open("GET",y.url,!0);var f=this.context.headers;if(f)for(var d in f)s.setRequestHeader(d,f[d])}catch(c){this.callbacks.onError({code:s.status,text:c.message},y,s);return}y.rangeEnd&&s.setRequestHeader("Range","bytes="+y.rangeStart+"-"+(y.rangeEnd-1)),s.onreadystatechange=this.readystatechange.bind(this),s.onprogress=this.loadprogress.bind(this),s.responseType=y.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),S.timeout),s.send()}},R.readystatechange=function(){var S=this.context,y=this.loader,s=this.stats;if(!(!S||!y)){var D=y.readyState,x=this.config;if(!s.aborted&&D>=2)if(self.clearTimeout(this.requestTimeout),s.loading.first===0&&(s.loading.first=Math.max(self.performance.now(),s.loading.start)),D===4){y.onreadystatechange=null,y.onprogress=null;var f=y.status,d=y.responseType==="arraybuffer";if(f>=200&&f<300&&(d&&y.response||y.responseText!==null)){s.loading.end=Math.max(self.performance.now(),s.loading.first);var c,h;if(d?(c=y.response,h=c.byteLength):(c=y.responseText,h=c.length),s.loaded=s.total=h,!this.callbacks)return;var _=this.callbacks.onProgress;if(_&&_(s,S,c,y),!this.callbacks)return;var L={url:y.responseURL,data:c};this.callbacks.onSuccess(L,s,S,y)}else s.retry>=x.maxRetry||f>=400&&f<499?(w.logger.error(f+" while loading "+S.url),this.callbacks.onError({code:f,text:y.statusText},S,y)):(w.logger.warn(f+" while loading "+S.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,x.maxRetryDelay),s.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),x.timeout)}},R.loadtimeout=function(){w.logger.warn("timeout while loading "+this.context.url);var S=this.callbacks;S&&(this.abortInternal(),S.onTimeout(this.stats,this.context,this.loader))},R.loadprogress=function(S){var y=this.stats;y.loaded=S.loaded,S.lengthComputable&&(y.total=S.total)},R.getCacheAge=function(){var S=null;if(this.loader&&N.test(this.loader.getAllResponseHeaders())){var y=this.loader.getResponseHeader("age");S=y?parseFloat(y):null}return S},F}();const B=O},"./node_modules/eventemitter3/index.js":C=>{var I=Object.prototype.hasOwnProperty,o="~";function w(){}Object.create&&(w.prototype=Object.create(null),new w().__proto__||(o=!1));function A(F,R,b){this.fn=F,this.context=R,this.once=b||!1}function N(F,R,b,S,y){if(typeof b!="function")throw new TypeError("The listener must be a function");var s=new A(b,S||F,y),D=o?o+R:R;return F._events[D]?F._events[D].fn?F._events[D]=[F._events[D],s]:F._events[D].push(s):(F._events[D]=s,F._eventsCount++),F}function O(F,R){--F._eventsCount===0?F._events=new w:delete F._events[R]}function B(){this._events=new w,this._eventsCount=0}B.prototype.eventNames=function(){var R=[],b,S;if(this._eventsCount===0)return R;for(S in b=this._events)I.call(b,S)&&R.push(o?S.slice(1):S);return Object.getOwnPropertySymbols?R.concat(Object.getOwnPropertySymbols(b)):R},B.prototype.listeners=function(R){var b=o?o+R:R,S=this._events[b];if(!S)return[];if(S.fn)return[S.fn];for(var y=0,s=S.length,D=new Array(s);y<s;y++)D[y]=S[y].fn;return D},B.prototype.listenerCount=function(R){var b=o?o+R:R,S=this._events[b];return S?S.fn?1:S.length:0},B.prototype.emit=function(R,b,S,y,s,D){var x=o?o+R:R;if(!this._events[x])return!1;var f=this._events[x],d=arguments.length,c,h;if(f.fn){switch(f.once&&this.removeListener(R,f.fn,void 0,!0),d){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,b),!0;case 3:return f.fn.call(f.context,b,S),!0;case 4:return f.fn.call(f.context,b,S,y),!0;case 5:return f.fn.call(f.context,b,S,y,s),!0;case 6:return f.fn.call(f.context,b,S,y,s,D),!0}for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];f.fn.apply(f.context,c)}else{var _=f.length,L;for(h=0;h<_;h++)switch(f[h].once&&this.removeListener(R,f[h].fn,void 0,!0),d){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,b);break;case 3:f[h].fn.call(f[h].context,b,S);break;case 4:f[h].fn.call(f[h].context,b,S,y);break;default:if(!c)for(L=1,c=new Array(d-1);L<d;L++)c[L-1]=arguments[L];f[h].fn.apply(f[h].context,c)}}return!0},B.prototype.on=function(R,b,S){return N(this,R,b,S,!1)},B.prototype.once=function(R,b,S){return N(this,R,b,S,!0)},B.prototype.removeListener=function(R,b,S,y){var s=o?o+R:R;if(!this._events[s])return this;if(!b)return O(this,s),this;var D=this._events[s];if(D.fn)D.fn===b&&(!y||D.once)&&(!S||D.context===S)&&O(this,s);else{for(var x=0,f=[],d=D.length;x<d;x++)(D[x].fn!==b||y&&!D[x].once||S&&D[x].context!==S)&&f.push(D[x]);f.length?this._events[s]=f.length===1?f[0]:f:O(this,s)}return this},B.prototype.removeAllListeners=function(R){var b;return R?(b=o?o+R:R,this._events[b]&&O(this,b)):(this._events=new w,this._eventsCount=0),this},B.prototype.off=B.prototype.removeListener,B.prototype.addListener=B.prototype.on,B.prefixed=o,B.EventEmitter=B,C.exports=B},"./node_modules/url-toolkit/src/url-toolkit.js":function(C){(function(I){var o=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,w=/^(?=([^\/?#]*))\1([^]*)$/,A=/(?:\/|^)\.(?=\/)/g,N=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,O={buildAbsoluteURL:function(B,F,R){if(R=R||{},B=B.trim(),F=F.trim(),!F){if(!R.alwaysNormalize)return B;var b=O.parseURL(B);if(!b)throw new Error("Error trying to parse base URL.");return b.path=O.normalizePath(b.path),O.buildURLFromParts(b)}var S=O.parseURL(F);if(!S)throw new Error("Error trying to parse relative URL.");if(S.scheme)return R.alwaysNormalize?(S.path=O.normalizePath(S.path),O.buildURLFromParts(S)):F;var y=O.parseURL(B);if(!y)throw new Error("Error trying to parse base URL.");if(!y.netLoc&&y.path&&y.path[0]!=="/"){var s=w.exec(y.path);y.netLoc=s[1],y.path=s[2]}y.netLoc&&!y.path&&(y.path="/");var D={scheme:y.scheme,netLoc:S.netLoc,path:null,params:S.params,query:S.query,fragment:S.fragment};if(!S.netLoc&&(D.netLoc=y.netLoc,S.path[0]!=="/"))if(!S.path)D.path=y.path,S.params||(D.params=y.params,S.query||(D.query=y.query));else{var x=y.path,f=x.substring(0,x.lastIndexOf("/")+1)+S.path;D.path=O.normalizePath(f)}return D.path===null&&(D.path=R.alwaysNormalize?O.normalizePath(S.path):S.path),O.buildURLFromParts(D)},parseURL:function(B){var F=o.exec(B);return F?{scheme:F[1]||"",netLoc:F[2]||"",path:F[3]||"",params:F[4]||"",query:F[5]||"",fragment:F[6]||""}:null},normalizePath:function(B){for(B=B.split("").reverse().join("").replace(A,"");B.length!==(B=B.replace(N,"")).length;);return B.split("").reverse().join("")},buildURLFromParts:function(B){return B.scheme+B.netLoc+B.path+B.params+B.query+B.fragment}};C.exports=O})()}},n={};function i(C){var I=n[C];if(I!==void 0)return I.exports;var o=n[C]={exports:{}};return r[C].call(o.exports,o,o.exports,i),o.exports}i.m=r,i.n=C=>{var I=C&&C.__esModule?()=>C.default:()=>C;return i.d(I,{a:I}),I},i.d=(C,I)=>{for(var o in I)i.o(I,o)&&!i.o(C,o)&&Object.defineProperty(C,o,{enumerable:!0,get:I[o]})},i.o=(C,I)=>Object.prototype.hasOwnProperty.call(C,I),i.r=C=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(C,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(C,"__esModule",{value:!0})};var u=i("./src/hls.ts");return u=u.default,u})())})(cE);const pn=Oc(Ml);function ma(e,t){const r=new URLSearchParams(e.toString());return Object.entries(t).forEach(([n,i])=>{i===null?r.delete(n):Array.isArray(i)?(r.delete(n),i.forEach(u=>{r.append(n,u)})):r.set(n,i)}),r.toString()}const dE=()=>{const{selectedCourse:e}=Ui(R=>R.selectedCourse),t=ee.useRef(null),r=Fi(),[n]=bu(),i=n.get("lesson")||"",u=ee.useMemo(()=>i?(e==null?void 0:e.lessons.find(R=>R.id===i))||null:(e==null?void 0:e.lessons.find(R=>R.status!=="locked"))||null,[i,e==null?void 0:e.lessons]),[C,I]=ee.useState(u),[o,w]=ee.useState(!1),A=+JSON.parse(localStorage.getItem(`video-progress-${C==null?void 0:C.id}`)||"0"),[N]=ny(`video-progress-${C==null?void 0:C.id}`,A),O=R=>{const b=ma(n,{lesson:`${R}`});r({search:b})},B=R=>{const b=t.current;I(R),O(R.id),R.id===(C==null?void 0:C.id)&&b&&(o&&(b.pause(),w(!1)),o||(b.play(),w(!0)))},F=(R,b)=>{const S=t.current;S&&(R.key==="ArrowUp"&&R.shiftKey&&(S.playbackRate+=.25),R.key==="ArrowDown"&&R.shiftKey&&(S.playbackRate-=.25)),b&&R.key==="Enter"&&B(b)};return ee.useEffect(()=>{let R,b,S;(async()=>{if(!t.current)return;const D=t.current,x=`${C==null?void 0:C.link}`,f=`${C==null?void 0:C.id}`,d=new pn({enableWorker:!1});d.on(pn.Events.MEDIA_ATTACHED,()=>{d.loadSource(x),d.on(pn.Events.MANIFEST_PARSED,()=>{D.currentTime=A,O(f),D.play(),w(!0)})}),R=()=>{w(!0)},b=()=>{w(!1),N(D.currentTime)},S=()=>{N(D.currentTime)},D.addEventListener("play",R),D.addEventListener("pause",b),D.addEventListener("timeupdate",S),pn.isSupported()?d.attachMedia(D):D.canPlayType("application/vnd.apple.mpegurl")&&(D.src=x)})();const s=t.current;return()=>{s&&(s.removeEventListener("play",R),s.removeEventListener("pause",b),s.removeEventListener("timeupdate",S))}},[C]),Ee("div",{className:"course__lesson lesson",children:[Ee("div",{className:"lesson__player player",children:[ne("h2",{className:"player__title",children:C==null?void 0:C.title}),ne("video",{className:"player__video",poster:`${C==null?void 0:C.previewImageLink}/lesson-${C==null?void 0:C.order}.webp`,ref:t,controls:!0,onKeyDown:R=>F(R),children:ne("track",{kind:"captions"})}),Ee("div",{className:"player__description",children:[ne("b",{children:"Shift + ↑ "}),": speed up the video;",ne("br",{}),ne("b",{children:"Shift + ↓ "}),": slow down the video;"]})]}),ne("div",{className:"lesson__playlist playlist",children:ne("div",{className:"playlist__list",children:e==null?void 0:e.lessons.map(R=>Ee("button",{type:"button",className:Fs("playlist__item",{"playlist__item--active":(C==null?void 0:C.id)===R.id&&R.status!=="locked","playlist__item--disabled":R.status==="locked"}),onKeyDown:b=>F(b,R),onClick:()=>B(R),disabled:R.status==="locked",children:[R.status==="unlocked"&&ne(Ut,{type:o&&(C==null?void 0:C.id)===R.id?dt.PAUSE:dt.PLAY,addClassName:"playlist__item-icon"}),C!==R&&R.status==="locked"&&ne(Ut,{type:dt.BLOCKED,addClassName:"playlist__item-icon"}),ne("p",{className:"playlist__item-title",children:R.title})]},R.id))})})]})};const hE=()=>{const{selectedCourse:e}=Ui(t=>t.selectedCourse);return Ee("div",{className:"course",children:[ne(fE,{}),Ee("div",{className:"course__title title",children:[ne("h1",{className:"title__main",children:e==null?void 0:e.title}),ne("p",{className:"title__description",children:e==null?void 0:e.description})]}),ne(dE,{})]})};const mv=({error:e})=>ne("h1",{className:"error-notification",children:`...${e}...`});const yv=()=>ne("div",{className:"Loader",children:ne("div",{className:"Loader__content"})});var Hu=(e=>(e.GET_COURSES="Unable to get the courses",e.GET_COURSE_DETAILS="Unable to get the course's details",e))(Hu||{});const vE=()=>{const e=Fu(),{selectedCourse:t,hasError:r,loaded:n}=Ui(u=>u.selectedCourse),{courseId:i=""}=k0();return ee.useEffect(()=>{t||e(oi(i))},[i,t,e]),Ee(Nl,{children:[r&&ne(mv,{error:Hu.GET_COURSE_DETAILS}),!n&&ne(yv,{}),t&&!r&&n&&ne(hE,{})]})};const gE=({rating:e})=>{const t=Math.floor(e),r=e%1!==0,n=r?4-t:5-t,i=I=>Array.from({length:I},(o,w)=>w),u=i(t),C=i(n);return Ee("div",{className:"rating__stars stars",children:[u.map(I=>ne(Ut,{type:dt.STAR_FILLED,addClassName:"stars__star"},I)),r&&ne(Ut,{type:dt.STAR_HALF_FILLED,addClassName:"stars__star"}),C.map(I=>ne(Ut,{type:dt.STAR_EMPTY,addClassName:"stars__star"},I))]})};const pE=({course:e})=>{var b,S,y,s;const{id:t,tags:r,title:n,previewImageLink:i,lessonsCount:u,meta:C,rating:I}=e,[o,w]=ee.useState(!1),A=ee.useRef(null),N=()=>{w(!0)},O=()=>{w(!1),A.current&&!A.current.paused&&A.current.pause()},B=Fu(),F=()=>{B(oi(t))},R=D=>{D.key==="Escape"&&w(!1),D.key==="Enter"&&F()};return ee.useEffect(()=>{var x;let D;return o&&A.current&&(A.current.paused||A.current.pause(),D=new pn({enableWorker:!1}),(x=C.courseVideoPreview)!=null&&x.link?(D.loadSource(C.courseVideoPreview.link),D.attachMedia(A.current),D.on(pn.Events.MANIFEST_PARSED,()=>{var f;(f=A.current)==null||f.play()})):w(!1)),()=>{D&&D.destroy()}},[o,(b=C.courseVideoPreview)==null?void 0:b.link]),Ee(Ni,{to:`../course/${t}`,className:"course-card",onMouseEnter:N,onMouseLeave:O,onKeyDown:D=>R(D),onClick:F,children:[ne("h5",{className:Fs("course-card__category",{"course-card__category--yellow":r[0]==="productivity"},{"course-card__category--purple":r[0]==="learning ability"},{"course-card__category--red":r[0]==="communication"},{"course-card__category--green":r[0]==="psychology"}),children:r[0]}),ne("div",{className:"course-card__image",children:o&&((S=C.courseVideoPreview)!=null&&S.link)?ne("video",{className:"course-card__video",src:C.courseVideoPreview.link,ref:A,muted:!0,loop:!0,poster:`${i}/cover.webp`}):ne("img",{className:"course-card__pic",src:`${i}/cover.webp`,alt:n})}),ne("h3",{className:"course-card__title",children:n}),Ee("div",{className:"course-card__features",children:[Ee("span",{className:"course-card__feature-item",children:["Lessons count",ne("span",{className:"course-card__feature-info",children:u})]}),Ee("span",{className:"course-card__feature-item",children:["Rating",Ee("span",{className:"course-card__feature-info--rating rating",children:[ne(gE,{rating:I}),I]})]}),Ee("span",{className:"course-card__feature-item",children:["Skills",Ee("ul",{className:"course-card__feature-info",children:[!((y=C.skills)!=null&&y.length)&&ne("span",{className:"course-card__feature-info",children:"N/A"}),(s=C.skills)==null?void 0:s.map(D=>ne("li",{className:"course-card__feature-info",children:D},D))]})]})]})]})};const mE=({length:e})=>{const t=Fi(),[r]=bu(),[n,i]=ee.useState(0),u=r.get("page")||"1",C=10,I=n>1?Array.from({length:n},(O,B)=>B+1):[1],o=u==="1",w=u==="1"?u===`${n+1}`:u===`${n}`,A=O=>{if(u===`${O}`)return;const B=ma(r,{page:`${O}`});t({search:B})},N=O=>{const B=u?+u:null;if(O==="prev"&&B){if(B===1)return;const F=ma(r,{page:`${B-1}`});t({search:F})}if(O==="next"&&B){if(B===n)return;const F=ma(r,{page:`${B+1}`});t({search:F})}};return ee.useEffect(()=>{const B=(()=>Math.ceil(e/C))();i(B)},[e]),ne("div",{className:"category-page__pagination",children:Ee("ul",{className:"pagination",children:[Ee("button",{type:"button",className:"pagination__button","data-cy":"paginationLeft",disabled:o,onClick:()=>N("prev"),children:[!o&&ne(Ut,{type:dt.ARROW_LEFT}),o&&ne(Ut,{type:dt.ARROW_LEFT_DISABLED})]}),ne("div",{className:"pagination__list",children:I.map(O=>ne("button",{type:"button",className:Fs("pagination__item",{"pagination__item--is-active":+u===O}),onClick:()=>A(O),children:O},O))}),Ee("button",{type:"button",className:"pagination__button","data-cy":"paginationRight",disabled:w,onClick:()=>N("next"),children:[!w&&ne(Ut,{type:dt.ARROW_RIGHT}),w&&ne(Ut,{type:dt.ARROW_RIGHT_DISABLED})]})]})})};const yE=()=>{const{courses:e}=Ui(I=>I.courses),[t]=bu(),r=t.get("page")||"1",n=10;let i=0,u=e.length;r&&n?(i=n*(+r-1),u=n*+r>e.length?e.length:n*+r):(i=0,u=e.length);const C=ee.useMemo(()=>e.slice(i,u),[e,i,u]);return Ee(Nl,{children:[ne("div",{className:"course-list",children:C.map(I=>ne(pE,{course:I},I.id))}),ne(mE,{length:e.length})]})},EE=()=>{const{courses:e,hasError:t,loaded:r}=Ui(n=>n.courses);return Ee(Nl,{children:[t&&ne(mv,{error:Hu.GET_COURSES}),!r&&ne(yv,{}),e.length>0&&!t&&r&&ne(yE,{})]})};const TE=()=>Ee("div",{className:"not-found-page",children:[ne("h1",{className:"not-found-page__title",children:"Oh, no! Page is not found..."}),ne("span",{className:"not-found-page__image"})]}),SE=document.getElementById("root"),_E=Wh(SE);_E.render(ne(Vm,{store:uE,children:ne(q0,{children:ne($0,{children:Ee(rn,{path:"/",element:ne(aE,{}),children:[ne(rn,{path:"*",element:ne(TE,{})}),ne(rn,{index:!0,element:ne(EE,{})}),ne(rn,{path:"home",element:ne(H0,{to:"/",replace:!0})}),ne(rn,{path:"course/:courseId",element:ne(vE,{})})]})})})}));
